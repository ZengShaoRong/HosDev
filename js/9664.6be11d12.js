"use strict";(self["webpackChunkvue_arcgis_0905"]=self["webpackChunkvue_arcgis_0905"]||[]).push([[9664,2153],{89664:function(e,t,r){r.r(t),r.d(t,{default:function(){return S}});r(44114);var l,s=r(40399),i=(r(32334),r(5049)),n=r(18244),a=r(91354),o=r(45557),u=r(94),p=r(36861),c=(r(9302),r(8660),r(95753),r(29811)),d=r(39834),h=r(63955),f=r(81182),y=r(22528),m=r(61831),v=r(85633),g=r(45871),w=r(60522),I=r(25292),A=r(25672),_=r(12275),b=r(25453),M=r(79429),P=r(70616),T=r(86743);let E=l=class extends((0,y.dM)((0,g.J)((0,w.j)((0,m.q)((0,v.A)((0,a.P)(f.A))))))){constructor(...e){super(...e),this.copyright="",this.fullExtent=new M.A(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,P.A.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=P.A.WebMercator,this.subDomains=null,this.tileInfo=new _.A({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new T.A({x:-20037508.342787,y:20037508.342787,spatialReference:P.A.WebMercator}),spatialReference:P.A.WebMercator,lods:[new A.A({level:0,scale:591657527.591555,resolution:156543.033928}),new A.A({level:1,scale:295828763.795777,resolution:78271.5169639999}),new A.A({level:2,scale:147914381.897889,resolution:39135.7584820001}),new A.A({level:3,scale:73957190.948944,resolution:19567.8792409999}),new A.A({level:4,scale:36978595.474472,resolution:9783.93962049996}),new A.A({level:5,scale:18489297.737236,resolution:4891.96981024998}),new A.A({level:6,scale:9244648.868618,resolution:2445.98490512499}),new A.A({level:7,scale:4622324.434309,resolution:1222.99245256249}),new A.A({level:8,scale:2311162.217155,resolution:611.49622628138}),new A.A({level:9,scale:1155581.108577,resolution:305.748113140558}),new A.A({level:10,scale:577790.554289,resolution:152.874056570411}),new A.A({level:11,scale:288895.277144,resolution:76.4370282850732}),new A.A({level:12,scale:144447.638572,resolution:38.2185141425366}),new A.A({level:13,scale:72223.819286,resolution:19.1092570712683}),new A.A({level:14,scale:36111.909643,resolution:9.55462853563415}),new A.A({level:15,scale:18055.954822,resolution:4.77731426794937}),new A.A({level:16,scale:9027.977411,resolution:2.38865713397468}),new A.A({level:17,scale:4513.988705,resolution:1.19432856685505}),new A.A({level:18,scale:2256.994353,resolution:.597164283559817}),new A.A({level:19,scale:1128.497176,resolution:.298582141647617}),new A.A({level:20,scale:564.248588,resolution:.14929107082380833}),new A.A({level:21,scale:282.124294,resolution:.07464553541190416}),new A.A({level:22,scale:141.062147,resolution:.03732276770595208}),new A.A({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(e,t){return"string"==typeof e?{urlTemplate:e,...t}:e}load(e){const t=this.loadFromPortal({supportedTypes:["WMTS"]},e).then((()=>{let e="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const t=new u.s0(this.urlTemplate);!(this.subDomains&&this.subDomains.length>0)&&t.authority?.includes("{subDomain}")&&(e="is missing 'subDomains' property")}else e="spatialReference must match tileInfo.spatialReference";else e="is missing the required 'urlTemplate' property value";if(e)throw new n.A("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${e}`)}));return this.addResolvingPromise(t),Promise.resolve(this)}get levelValues(){const e=[];if(!this.tileInfo)return null;for(const t of this.tileInfo.lods)e[t.level]=t.levelValue||t.level;return e}readSpatialReference(e,t){return e||P.A.fromJSON(t.fullExtent?.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const e=[],{urlTemplate:t,subDomains:r}=this,l=new u.s0(t),s=l.scheme?l.scheme+"://":"//",i=s+l.authority+"/",n=l.authority;if(n?.includes("{subDomain}")){if(r&&r.length>0&&n.split(".").length>1)for(const a of r)e.push(s+n.replaceAll(/\{subDomain\}/gi,a)+"/")}else e.push(i);return e.map(u.Il)}get urlPath(){if(!this.urlTemplate)return null;const e=this.urlTemplate,t=new u.s0(e),r=(t.scheme?t.scheme+"://":"//")+t.authority+"/";return e.substring(r.length)}readUrlTemplate(e,t){return e||t.templateUrl}writeUrlTemplate(e,t){(0,u.BQ)(e)&&(e="https:"+e),e&&(e=e.replaceAll(/\{z\}/gi,"{level}").replaceAll(/\{x\}/gi,"{col}").replaceAll(/\{y\}/gi,"{row}"),e=(0,u.S8)(e)),t.templateUrl=e}fetchTile(e,t,r,l={}){const{signal:s}=l,n=this.getTileUrl(e,t,r),a={responseType:"image",signal:s,query:{...this.refreshParameters}};return(0,i.A)(n,a).then((e=>e.data))}async fetchImageBitmapTile(e,t,r,s={}){const{signal:n}=s;if(this.fetchTile!==l.prototype.fetchTile){const l=await this.fetchTile(e,t,r,s);return(0,I.C)(l,e,t,r,n)}const a=this.getTileUrl(e,t,r),o={responseType:"blob",signal:n,query:{...this.refreshParameters}},{data:u}=await(0,i.A)(a,o);return(0,I.C)(u,e,t,r,n)}getTileUrl(e,t,r){const{levelValues:l,tileServers:s,urlPath:i}=this;if(!l||!s||!i)return"";const n=l[e];return s[t%s.length]+(0,o.HC)(i,{level:n,z:n,col:r,x:r,row:t,y:t})}};(0,s._)([(0,p.MZ)({type:String,value:"",json:{write:!0}})],E.prototype,"copyright",void 0),(0,s._)([(0,p.MZ)({type:M.A,json:{write:!0},nonNullable:!0})],E.prototype,"fullExtent",void 0),(0,s._)([(0,p.MZ)({readOnly:!0,json:{read:!1,write:!1}})],E.prototype,"legendEnabled",void 0),(0,s._)([(0,p.MZ)({type:["show","hide"]})],E.prototype,"listMode",void 0),(0,s._)([(0,p.MZ)({json:{read:!0,write:!0}})],E.prototype,"blendMode",void 0),(0,s._)([(0,p.MZ)()],E.prototype,"levelValues",null),(0,s._)([(0,p.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],E.prototype,"isReference",void 0),(0,s._)([(0,p.MZ)({type:["WebTiledLayer"],value:"WebTiledLayer"})],E.prototype,"operationalLayerType",void 0),(0,s._)([(0,p.MZ)({readOnly:!0,json:{read:!1,write:!1}})],E.prototype,"popupEnabled",void 0),(0,s._)([(0,p.MZ)({type:P.A})],E.prototype,"spatialReference",void 0),(0,s._)([(0,c.w)("spatialReference",["spatialReference","fullExtent.spatialReference"])],E.prototype,"readSpatialReference",null),(0,s._)([(0,p.MZ)({type:[String],json:{write:!0}})],E.prototype,"subDomains",void 0),(0,s._)([(0,p.MZ)({type:_.A,json:{write:!0}})],E.prototype,"tileInfo",void 0),(0,s._)([(0,p.MZ)({readOnly:!0})],E.prototype,"tileServers",null),(0,s._)([(0,p.MZ)({json:{read:!1}})],E.prototype,"type",void 0),(0,s._)([(0,p.MZ)()],E.prototype,"urlPath",null),(0,s._)([(0,p.MZ)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],E.prototype,"urlTemplate",void 0),(0,s._)([(0,c.w)("urlTemplate",["urlTemplate","templateUrl"])],E.prototype,"readUrlTemplate",null),(0,s._)([(0,h.K)("urlTemplate",{templateUrl:{type:String}})],E.prototype,"writeUrlTemplate",null),(0,s._)([(0,p.MZ)({type:b.x,json:{write:!0}})],E.prototype,"wmtsInfo",void 0),E=l=(0,s._)([(0,d.$)("esri.layers.WebTileLayer")],E);const S=E},85633:function(e,t,r){r.d(t,{A:function(){return _}});r(44114);var l=r(40399),s=r(61768),i=r(4395),n=r(5049),a=r(26461),o=r(18244),u=r(8660),p=r(50942),c=r(13570),d=r(94),h=r(36861),f=(r(9302),r(95753),r(29811)),y=r(39834),m=r(63955),v=r(95541),g=r(45959),w=r(15350),I=r(65001),A=r(92153);const _=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,p.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,r){if(t.itemId)return new w["default"]({id:t.itemId,portal:r?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}async loadFromPortal(e,t){if(this.portalItem?.id)try{const{load:l}=await Promise.all([r.e(9470),r.e(5102)]).then(r.bind(r,25102));return(0,c.Te)(t),await l({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap},t)}catch(l){throw(0,c.zf)(l)||u.A.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${l}`),l}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,c.QP)(e),!0))))}async setUserPrivileges(e,t){if(!s.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:r,fullEdit:l},content:{updateItem:s}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",r),this._set("userHasFullEditingPrivileges",l),this._set("userHasUpdateItemPrivileges",s)}catch(r){(0,c.QP)(r)}}async _fetchUserPrivileges(e,t){let r=this.portalItem;if(!e||!r||!r.loaded||r.sourceUrl)return this._fetchFallbackUserPrivileges(t);const l=e===r.id;if(l&&r.portal.user)return(0,A.It)(r);let s,n;if(l)s=r.portal.url;else try{s=await(0,v.wI)(this.url,t)}catch(p){(0,c.QP)(p)}if(!s||!(0,d.b8)(s,r.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;n=await(i.id?.getCredential(`${s}/sharing`,{prompt:!1,signal:e}))}catch(p){(0,c.QP)(p)}const a=!0,o=!1,u=!1;if(!n)return{features:{edit:a,fullEdit:o},content:{updateItem:u}};try{if(l?await r.reload():(r=new w["default"]({id:e,portal:{url:s}}),await r.load(t)),r.portal.user)return(0,A.It)(r)}catch(p){(0,c.QP)(p)}return{features:{edit:a,fullEdit:o},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(r){(0,c.QP)(r)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?i.id?.findCredential(this.url):null;if(!t)return!0;const r=b.credential===t?b.user:await this._fetchEditingUser(e);return b.credential=t,b.user=r,null==r?.privileges||r.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const t=this.portalItem?.portal?.user;if(t)return t;const r=i.id?.findServerInfo(this.url??"");if(!r?.owningSystemUrl)return null;const l=`${r.owningSystemUrl}/sharing/rest`,s=g.A.getDefault();if(s&&s.loaded&&(0,d.S8)(s.restUrl)===(0,d.S8)(l))return s.user;const o=`${l}/community/self`,u=null!=e?e.signal:null,p=await(0,a.Ke)((0,n.A)(o,{authMode:"no-prompt",query:{f:"json"},signal:u}));return p.ok?I.A.fromJSON(p.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){const r=t?.portal,l=this.portalItem?.id&&(this.portalItem.portal||g.A.getDefault());return r&&l&&!(0,d.ut)(l.restUrl,r.restUrl)?(t.messages&&t.messages.push(new o.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,l._)([(0,h.MZ)({type:w["default"]})],t.prototype,"portalItem",null),(0,l._)([(0,f.w)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),(0,l._)([(0,m.K)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),(0,l._)([(0,h.MZ)({clonable:!1})],t.prototype,"resourceReferences",void 0),(0,l._)([(0,h.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),(0,l._)([(0,h.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),(0,l._)([(0,h.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=(0,l._)([(0,y.$)("esri.layers.mixins.PortalLayer")],t),t},b={credential:null,user:null}},45871:function(e,t,r){r.d(t,{J:function(){return _}});var l=r(40399),s=(r(9302),r(8660)),i=r(13570),n=r(36861),a=r(62163),o=(r(95753),r(39834)),u=r(54971),p=(r(44114),r(81677)),c=(r(26461),r(18244),r(51548),r(74873));const d=new p.A,h=new WeakMap;function f(e){m(e)&&d.push(new WeakRef(e))}function y(e){const t=d.find((t=>t.deref()===e));t&&d.remove(t)}function m(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function v(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:v(t,e%t):0}let g=0,w=0;function I(){const e=Date.now();let t=!1;for(const r of d){const l=r.deref();l?l.refreshInterval&&e-(h.get(l)??0)+5>=6e4*l.refreshInterval&&(h.set(l,e),l.refresh(e)):t=!0}if(t)for(let r=d.length-1;r>=0;r--)d.at(r).deref()||d.removeAt(r)}(0,c.fm)((()=>{const e=Date.now();let t=0;for(const r of d){const l=r.deref();l&&(t=v(Math.round(6e4*l.refreshInterval),t),l.refreshInterval?h.get(l)||h.set(l,e):h.delete(l))}if(t!==w){if(w=t,clearInterval(g),0===w)return void(g=0);g=setInterval(I,w)}}));const A=.1,_=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,i.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||f(this)}),(()=>{}))}destroy(){y(this)}castRefreshInterval(e){return e>=A?e:e<=0?0:A}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,i.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{s.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,l._)([(0,n.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.K}}}}})],t.prototype,"refreshInterval",void 0),(0,l._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,l._)([(0,n.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,l._)([(0,n.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,l._)([(0,o.$)("esri.layers.mixins.RefreshableLayer")],t),t}},25453:function(e,t,r){r.d(t,{x:function(){return u}});var l,s=r(40399),i=r(17010),n=r(38308),a=r(36861),o=(r(9302),r(8660),r(39834));let u=l=class extends i.oY{constructor(e){super(e)}clone(){return new l({customLayerParameters:(0,n.o8)(this.customLayerParameters),customParameters:(0,n.o8)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};(0,s._)([(0,a.MZ)({json:{type:Object,write:!0}})],u.prototype,"customLayerParameters",void 0),(0,s._)([(0,a.MZ)({json:{type:Object,write:!0}})],u.prototype,"customParameters",void 0),(0,s._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"layerIdentifier",void 0),(0,s._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"tileMatrixSet",void 0),(0,s._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"url",void 0),u=l=(0,s._)([(0,o.$)("esri.layers.support.WMTSLayerInfo")],u)},25292:function(e,t,r){r.d(t,{C:function(){return n},m:function(){return i}});var l=r(18244),s=r(13570);async function i(e,t,r){let i;try{i=await createImageBitmap(e)}catch(n){throw new l.A("request:server",`Unable to load ${t}`,{url:t,error:n})}return(0,s.Te)(r),i}async function n(e,t,r,i,n){let a;try{a=await createImageBitmap(e)}catch(o){throw new l.A("request:server",`Unable to load tile ${t}/${r}/${i}`,{error:o,level:t,row:r,col:i})}return(0,s.Te)(n),a}},92153:function(e,t,r){r.d(t,{It:function(){return h},LG:function(){return a},OM:function(){return p},Y:function(){return o},bK:function(){return u},mm:function(){return d},sQ:function(){return c}});r(44114);var l=r(40162),s=r(70616),i=r(22193);async function n(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,i.ci)(e);const r=s.A.WGS84;return await(0,l.initializeProjection)(t,r),(0,l.project)(e,r)}function a(e,t){if(!o(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function o(e,t){return!!e.typeKeywords?.includes(t)}function u(e){return o(e,d.HOSTED_SERVICE)}function p(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}async function c(e){const t=e.clone().normalize();let r;if(t.length>1)for(const l of t)r?l.width>r.width&&(r=l):r=l;else r=t[0];return n(r)}const d={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function h(e){const{portal:t,isOrgItem:r,itemControl:l}=e,s=t.user?.privileges;let i=!s||s.includes("features:user:edit"),n=!!r&&!!s?.includes("features:user:fullEdit");const a="update"===l||"admin"===l;return a?n=i=!0:n&&(i=!0),{features:{edit:i,fullEdit:n},content:{updateItem:a}}}}}]);
//# sourceMappingURL=9664.6be11d12.js.map
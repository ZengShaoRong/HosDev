"use strict";(self["webpackChunkvue_arcgis_0905"]=self["webpackChunkvue_arcgis_0905"]||[]).push([[759],{49885:function(e,t,n){n.d(t,{w:function(){return s}});n(44114);var r=n(39930),i=(n(9302),n(73405)),o=n(40148);class s{constructor(e=9,t){this._compareMinX=h,this._compareMinY=f,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),T.prune(),x.prune(),C.prune()}all(e){l(this._data,e)}search(e,t){let n=this._data;const r=this._toBBox;if(I(e,n))for(w.clear();n;){for(let i=0,o=n.children.length;i<o;i++){const o=n.children[i],s=n.leaf?r(o):o;I(e,s)&&(n.leaf?t(o):_(e,s)?l(o,t):w.push(o))}n=w.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!I(e,t))return!1;for(w.clear();t;){for(let r=0,i=t.children.length;r<i;r++){const i=t.children[r],o=t.leaf?n(i):i;if(I(e,o)){if(t.leaf||_(e,o))return!0;w.push(i)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new S([]),this}remove(e){if(!e)return this;let t,n=this._data,i=null,o=0,s=!1;const a=this._toBBox(e);for(x.clear(),C.clear();n||x.length>0;){if(n||(n=x.pop(),i=x.data[x.length-1],o=C.pop()??0,s=!0),n.leaf&&(t=(0,r.qh)(n.children,e,n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),x.push(n),this._condense(x),this;s||n.leaf||!_(n,a)?i?(o++,n=i.children[o],s=!1):n=null:(x.push(n),C.push(o),o=0,i=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,n,r){const i=n-t+1;let o=this._maxEntries;if(i<=o){const r=new S(e.slice(t,n+1));return c(r,this._toBBox),r}r||(r=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/o**(r-1)));const s=new A([]);s.height=r;const a=Math.ceil(i/o),l=a*Math.ceil(Math.sqrt(o));b(e,t,n,l,this._compareMinX);for(let u=t;u<=n;u+=l){const t=Math.min(u+l-1,n);b(e,u,t,a,this._compareMinY);for(let n=u;n<=t;n+=a){const i=Math.min(n+a-1,t);s.children.push(this._build(e,n,i,r-1))}}return c(s,this._toBBox),s}_insert(e,t,n){const r=this._toBBox,i=n?e:r(e);x.clear();const o=a(i,this._data,t,x);for(o.children.push(e),p(o,i);t>=0&&x.data[t].children.length>this._maxEntries;)this._split(x,t),t--;u(i,x,t)}_split(e,t){const n=e.data[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);const o=this._chooseSplitIndex(n,i,r);if(!o)return;const s=n.children.splice(o,n.children.length-o),a=n.leaf?new S(s):new A(s);a.height=n.height,c(n,this._toBBox),c(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this._data=new A([e,t]),this._data.height=e.height+1,c(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let r,i,o;r=i=1/0;for(let s=t;s<=n-t;s++){const t=d(e,0,s,this._toBBox),a=d(e,s,n,this._toBBox),l=M(t,a),u=y(t)+y(a);l<r?(r=l,o=s,i=u<i?u:i):l===r&&u<i&&(i=u,o=s)}return o}_chooseSplitAxis(e,t,n){const r=e.leaf?this._compareMinX:h,i=e.leaf?this._compareMinY:f;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const i=this._toBBox,o=d(e,0,t,i),s=d(e,n-t,n,i);let a=m(o)+m(s);for(let l=t;l<n-t;l++){const t=e.children[l];p(o,e.leaf?i(t):t),a+=m(o)}for(let l=n-t-1;l>=t;l--){const t=e.children[l];p(s,e.leaf?i(t):t),a+=m(s)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const i=e.data[t-1],o=i.children;o.splice((0,r.qh)(o,n,o.length,i.indexHint),1)}else this.clear();else c(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t,n,r){for(;r.push(t),!0!==t.leaf&&r.length-1!==n;){let n,r=1/0,i=1/0;for(let o=0,s=t.children.length;o<s;o++){const s=t.children[o],a=y(s),l=g(e,s)-a;l<i?(i=l,r=a<r?a:r,n=s):l===i&&a<r&&(r=a,n=s)}t=n||t.children[0]}return t}function l(e,t){let n=e;for(T.clear();n;){if(!0===n.leaf)for(const e of n.children)t(e);else T.pushArray(n.children);n=T.pop()??null}}function u(e,t,n){for(let r=n;r>=0;r--)p(t.data[r],e)}function c(e,t){d(e,0,e.children.length,t,e)}function d(e,t,n,r,i){i||(i=new S([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o,s=t;s<n;s++)o=e.children[s],p(i,e.leaf?r(o):o);return i}function p(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function h(e,t){return e.minX-t.minX}function f(e,t){return e.minY-t.minY}function y(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function m(e){return e.maxX-e.minX+(e.maxY-e.minY)}function g(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function M(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function _(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function I(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function b(e,t,n,r,i){const s=[t,n];for(;s.length;){const t=s.pop(),n=s.pop();if(t-n<=r)continue;const a=n+Math.ceil((t-n)/r/2)*r;(0,o.q)(e,a,n,t,i),s.push(n,a,a,t)}}const w=new i.A,T=new i.A,x=new i.A,C=new i.A({deallocator:void 0});class E{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class v extends E{constructor(){super(...arguments),this.height=1,this.indexHint=new r.vW}}class S extends v{constructor(e){super(),this.children=e,this.leaf=!0}}class A extends v{constructor(e){super(),this.children=e,this.leaf=!1}}},26824:function(e,t,n){n.d(t,{F:function(){return c}});n(44114),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r=n(9302),i=n(49885),o=n(92373);const s=5e4,a={minX:0,minY:0,maxX:0,maxY:0};function l(e){a.minX=e[0],a.minY=e[1],a.maxX=e[2],a.maxY=e[3]}function u(e,t,n){l(t),e.search(a,n)}class c{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new i.w(9,(0,r.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,r)=>{e[t++]=r})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,o.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),u(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>s&&this._loadIndex()))}}},95019:function(e,t,n){n.d(t,{A:function(){return f}});n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r=n(39930),i=n(18244),o=n(41755),s=n(8660),a=n(16686),l=n(92373),u=n(3234),c=n(26824),d=n(92759),p=n(82792);const h=(0,a.vt)();class f{constructor(e){this.geometryInfo=e,this._boundsStore=new c.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new o.A,this.featureAdapter=p.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,n,r,i]=this.fullBounds;return{xmin:t,ymin:n,xmax:r,ymax:i,spatialReference:(0,d.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(r.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const n of e){const e=this._boundsStore.get(n.objectId);e&&t((0,a.Jt)(h,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,n)=>{this._markedIds.has(n)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const n=this._featuresById.get(t);let r;if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=(0,u.jQ)(null!=r?r:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(t,r),this._featuresById.set(t,e)}_upsert(e){const t=e?.objectId;if(null==t)return s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const n=this._featuresById.get(t);if(!n)return this._add(e),e;this._markedIds.add(t);const{geometry:r,attributes:o}=e;for(const i in o)n.attributes[i]=o[i];return r&&(n.geometry=r,this._boundsStore.set(t,(0,u.jQ)((0,l.vt)(),r,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),n}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._markedIds.delete(t),this._boundsStore.delete(t),this._featuresById.delete(t),e}}},9232:function(e,t,n){n.d(t,{F0:function(){return a},Vx:function(){return c},e2:function(){return p},f:function(){return h}});var r=n(9302),i=n(38308),o=n(50962),s=n(67700);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.Cb:"esriGeometryPolyline"===e?s.yM:s.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function c(e,t){if((0,r.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n=`this${d(t)} = null;`;for(const t in e)n+=`this${d(t)} = ${JSON.stringify(e[t])};`;const r=new Function(`\n      return class AttributesClass$${u++} {\n        constructor() {\n          ${n};\n        }\n      }\n    `)();return()=>new r}catch(n){return()=>({[t]:null,...e})}}function d(e){return l.test(e)?`.${e}`:`["${e}"]`}function p(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function h(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:o.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},53963:function(e,t,n){n.d(t,{PB:function(){return k},d4:function(){return A},ZL:function(){return v},sZ:function(){return S},yC:function(){return C},Vr:function(){return E}});n(44114),n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698);var r=n(40399),i=(n(32334),n(13592)),o=n(18244),s=n(8660),a=n(71207),l=n(6002),u=n(36861),c=(n(9302),n(95753),n(39834)),d=n(2311),p=n(40162),h=n(84427),f=n(3234),y=n(80088),m=n(55910);const g="ESRI__DESTINATION_ID",M="ESRI__ORIGIN_ID";class _{constructor(){this._featureLookup=new Map}static getInstance(){return _.instance||(_.instance=new _),_.instance}static resetInstance(){_.instance&&(_.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const n=this.readFromStoreById(e);n&&t.push(n)})),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,n){const r=[];return e.forEach((e=>{if(!e?.id)return;e.properties||(e.properties=[]);let i,o=null;if(n&&e.properties[n]&&(o=(0,f.Ux)(e.properties[n])),"originId"in e&&"destinationId"in e&&(e.properties[M]=e.originId,e.properties[g]=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const r=this._featureLookup.get(e.id),s=JSON.parse(JSON.stringify(Object.assign(r.attributes,e.properties)));n&&e.properties[n]&&(s[n]=(0,m.rS)(e.properties[n])),i=new y.Om(o?JSON.parse(JSON.stringify(o)):r?.geometry?JSON.parse(JSON.stringify(r.geometry)):null,s,null,e.properties[t])}else i=new y.Om(o?JSON.parse(JSON.stringify(o)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,i),r.push(i)})),r}}var I=n(69235),b=n(22726),w=n(17719),T=n(28767),x=n(79429);const C="ESRI__ID",E="ESRI__ORIGIN_ID",v="ESRI__DESTINATION_ID",S="ESRI__LAYOUT_GEOMETRY",A="ESRI__AGGREGATION_COUNT";let k=class extends i.A{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach((n=>{n.name&&(t.set(n.name,"entity"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(n.name),n.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(n.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((n=>{n.name&&(t.set(n.name,"relationship"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(n.name),n.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(n.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((n,r)=>{if("entity"===t.get(r))this.entityTypeNames.add(r);else{if("relationship"!==t.get(r))return s.A.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);this.relationshipTypeNames.add(r)}const i=new Map;n.members?.forEach((e=>{(0,a.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(r);const t=this.getById(e.id);t&&i.set(e.id,t)})),this.sublayerCaches.set(r,i)}))}addToLayer(e){e.forEach((({typeName:e,id:t})=>{if(!this.inclusionModeDefinition)throw new o.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(e);n.members||(n.members=new Map),n.members.set(t,{id:t}),(0,a.tE)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}else{const n=new Map;n.set(t,{id:t}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:n}),(0,a.tE)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}))}getById(e){return _.getInstance().readFromStoreById(e)}async getData(e,t,n){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let r;if(r=e||new T.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){const e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(t.objectType.name??""),i=r.outFields;i&&1===i.length&&i[0]===C&&"1=1"===r.where||await Promise.all(n??[]);const o=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],s=[];return o.forEach((n=>{this.relationshipTypeNames.has(t.objectType.name)?n.geometry=e.relationshipLinkChartDiagramLookup.get(n.attributes[t.objectIdField]):n.geometry=e.entityLinkChartDiagramLookup.get(n.attributes[t.objectIdField]),n.attributes[S]=n.geometry,s.push(n)})),s}return this.retrieveDataFromService(r,t,n)}async getConnectedRecordIds(e,t){const n=[];let r="";const i=[],o=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(t))return;o.has(t)?o.get(t)?.push(e):o.set(t,[e])}})),t&&0!==t?.length){for(const e of t)r=r+e+"|";r=r.slice(0,-1)}return o.forEach(((e,o)=>{let a;a=t&&0!==t?.length?`MATCH (n:${o})-[r:${r}]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${o})-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`;const l=new Promise((t=>{(async()=>{const t=(await(0,b.executeQueryStreaming)(this.knowledgeGraph,new w.A({openCypherQuery:a,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)break;for(let t=0;t<r.length;t++){const e=r[t];n.push({id:e[0],typeName:e[1]}),n.push({id:e[2],typeName:e[3]})}}}catch(r){if("AbortError"!==r.name)throw r;s.A.getLogger(this).info("Request aborted as expected")}})().then((()=>{t()}))}));i.push(l)})),this.refreshCacheContent(),await Promise.all(i),n}async getAttachedRelationships(e,t){const n=[],r="MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",i=(await(0,b.executeQueryStreaming)(this.knowledgeGraph,new w.A({openCypherQuery:r,bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await i.read();if(e)break;for(let r=0;r<t.length;r++){const e=t[r];n.push({id:e[0],typeName:e[1]})}}}catch(o){if("AbortError"!==o.name)throw o;s.A.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,n,r=!0){const i=_.getInstance(),s=[],l=new Map,u=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&u.set(e.name,e)})),this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&u.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e))l.has(t)?l.get(t)?.push(e):l.set(t,[e])})):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e.useAllData?l.set(t,null):e.members&&e.members.forEach((e=>{l.has(t)&&null!==l.get(t)?l.get(t)?.push(e.id):l.set(t,[e.id])}))})):(this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&l.set(e.name,null)})),this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&l.set(e.name,null)})));for(const[c,d]of l){const e=new Promise((e=>{const s=async()=>{const e=new Set,s=[];let l,p="",h=!1;if(t||u.get(c)?.properties?.forEach((t=>{t.name&&e.add(t.name)})),n&&this.geographicLookup.has(c)){const t=this.geographicLookup.get(c)?.name;t&&e.add(t)}if(this.entityTypeNames.has(c))p=`MATCH (n:${c}) ${d?"WHERE id(n) IN $ids ":""}return ID(n)`,e.forEach((e=>{p+=`, n.${e}`,s.push(e)}));else{if(!this.relationshipTypeNames.has(c))throw new o.A("knowledge-graph:layer-data-manager",`The graph type of ${c} could not be determined. Was this type set in the KG data model and inclusion definition?`);h=!0,p=`MATCH ()-[n:${c}]->() ${d?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,e.forEach((e=>{p+=`, n.${e}`,s.push(e)}))}l=new w.A(d?{openCypherQuery:p,bindParameters:{ids:d}}:{openCypherQuery:p});const f=(await(0,b.executeQueryStreaming)(this.knowledgeGraph,l)).resultRowsStream.getReader();for(;;){const{done:e,value:t}=await f.read();if(e)break;const n=[];for(let r=0;r<t.length;r++){const e=t[r];let i=0,o=0;const l={properties:{}};for(l.id=e[i],i++,o++,h&&(l.originId=e[i],i++,o++,l.destinationId=e[i],i++,o++,(0,a.tE)(this.nodeConnectionsLookup,l.originId,(()=>new Set)).add(l.id),(0,a.tE)(this.nodeConnectionsLookup,l.destinationId,(()=>new Set)).add(l.id),(0,a.tE)(this.relationshipConnectionsLookup,l.id,(()=>[l.originId,l.destinationId])));i<e.length;i++)l.properties[s[i-o]]=e[i];n.push(l)}const o=i.writeToStore(n,C,this.geographicLookup.get(c)?.name);this.sublayerCaches.has(c)||this.sublayerCaches.set(c,new Map),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(c)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(c,{useAllData:!1,members:new Map}),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(c).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(c).members=new Map);const l=this.sublayerCaches.get(c);o.forEach((e=>{l?.set(e.attributes[C],e),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(c).members.has(e.attributes[C])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(c).members.set(e.attributes[C],{id:e.attributes[C]}),(0,a.tE)(this.memberIdTypeLookup,e.attributes[C],(()=>new Set)).add(c))}))}};s().then((()=>{e(null)}))}));s.push(e),this._processingCacheUpdatesLookup.get(c)?.push(e)}await Promise.all(s)}removeFromLayer(e){const t=new Set,n=new Set(e.map((e=>e.id)));for(const r of e)t.add(r.typeName),1===this.memberIdTypeLookup.get(r.id)?.size?this.memberIdTypeLookup.delete(r.id):this.memberIdTypeLookup.get(r.id)?.delete(r.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{t===r.typeName&&e.members?.has(r.id)&&e.members.delete(r.id)}));t.forEach((e=>{this.sublayerCaches.get(e)?.forEach(((t,r)=>{n.has(r)&&this.sublayerCaches.get(e)?.delete(r)}))}))}async retrieveDataFromService(e,t,n){const r=_.getInstance(),i=new Set,s=[];let a,u="",c=[];const f="relationship"===t.graphType,y=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,m=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let g=!y&&m?Array.from(m).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&null!=e.objectIds&&(g=e.objectIds);else if(null!=e.objectIds&&g&&g.length>0){const t=e.objectIds;e.objectIds=g.filter((e=>t.includes(e)))}else if(null!=e.objectIds)g=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=g}if(null!=e.outFields){const n=e.outFields;n.includes("*")?t.fields.forEach((e=>{i.add(e.name)})):n.forEach((e=>{e!==C&&e!==t.geometryFieldName&&i.add(e)}))}if(null!=e.geometry){const n=e.geometry;let r;const c=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,y=c?.spatialReference,m=c?.serviceCapabilities?.geometryCapabilities;let g=m?.geometryMaxBoundingRectangleSizeX,M=m?.geometryMaxBoundingRectangleSizeY;if(n?.extent?.spatialReference&&!n.spatialReference?.isWGS84?(await(0,p.initializeProjection)(n.extent.spatialReference,h.KK),r=(0,p.project)(n.extent,h.KK)):r=n.extent,g&&M&&y){if(4326!==y.wkid){const e=new x.A({spatialReference:y,xmax:g,ymax:M}),t=(0,p.project)(e,h.KK);g=t.xmax,M=t.ymax}if(r.xmax-r.xmin>g)throw new o.A("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${g}° latitude, limit exceeded`);if(r.ymax-r.ymin>M)throw new o.A("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${M}° longitude, limit exceeded`)}if(null!=e.where&&"1=1"!==e.where){const n=await(0,l.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&i.add(e.name)}))}u=f?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{u+=`, n.${e}`,s.push(e)})),a=new w.A({openCypherQuery:u,bindParameters:{param_filter_geom:new d.A({rings:(0,I.DX)(r)})}})}else{let n="";if(null!=e.where&&"1=1"!==e.where){const r=await(0,l.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&i.add(e.name)}));const o=new Set(["column-reference","string","number","binary-expression"]),s=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const u=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&o.has(e.left.type)&&o.has(e.right.type)&&s.has(e.operator))return`${u(e.left)} ${e.operator} ${u(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let n=e.right.value;"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),t+=`'${n.toLowerCase()}')`}return t}return a=!0,""};n=u(r.parseTree),a&&(n="")}let r="";r=f?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let o=!1;g&&(o=!0,r+=" WHERE ID(n) IN $ids"),n&&(r+=o?" AND":" WHERE",r+=` ${n}`),r+=" return ID(n)",f&&(r+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{r+=`, n.${e}`,s.push(e)})),a=new w.A(g?{openCypherQuery:r,bindParameters:{ids:g}}:{openCypherQuery:r})}const M=(await(0,b.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,a,n)).resultRowsStream.getReader();for(;;){const{done:e,value:n}=await M.read();if(e)break;const i=[];for(let t=0;t<n.length;t++){const e=n[t];let r=0,o=0;const a={properties:{}};for(a.id=e[r],r++,o++,f&&(a.originId=e[r],r++,o++,a.destinationId=e[r],r++,o++);r<e.length;r++)a.properties[s[r-o]]=e[r];i.push(a)}c=c.concat(r.writeToStore(i,C,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return c}};(0,r._)([(0,u.MZ)()],k.prototype,"knowledgeGraph",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"inclusionModeDefinition",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"entityTypeNames",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"relationshipTypeNames",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"geographicLookup",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"sublayerCaches",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"nodeConnectionsLookup",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"relationshipConnectionsLookup",void 0),(0,r._)([(0,u.MZ)()],k.prototype,"memberIdTypeLookup",void 0),k=(0,r._)([(0,c.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],k)},5182:function(e,t,n){n.d(t,{A:function(){return W}});n(44114);var r=n(40399),i=(n(32334),n(83209)),o=(n(93276),n(25634),n(95901),n(23581),n(91458),n(97120),n(61470),n(70379),n(16048)),s=n(8526),a=n(38308),l=n(91354),u=(n(8388),n(36861)),c=(n(9302),n(8660),n(39834)),d=n(63955),p=n(96140),h=n(40162),f=n(70616),y=n(84427),m=n(81182),g=n(95019),M=n(37235),_=n(9232),I=n(53963),b=(n(95753),n(33158));const w=(0,b.p)(),T=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,r._)([(0,u.MZ)(w.fields)],t.prototype,"fields",void 0),(0,r._)([(0,u.MZ)(w.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,r._)([(0,c.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var x=n(22528),C=n(64240),E=n(22210),v=n(25462),S=n(45871),A=n(60522),k=n(6569),D=n(79019),N=n(1774),L=n(63535),R=n(12014),B=n(71214),j=n(9961),O=n(8917),F=n(28767),G=n(4421),P=n(87512),Z=n(79429),q=n(2311),$=n(93277),Y=n(83616);function Q(e){if(!e.json)return e;e.json.write=X(e.json.write);const t=e.json.origins;if(!t)return e;let n;for(n in t){const e=t[n];e&&(e.write=X(e.write))}return e}function X(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=z(e)),e):!0===e?J():e}function z(e){const{target:t,writer:n,overridePolicy:r,...i}=e;return function(e,t){const n=U.call(this,e,t);return n.enabled?{...i,...n}:n}}function J(){return{overridePolicy:U}}function U(e,t){const n=!!this.geometryType;let r={enabled:n};return n&&(r={...r,...V.call(this,e,t)}),r}function V(e,t){return{ignoreOrigin:this.originIdOf(t)>p.Gr.DEFAULTS}}let H=class extends(T((0,E.J)((0,C.F)((0,x.dM)((0,v.f)((0,k.e)((0,A.j)((0,S.J)((0,l.P)(m.A)))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=(0,_.f)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=I.yC,this.objectType=null,this.opacity=1,this.orderBy=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new P.A(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{const n=F.A.fromJSON(e);return this.queryFeaturesJSON(n,t)}}}),[e.port2]}))},this.title=null,this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){const e=[];return this.objectType?.properties?.forEach((t=>{const n="esriFieldTypeOID"===t.fieldType?"esriFieldTypeInteger":t.fieldType;e.push(L.A.fromJSON({name:t.name,type:n,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))})),e.push(L.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),L.A.fromJSON({name:I.d4,type:"esriFieldTypeInteger",alias:I.d4,editable:!1})),e}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&"esriGeometryNull"!==t?Y.g.fromJSON(t):null}get geometryFieldName(){if("link-chart"===this.parentCompositeLayer?.type)return I.sZ;const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);return e?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,n=t?this.objectType?.properties?.[t]:null;return n?.hasM??!1}get hasZ(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,n=t?this.objectType?.properties?.[t]:null;return n?.hasZ??!1}set renderer(e){(0,R.yp)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===this.parentCompositeLayer?.type?"relationship"===this.graphType?(0,o.r)((0,_.F0)(Y.g.toJSON("polyline")).renderer):(0,o.r)((0,_.F0)(Y.g.toJSON("point")).renderer):(0,o.r)((0,_.F0)(Y.g.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??f.A.WGS84}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return(0,G.tn)(this,e)}createQuery(){return new F.A({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e),i=O.A.fromJSON(await r.executeQuery(n.toJSON(),t?.signal));return i.features.forEach((e=>{e.sourceLayer=this})),i}async queryFeaturesJSON(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return await r.executeQuery(n.toJSON(),t?.signal)}async queryFeatureCount(e,t){const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return r.executeQueryForCount(n.toJSON(),t?.signal)}async queryExtent(e={},t){const n={...e,returnGeometry:!0},{resolvedQuery:r,queryEngine:i}=await this._setupQueryObjects(n),o=await i.executeQueryForExtent(r.toJSON(),t?.signal);let s;return s=null!=o.extent?.xmin&&null!=o.extent?.xmax&&null!=o.extent?.ymin&&null!=o.extent?.ymax?new Z.A(o.extent):new Z.A,{count:o.count,extent:s}}async queryObjectIds(e,t){const n=F.A.from(e);let r;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);r=this.loadQueryEngine(e)}return r.executeQueryForIds(n.toJSON(),t?.signal)}loadQueryEngine(e){const t=new g.A({geometryType:Y.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new M.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:Y.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new F.A({where:"1=1",outFields:[I.yC]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){const n=F.A.from(e),r=n.geometry;let i;if(r&&!r.spatialReference?.isWGS84&&(await(0,h.initializeProjection)(r.spatialReference,y.KK),n.geometry=(0,h.project)(r instanceof q.A||r instanceof $.A?r:r.extent,y.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);i=this.loadQueryEngine(e)}return{resolvedQuery:n,queryEngine:i}}};(0,r._)([(0,u.MZ)(Q((0,a.o8)(x.sU)))],H.prototype,"blendMode",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"capabilities",void 0),(0,r._)([(0,u.MZ)({json:{origins:{"web-scene":{write:!1}},write:J()}})],H.prototype,"charts",void 0),(0,r._)([(0,u.MZ)({readOnly:!0})],H.prototype,"defaultPopupTemplate",null),(0,r._)([(0,u.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],H.prototype,"definitionExpression",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"displayField",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(x.LF)))],H.prototype,"effect",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"elevationInfo",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(C.Y)))],H.prototype,"featureEffect",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(N.d)))],H.prototype,"featureReduction",null),(0,r._)([(0,u.MZ)()],H.prototype,"fields",null),(0,r._)([(0,u.MZ)()],H.prototype,"geometryType",null),(0,r._)([(0,u.MZ)()],H.prototype,"geometryFieldName",null),(0,r._)([(0,u.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],H.prototype,"graphType",void 0),(0,r._)([(0,u.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],H.prototype,"graphTypeName",null),(0,r._)([(0,u.MZ)()],H.prototype,"hasM",null),(0,r._)([(0,u.MZ)()],H.prototype,"hasZ",null),(0,r._)([(0,u.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],H.prototype,"id",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(D.kF)))],H.prototype,"labelsVisible",void 0),(0,r._)([(0,u.MZ)({type:[B.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:j.w,write:J()}})],H.prototype,"labelingInfo",void 0),(0,r._)([(0,u.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],H.prototype,"layerType",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(D.fV)))],H.prototype,"legendEnabled",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(D.hG)))],H.prototype,"maxScale",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(D.hn)))],H.prototype,"minScale",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"objectIdField",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"objectType",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(D.ke)))],H.prototype,"opacity",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(v.n)))],H.prototype,"orderBy",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"parentCompositeLayer",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(D.M6)))],H.prototype,"popupEnabled",void 0),(0,r._)([(0,u.MZ)({type:i.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],H.prototype,"popupTemplate",void 0),(0,r._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy:V}}})],H.prototype,"refreshInterval",void 0),(0,r._)([(0,u.MZ)({types:s.H,json:{name:"layerDefinition.drawingInfo.renderer",write:J()}})],H.prototype,"renderer",null),(0,r._)([(0,u.MZ)()],H.prototype,"source",void 0),(0,r._)([(0,u.MZ)()],H.prototype,"spatialReference",null),(0,r._)([(0,u.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],H.prototype,"title",void 0),(0,r._)([(0,d.K)("title")],H.prototype,"writeTitle",null),(0,r._)([(0,u.MZ)({json:{read:!1}})],H.prototype,"type",void 0),(0,r._)([(0,u.MZ)(Q((0,a.o8)(k.B)))],H.prototype,"useViewTime",void 0),(0,r._)([(0,u.MZ)({type:Boolean,json:{name:"visibility",write:J()}})],H.prototype,"visible",void 0),H=(0,r._)([(0,c.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],H);const W=H},69235:function(e,t,n){n.d(t,{DX:function(){return m},_s:function(){return M},aq:function(){return g},fe:function(){return _}});n(44114),n(16573),n(78100),n(77936),n(37467),n(44732),n(79577),n(64979),n(71678);var r,i=n(5049),o=n(18244),s=n(71207),a=(n(3234),n(22726)),l=n(17719);n(32334),n(70616);!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(r||(r={}));r.ELEMENTUID,r.TYPENAME;var u,c;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(u||(u={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(c||(c={}));var d,p,h,f,y=n(582);n(91870);function m(e){if(!e.spatialReference.isWGS84)throw new o.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function g(e,t){const n=[],r=new Map,i=[];if(t.dataModel?.relationshipTypes)for(const o of t.dataModel.relationshipTypes)o.name&&r.set(o.name,[]);for(const o of e)r.has(o.typeName)&&r.get(o.typeName)?.push(o.id);for(const[o,s]of r){if(s.length<1)continue;const e=new l.A({openCypherQuery:`MATCH (n)-[r:${o}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:s}});i.push((0,a.executeQueryStreaming)(t,e).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:r}=await t.read();if(e)break;for(const t of r)n.push({id:t[0],typeName:t[1]}),n.push({id:t[2],typeName:t[3]})}})))}return await Promise.all(i),n}async function M(e,t){t??=!1;const n={generateAllSublayers:t,namedTypeDefinitions:new Map};return await b(e).then((e=>{T(e,n)})),n}async function _(e){const t=await(0,y.I)(),n=new t.MapOfObjectIdentifierSets;I(n,t,e);const r=new t.MapOfObjectIdentifierSetsEncoder;try{r.set_map_of_identifier_sets(n),r.encode();const e=r.get_encoding_result();if(0!==e.error.error_code)throw new o.A("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return r.delete(),t}finally{n.delete()}}function I(e,t,n){for(const[r,i]of n.namedTypeDefinitions){if(!i.members||i.useAllData)continue;const n=i.members.keys(),o=new t.GlobalIdArray,s=new t.ObjectIdentifierSet;for(const e of n)o.add_globalid(e);s.set_globalid_array(o),o.delete(),e.put_identifier_set(r,s),s.delete()}return e}async function b(e){const t=await(0,i.A)(e,{responseType:"array-buffer"}),n=await t.data;return w(new Uint8Array(n))}async function w(e){const t=new((await(0,y.I)()).MapOfObjectIdentifierSetsDecoder),n=t.decode(new Uint8Array(e)),r=new Map;if(0!==n.error_code)throw new o.A("knowledge-graph:layer-support-utils",n.error_message);const i=t.get_map_of_identifier_sets(),s=i.keys,a=s.size();for(let l=0;l<a;l++){const e=s.get(l),t=i.query_identifier_set(e),n=[];if(t.id_array_type.value===f.GLOBALID_ARRAY){const e=t.get_globalid_array(),r=e.count();for(let t=0;t<r;t++)n.push(e.get_globalid_at(t))}else{if(t.id_array_type.value!==f.IDENTIFIER_ARRAY)throw new o.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=t.get_identifier_array(),r=e.count();for(let t=0;t<r;t++)n.push(e.get_identifier_at(t).toString())}}r.set(e,n)}return t.delete(),r}function T(e,t){for(const[n,r]of e){const e=(0,s.tE)(t.namedTypeDefinitions,n,(()=>({useAllData:!1,members:new Map})));for(const t of r)e.members.has(t)||e.members.set(t,{id:t})}return t}!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(d||(d={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(p||(p={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(h||(h={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(f||(f={}))},25462:function(e,t,n){n.d(t,{f:function(){return d},n:function(){return c}});var r=n(40399),i=n(3243),o=n(36861),s=(n(9302),n(8660),n(95753),n(39834)),a=n(59474);function l(e,t,n){if(!e)return null;const r=e.find((e=>!!e.field));if(!r)return null;const i=new a.A;return i.read(r,n),[i]}function u(e,t,n,r){const o=e.find((e=>!!e.field));o&&(0,i.sM)(n,[o.toJSON()],t)}const c={type:[a.A],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:l},write:{writer:u}}},d=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return(0,r._)([(0,o.MZ)(c)],t.prototype,"orderBy",void 0),t=(0,r._)([(0,s.$)("esri.layers.mixins.OrderedLayer")],t),t}},45871:function(e,t,n){n.d(t,{J:function(){return w}});var r=n(40399),i=(n(9302),n(8660)),o=n(13570),s=n(36861),a=n(62163),l=(n(95753),n(39834)),u=n(54971),c=(n(44114),n(81677)),d=(n(26461),n(18244),n(51548),n(74873));const p=new c.A,h=new WeakMap;function f(e){m(e)&&p.push(new WeakRef(e))}function y(e){const t=p.find((t=>t.deref()===e));t&&p.remove(t)}function m(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function g(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:g(t,e%t):0}let M=0,_=0;function I(){const e=Date.now();let t=!1;for(const n of p){const r=n.deref();r?r.refreshInterval&&e-(h.get(r)??0)+5>=6e4*r.refreshInterval&&(h.set(r,e),r.refresh(e)):t=!0}if(t)for(let n=p.length-1;n>=0;n--)p.at(n).deref()||p.removeAt(n)}(0,d.fm)((()=>{const e=Date.now();let t=0;for(const n of p){const r=n.deref();r&&(t=g(Math.round(6e4*r.refreshInterval),t),r.refreshInterval?h.get(r)||h.set(r,e):h.delete(r))}if(t!==_){if(_=t,clearInterval(M),0===_)return void(M=0);M=setInterval(I,_)}}));const b=.1,w=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,o.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||f(this)}),(()=>{}))}destroy(){y(this)}castRefreshInterval(e){return e>=b?e:e<=0?0:b}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,o.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{i.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,r._)([(0,s.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.K}}}}})],t.prototype,"refreshInterval",void 0),(0,r._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,r._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,r._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,r._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},59474:function(e,t,n){n.d(t,{A:function(){return d}});var r,i=n(40399),o=n(2914),s=n(17010),a=n(36861),l=(n(9302),n(8660),n(95753),n(39834));const u=new o.J({asc:"ascending",desc:"descending"});let c=r=class extends s.oY{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new r({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"field",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],c.prototype,"valueExpression",void 0),(0,i._)([(0,a.MZ)({type:u.apiValues,json:{type:u.jsonValues,read:u.read,write:u.write}})],c.prototype,"order",void 0),c=r=(0,i._)([(0,l.$)("esri.layers.support.OrderByInfo")],c);const d=c},1100:function(e,t,n){n.d(t,{BI:function(){return m},D3:function(){return f},XJ:function(){return y},lc:function(){return h},mX:function(){return M},rU:function(){return g},tH:function(){return x}});var r=n(45557);const i="__begin__",o="__end__",s=new RegExp(i,"ig"),a=new RegExp(o,"ig"),l=new RegExp("^"+i,"i"),u=new RegExp(o+"$","i"),c='"',d=c+" + ",p=" + "+c;function h(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function f(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function y(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=h(e.labelExpression),t.type="conventional"),t}function m(e){const t=y(e);if(!t)return null;switch(t.type){case"conventional":return M(t.expression);case"arcade":return t.expression}return null}function g(e){const t=y(e);if(!t)return null;switch(t.type){case"conventional":return I(t.expression);case"arcade":return x(t.expression)}return null}function M(e){let t;return e?(t=(0,r.HC)(e,(e=>i+'$feature["'+e+'"]'+o)),t=l.test(t)?t.replace(l,""):c+t,t=u.test(t)?t.replace(u,""):t+c,t=t.replaceAll(s,d).replaceAll(a,p)):t='""',t}const _=/^\s*\{([^}]+)\}\s*$/i;function I(e){const t=e?.match(_);return t?.[1].trim()||null}const b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,w=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,T=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function x(e){if(!e)return null;let t=b.exec(e)||w.exec(e);return t?t[1]||t[3]:(t=T.exec(e),t?t[2]:null)}},49497:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(40399),i=(n(32334),n(36861)),o=(n(9302),n(8660),n(95753),n(39834)),s=n(67376),a=n(86743);let l=class extends s.A{constructor(e){super(e),this.layoutGeometry=null}};(0,r._)([(0,i.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.Entity")],l);const u=l},67376:function(e,t,n){n.d(t,{A:function(){return l}});var r=n(40399),i=n(36861),o=(n(9302),n(8660),n(95753),n(39834)),s=n(19687);let a=class extends s.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a);const l=a},19687:function(e,t,n){n.d(t,{A:function(){return l}});var r=n(40399),i=n(17010),o=n(36861),s=(n(9302),n(8660),n(95753),n(39834));let a=class extends i.oY{constructor(e){super(e),this.properties=null}};(0,r._)([(0,o.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,r._)([(0,s.$)("esri.rest.knowledgeGraph.GraphObject")],a);const l=a},17719:function(e,t,n){n.d(t,{A:function(){return c}});var r=n(40399),i=n(36861),o=(n(9302),n(8660),n(95753),n(39834)),s=n(13592);let a=class extends s.A{constructor(e){super(e),this.openCypherQuery=""}};(0,r._)([(0,i.MZ)()],a.prototype,"openCypherQuery",void 0),a=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQuery")],a);const l=a;let u=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,r._)([(0,i.MZ)()],u.prototype,"bindParameters",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"bindGeometryQuantizationParameters",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"outputQuantizationParameters",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"outputSpatialReference",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"provenanceBehavior",void 0),u=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],u);const c=u},12980:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(40399),i=(n(8660),n(9302),n(95753),n(18244),n(39834)),o=n(19687);let s=class extends o.A{constructor(e){super(e)}};s=(0,r._)([(0,i.$)("esri.rest.knowledgeGraph.ObjectValue")],s);const a=s},5213:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(40399),i=n(17010),o=n(36861),s=(n(9302),n(8660),n(95753),n(39834)),a=n(19687);let l=class extends i.oY{constructor(e){super(e),this.path=null}};(0,r._)([(0,o.MZ)({type:[a.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,r._)([(0,s.$)("esri.rest.knowledgeGraph.Path")],l);const u=l},62700:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(40399),i=(n(32334),n(36861)),o=(n(9302),n(8660),n(95753),n(39834)),s=n(67376),a=n(93277);let l=class extends s.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,r._)([(0,i.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.Relationship")],l);const u=l},57242:function(e,t,n){n.d(t,{D:function(){return i},K:function(){return r}});const r={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},i={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0}}},80139:function(e,t,n){n.d(t,{$w:function(){return g},Bu:function(){return A},DW:function(){return C},FM:function(){return l},G9:function(){return i},GV:function(){return M},Go:function(){return c},K3:function(){return F},Kn:function(){return T},MM:function(){return h},MO:function(){return Z},Nl:function(){return k},Ny:function(){return _},O2:function(){return D},UE:function(){return N},YC:function(){return P},YF:function(){return R},ZO:function(){return j},_1:function(){return v},_H:function(){return b},_d:function(){return x},bs:function(){return G},e6:function(){return d},gQ:function(){return a},iA:function(){return O},jn:function(){return y},lW:function(){return p},mA:function(){return f},n5:function(){return L},pM:function(){return E},pV:function(){return w},pk:function(){return q},rB:function(){return $},xo:function(){return S},yH:function(){return I},zb:function(){return B},zr:function(){return m}});n(44114);var r=n(57242);function i(e){return[e.r,e.g,e.b,e.a]}const o=" /-,\n";function s(e){let t=e.length;for(;t--;)if(!o.includes(e.charAt(t)))return!1;return!0}function a(e,t){const n=[];let r=0,i=-1;do{if(i=e.indexOf("[",r),i>=r){if(i>r){const t=e.substr(r,i-r);n.push([t,null,s(t)])}if(r=i+1,i=e.indexOf("]",r),i>=r){if(i>r){const o=t[e.substr(r,i-r)];o&&n.push([null,o,!1])}r=i+1}}}while(-1!==i);if(r<e.length-1){const t=e.substr(r);n.push([t,null,s(t)])}return n}function l(e,t,n,r){let i="",o=null;for(const s of t){const[t,r,a]=s;if(t)a?o=t:(o&&(i+=o,o=null),i+=t);else{let t=r;null!=n&&(t=Z(r,n));const s=e.attributes[t];s&&(o&&(i+=o,o=null),i+=s)}}return u(i,r)}function u(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function c(e,t,n,r,i,o,s=!0){const a=t/i,l=n/o,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let d=0;d<o;d++)for(let n=0;n<i;n++){const p=4*(n+(s?o-d-1:d)*i);let h=0,f=0,y=0,m=0,g=0,M=0,_=0;const I=(d+.5)*l;for(let r=Math.floor(d*l);r<(d+1)*l;r++){const i=Math.abs(I-(r+.5))/c,o=(n+.5)*a,s=i*i;for(let l=Math.floor(n*a);l<(n+1)*a;l++){let n=Math.abs(o-(l+.5))/u;const i=Math.sqrt(s+n*n);i>=-1&&i<=1&&(h=2*i*i*i-3*i*i+1,h>0&&(n=4*(l+r*t),_+=h*e[n+3],y+=h,e[n+3]<255&&(h=h*e[n+3]/250),m+=h*e[n],g+=h*e[n+1],M+=h*e[n+2],f+=h))}}r[p]=m/f,r[p+1]=g/f,r[p+2]=M/f,r[p+3]=_/y}}function d(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function p(e){return e.data?.symbol??null}function h(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function f(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function y(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type)}function m(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const g=(e,t=0)=>null==e||isNaN(e)?t:e,M=(e,t)=>e??t,_=e=>e.tintColor?d(e.tintColor):[255,255,255,1],I=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function b(){return n.e(2749).then(n.bind(n,42749))}function w(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function T(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function x(e){let t="normal",n="normal";if(e){const r=e.toLowerCase();r.includes("italic")?t="italic":r.includes("oblique")&&(t="oblique"),r.includes("bold")?n="bold":r.includes("light")&&(n="lighter")}return{style:t,weight:n}}function C(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function E(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=E(t);if(null!=e)return e}break;case"CIMTextSymbol":return E(e.symbol);case"CIMSolidFill":return e.color}return null}function v(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=v(e);if(null!=t)return t}break}case"CIMTextSymbol":return v(e.symbol);case"CIMSolidStroke":return e.color}}function S(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=S(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return S(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function A(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function k(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function D(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const N=e=>e.includes("data:image/svg+xml");function L(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function R(e){return e?e.charAt(0).toLowerCase()+e.substring(1):e}function B(e,t,n,r,i,o){const{infos:s}=o;let a=1,l=0,u=0,c=0;for(const{offsetX:h,offsetY:f,rotation:y,size:m,frameHeight:g,rotateClockWise:M}of s)u=Q(h,f,l,a,u),c=Y(h,f,l,a,c),g&&(a*=m/g),l=X(y,M,l);const d=Q(r,i,l,a,u),p=Y(r,i,l,a,c);return{size:e*a,rotation:X(t,n,l),offsetX:d,offsetY:p}}function j(e){if(null==e)return!1;if(Array.isArray(e))return e.every((e=>j(e)));switch(typeof e){case"string":return!!e;case"number":return!isNaN(e)}}function O(e,t){if("color"===t||"outlinecolor"===t||"backgroundcolor"===t||"borderlinecolor"===t||"tintcolor"===t)return[...r.K[t]];const n=r.D[e];if(!n)throw new Error(`InternalError: default value for type ${e}.`);return n[t]}function F(e){return e?.dashTemplate&&"string"==typeof e.dashTemplate&&(e.dashTemplate=e.dashTemplate.split(" ").map(Number)),e}function G(e){if(null==e)return"Normal";switch(e.type){case"CIMTextSymbol":return e.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const e of t)if("CIMVectorMarker"===e.type)return G(e)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const e of t)if(e.symbol)return G(e.symbol)}}return"Normal"}function P(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers)for(const n of e.symbolLayers)if(n)switch(n.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=n.size??r.D.CIMVectorMarker.size;e>t&&(t=e);break}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers)for(const n of e.symbolLayers)if(n)switch(n.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=n.width;null!=e&&e>t&&(t=e);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(n.markerPlacement&&m(n.markerPlacement)){const e=n.size??r.D.CIMVectorMarker.size;e>t&&(t=e)}break;case"CIMPictureFill":{const e=n.height;null!=e&&e>t&&(t=e)}}return t}}}function Z(e,t){if(null!==t){const n=t.get(e);return n?n.name:e}return e}function q(e){return e.map((e=>({...e,propertyName:R(e.propertyName)})))}function $(e){const t={};for(const n in e){const r=e[n];t[R(n)]=r}return t}function Y(e,t,n,r,i){const o=n*Math.PI/180;if(o){const n=Math.cos(o);return(Math.sin(o)*e+n*t)*r+i}return t*r+i}function Q(e,t,n,r,i){const o=n*Math.PI/180;return o?(Math.cos(o)*e-Math.sin(o)*t)*r+i:e*r+i}function X(e,t,n){return t?n-e:n+e}}}]);
//# sourceMappingURL=759.1ba9c8fe.js.map
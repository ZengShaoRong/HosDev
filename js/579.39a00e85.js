"use strict";(self["webpackChunkvue_arcgis_0905"]=self["webpackChunkvue_arcgis_0905"]||[]).push([[579,2153,9888],{71897:function(e,t,r){r.d(t,{q:function(){return i}});var o=r(54401);class i{constructor(e,t){this._storage=new o.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t,r=1){this._storage.put(this,e,t,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},54401:function(e,t,r){r.d(t,{F:function(){return a},Mn:function(){return l}});r(44114);var o=r(73405);const i=-3,n=i-1;var s;!function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"}(s||(s={}));class l{constructor(e,t,r){this.name=e,this._storage=t,this.id=u+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),r&&(this._storage.registerRemoveFunc(this.id,r),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(e){return this._storage.getSize(this,e)}resetHitRate(){this._hit=this._miss=0}put(e,t,r,o=0){this._storage.put(this,e,t,r,o)}pop(e){const t=this._storage.pop(this,e);return void 0===t?++this._miss:++this._hit,t}get(e){const t=this._storage.get(this,e);return void 0===t?++this._miss:++this._hit,t}peek(e){return this._storage.peek(this,e)}updateSize(e,t,r){this._storage.updateSize(this,e,t,r)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class a{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new o.A,this._users=new o.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,t){const r=this._db.get(e.id+t);return r?.size??0}put(e,t,r,o,l){t=e.id+t;const a=this._db.get(t);if(a&&(this._size-=a.size,e.size-=a.size,this._db.delete(t),a.entry!==r&&this._notifyRemove(t,a.entry,a.size,s.ALL)),o>this._maxSize)return void this._notifyRemove(t,r,o,s.ALL);if(void 0===r)return void console.warn("Refusing to cache undefined entry ");if(!o||o<0)return console.warn(`Refusing to cache entry with size ${o} for key ${t}`),void this._notifyRemove(t,r,0,s.ALL);const u=1+Math.max(l,n)-i;this._db.set(t,new c(r,o,u)),this._size+=o,e.size+=o,this._checkSize()}updateSize(e,t,r,o){t=e.id+t;const i=this._db.get(t);if(i&&i.entry===r){for(this._size-=i.size,e.size-=i.size;o>this._maxSize;){const e=this._notifyRemove(t,r,o,s.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);o=e}i.size=o,this._size+=o,e.size+=o,this._checkSize()}}pop(e,t){t=e.id+t;const r=this._db.get(t);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(t),++this._hit,r.entry;++this._miss}get(e,t){t=e.id+t;const r=this._db.get(t);if(void 0!==r)return this._db.delete(t),r.lives=r.lifetime,this._db.set(t,r),++this._hit,r.entry;++this._miss}peek(e,t){const r=this._db.get(e.id+t);return r?++this._hit:++this._miss,r?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach(((e,o)=>{const i=e.lifetime;r[i]=(r[i]||0)+e.size,this._users.forAll((r=>{const{id:i,name:n}=r;if(o.startsWith(i)){const r=t[n]||0;t[n]=r+e.size}}))}));const o={};this._users.forAll((e=>{const r=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const i=t[r]||0;t[r]=i,o[r]=Math.round(100*e.hitRate)+"%"}else o[r]="0%"}));const n=Object.keys(t);n.sort(((e,r)=>t[r]-t[e])),n.forEach((r=>e[r]=Math.round(t[r]/2**20)+"MB / "+o[r]));for(let s=r.length-1;s>=0;--s){const t=r[s];t&&(e["Priority "+(s+i-1)]=Math.round(t/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,r)=>{r.startsWith(t)&&(this._size-=e.size,this._db.delete(r),this._notifyRemove(r,e.entry,e.size,s.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,e.size,s.ALL))),this._users.forAll((e=>e.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,r,o){let i;return this._removeFuncs.some((n=>{if(e.startsWith(n[0])){const e=n[1](t,o,r);return"number"==typeof e&&(i=e),!0}return!1})),i}_checkSize(){this._users.forAll((e=>this._checkSizeLimits(e))),this._checkSizeLimits()}_checkSizeLimits(e){const t=e??this;if(t.maxSize<0||t.size<=t.maxSize)return;const r=e?.id;let o=!0;for(;o;){o=!1;for(const[i,n]of this._db)if(0===n.lifetime&&(!r||i.startsWith(r))){if(this._purgeItem(i,n,e),t.size<=.9*t.maxSize)return;o||=this._db.has(i)}}for(const[i,n]of this._db)if((!r||i.startsWith(r))&&(this._purgeItem(i,n,e),t.size<=.9*t.maxSize))return}_purgeItem(e,t,r=this._users.find((t=>e.startsWith(t.id)))){if(this._db.delete(e),t.lives<=1){this._size-=t.size,r&&(r.size-=t.size);const o=this._notifyRemove(e,t.entry,t.size,s.SOME);null!=o&&o>0&&(this._size+=o,r&&(r.size+=o),t.lives=t.lifetime,t.size=o,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}let u=0;class c{constructor(e,t,r){this.entry=e,this.size=t,this.lifetime=r,this.lives=r}}},4392:function(e,t,r){r.d(t,{v:function(){return i}});var o=r(21003);function i(e){e?.writtenProperties&&e.writtenProperties.forEach((({target:e,propName:t,newOrigin:r})=>{(0,o.H)(e)&&r&&e.originOf(t)!==r&&e.updateOrigin(t,r)}))}},21003:function(e,t,r){function o(e){return e&&"getAtOrigin"in e&&"originOf"in e}r.d(t,{H:function(){return o}})},59888:function(e,t,r){r.d(t,{GB:function(){return i},Qo:function(){return s},Y4:function(){return n}});var o=r(14116);class i{}function n(e){return e instanceof o.bo?e===i.instance:"unknown"===e?.toString().toLowerCase()}function s(e){return n(e)?i.instance:e}i.instance=new o.oh("Etc/UTC")},21839:function(e,t,r){r.d(t,{$X:function(){return b},Gy:function(){return _},P5:function(){return A},SW:function(){return M},Tr:function(){return S},VV:function(){return o}});r(44114),r(55910);function o(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]:[0,0,0,0]}:null}function i(e){return"lowerLeft"===e.originPosition&&4===e.scale.length&&4===e.translate.length}function n(e){if(i(e))return e;const{originPosition:t,scale:r,translate:o}=e,n=r[0]??1,s=r[1]??1;return{originPosition:"lowerLeft",scale:[n,"lowerLeft"===t?s:-s,r[2]??1,r[3]??1],translate:[o[0]??0,o[1]??0,o[2]??0,o[3]??0]}}function s({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function l({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}function a({scale:e,translate:t},r){return Math.round(((r??0)-t[2])/e[2])}function u({scale:e,translate:t},r){return r?Math.round((r-t[3])/e[3]):0}function c({scale:e,translate:t},r){return r*e[0]+t[0]}function p({scale:e,translate:t},r){return r*e[1]+t[1]}function d({scale:e,translate:t},r){return(r??0)*e[2]+t[2]}function f({scale:e,translate:t},r){return r?r*e[3]+t[3]:0}function y(e,t){return e&&t?v:e&&!t?m:!e&&t?g:h}const h=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const o=t[0];let i=c(e,o[0]),n=p(e,o[1]);r[0]=[i,n];const{scale:s,originPosition:l}=e,a=s[0],u="lowerLeft"===l?s[1]:-s[1];for(let c=1;c<t.length;c++){const[e,o]=t[c];i+=a*e,n+=u*o,r[c]=[i,n]}return r},m=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const o=t[0];let i=c(e,o[0]),n=p(e,o[1]);r[0]=[i,n,d(e,o[2])];const{scale:s,originPosition:l}=e,a=s[0],u="lowerLeft"===l?s[1]:-s[1];for(let c=1;c<t.length;c++){const[o,s,l]=t[c];i+=a*o,n+=u*s,r[c]=[i,n,d(e,l)]}return r},g=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const o=t[0];let i=c(e,o[0]),n=p(e,o[1]);r[0]=[i,n,f(e,o[2])];const{scale:s,originPosition:l}=e,a=s[0],u="lowerLeft"===l?s[1]:-s[1];for(let c=1;c<t.length;c++){const[o,s,l]=t[c];i+=a*o,n+=u*s,r[c]=[i,n,f(e,l)]}return r},v=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const o=t[0];let i=c(e,o[0]),n=p(e,o[1]);r[0]=[i,n,d(e,o[2]),f(e,o[3])];const{scale:s,originPosition:l}=e,a=s[0],u="lowerLeft"===l?s[1]:-s[1];for(let c=1;c<t.length;c++){const[o,s,l,p]=t[c];i+=a*o,n+=u*s,r[c]=[i,n,d(e,l),f(e,p)]}return r};function w(e,t,r){const o=new Array(r.length);for(let i=0;i<r.length;i++)o[i]=t(e,r[i]);return o}function _(e,t,r){const o=n(e);return t.x=s(o,r.x),t.y=l(o,r.y),null!=r.z&&(t.z=a(o,r.z)),null!=r.m&&(t.m=u(o,r.m)),t}function M(e,t,r,o=r?.hasZ??!1,i=r?.hasM??!1){if(null!=r){const s=n(e);t.points=y(o,i)(s,r.points),t.hasZ=o,t.hasM=i}return t}function S(e,t,r,o=null!=r?.z,i=null!=r?.m){if(null==r)return t;const s=n(e);return t.x=c(s,r.x),t.y=p(s,r.y),o&&(t.z=d(s,r.z)),i&&(t.m=f(s,r.m)),t}function b(e,t,r,o=r?.hasZ??!1,i=r?.hasM??!1){if(null!=r){const s=n(e);t.rings=w(s,y(o,i),r.rings),t.hasZ=o,t.hasM=i}return t}function A(e,t,r,o=r?.hasZ??!1,i=r?.hasM??!1){if(null!=r){const s=n(e);t.paths=w(s,y(o,i),r.paths),t.hasZ=o,t.hasM=i}return t}},31537:function(e,t,r){r.r(t),r.d(t,{default:function(){return Rt}});r(44114),r(17642),r(58004),r(33853),r(45876),r(32475),r(15024),r(31698);var o=r(40399),i=r(61768),n=r(32334),s=r(26052),l=r(83209),a=(r(93276),r(25634),r(95901),r(23581),r(91458),r(97120),r(61470),r(70379),r(16048)),u=r(8660),c=r(81677),p=r(18244),d=r(91354),f=r(3243),y=r(13570),h=r(78574),m=r(98569),g=r(94),v=r(36861),w=(r(9302),r(95753),r(29811)),_=r(39834),M=r(63955),S=r(4392),b=r(79429),A=r(40162),I=r(84427),P=r(81182),C=r(22528),T=r(61831),B=r(85633),N=r(60522),Z=r(94880),L=r(86978),R=r(17010),k=r(86820);let F=class extends R.oY{constructor(e){super(e),this.break=new k.A({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}}),this.first=new k.A({color:[0,255,0],size:20,outline:{color:[255,255,255],width:4}}),this.unlocated=new k.A({color:[255,0,0],size:12,outline:{color:[255,255,255],width:3}}),this.last=new k.A({color:[255,0,0],size:20,outline:{color:[255,255,255],width:4}}),this.middle=new k.A({color:[51,51,51],size:12,outline:{color:[0,122,194],width:3}}),this.waypoint=new k.A({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}})}};(0,o._)([(0,v.MZ)({types:L.wC})],F.prototype,"break",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],F.prototype,"first",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],F.prototype,"unlocated",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],F.prototype,"last",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],F.prototype,"middle",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],F.prototype,"waypoint",void 0),F=(0,o._)([(0,_.$)("esri.layers.support.RouteStopSymbols")],F);const O=F;var z=r(21778),x=r(44451);let E=class extends R.oY{constructor(e){super(e),this.directionLines=new z.A({color:[0,122,194],width:6}),this.directionPoints=new k.A({color:[255,255,255],size:6,outline:{color:[0,122,194],width:2}}),this.pointBarriers=new k.A({style:"x",size:10,outline:{color:[255,0,0],width:3}}),this.polygonBarriers=new x.A({color:[255,170,0,.6],outline:{width:7.5,color:[255,0,0,.6]}}),this.polylineBarriers=new z.A({width:7.5,color:[255,85,0,.7]}),this.routeInfo=new z.A({width:8,color:[20,89,127]}),this.stops=new O}};(0,o._)([(0,v.MZ)({types:L.Y7})],E.prototype,"directionLines",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],E.prototype,"directionPoints",void 0),(0,o._)([(0,v.MZ)({types:L.wC})],E.prototype,"pointBarriers",void 0),(0,o._)([(0,v.MZ)({types:L.Ac})],E.prototype,"polygonBarriers",void 0),(0,o._)([(0,v.MZ)({types:L.Y7})],E.prototype,"polylineBarriers",void 0),(0,o._)([(0,v.MZ)({types:L.Y7})],E.prototype,"routeInfo",void 0),(0,o._)([(0,v.MZ)({type:O})],E.prototype,"stops",void 0),E=(0,o._)([(0,_.$)("esri.layers.support.RouteSymbols")],E);const D=E;var j=r(45959),G=r(15350),U=r(92153),J=r(5049),$=r(86970),V=r(65409),W=r(7351);let q=class extends R.oY{constructor(e){super(e),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};(0,o._)([(0,v.MZ)({type:String})],q.prototype,"dataType",void 0),(0,o._)([(0,V.e)(W.et,{ignoreUnknown:!1})],q.prototype,"name",void 0),(0,o._)([(0,v.MZ)({type:[String]})],q.prototype,"parameterNames",void 0),(0,o._)([(0,v.MZ)({type:String})],q.prototype,"restrictionUsageParameterName",void 0),(0,o._)([(0,V.e)(W.Mm,{ignoreUnknown:!1})],q.prototype,"timeNeutralAttributeName",void 0),(0,o._)([(0,v.MZ)({type:String})],q.prototype,"trafficSupport",void 0),(0,o._)([(0,V.e)(W.dn)],q.prototype,"units",void 0),(0,o._)([(0,V.e)(W.WU)],q.prototype,"usageType",void 0),q=(0,o._)([(0,_.$)("esri.rest.support.NetworkAttribute")],q);const H=q;let K=class extends R.oY{constructor(e){super(e),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};(0,o._)([(0,v.MZ)({type:Number})],K.prototype,"buildTime",void 0),(0,o._)([(0,v.MZ)({type:String})],K.prototype,"name",void 0),(0,o._)([(0,v.MZ)({type:[H]})],K.prototype,"networkAttributes",void 0),(0,o._)([(0,v.MZ)()],K.prototype,"networkSources",void 0),(0,o._)([(0,v.MZ)({type:String})],K.prototype,"state",void 0),K=(0,o._)([(0,_.$)("esri.rest.support.NetworkDataset")],K);const Y=K;var Q=r(67240);let X=class extends R.oY{constructor(e){super(e),this.accumulateAttributeNames=null,this.attributeParameterValues=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(e){return null==e?null:e.map((e=>W.et.fromJSON(e)))}writeAccumulateAttributes(e,t,r){e?.length&&(t[r]=e.map((e=>W.et.toJSON(e))))}get capabilities(){return{supportsNow:(this.currentVersion??10)>=10.81}}readDefaultTravelMode(e,t){const r=t.supportedTravelModes?.find((({id:e})=>e===t.defaultTravelMode))??t.supportedTravelModes?.find((({itemId:e})=>e===t.defaultTravelMode));return r?Q.A.fromJSON(r):null}};(0,o._)([(0,v.MZ)()],X.prototype,"accumulateAttributeNames",void 0),(0,o._)([(0,w.w)("accumulateAttributeNames")],X.prototype,"readAccumulateAttributes",null),(0,o._)([(0,M.K)("accumulateAttributeNames")],X.prototype,"writeAccumulateAttributes",null),(0,o._)([(0,v.MZ)()],X.prototype,"attributeParameterValues",void 0),(0,o._)([(0,v.MZ)()],X.prototype,"capabilities",null),(0,o._)([(0,v.MZ)()],X.prototype,"currentVersion",void 0),(0,o._)([(0,v.MZ)()],X.prototype,"defaultTravelMode",void 0),(0,o._)([(0,w.w)("defaultTravelMode",["defaultTravelMode","supportedTravelModes"])],X.prototype,"readDefaultTravelMode",null),(0,o._)([(0,v.MZ)()],X.prototype,"directionsLanguage",void 0),(0,o._)([(0,V.e)(W.Z7)],X.prototype,"directionsLengthUnits",void 0),(0,o._)([(0,v.MZ)()],X.prototype,"directionsSupportedLanguages",void 0),(0,o._)([(0,V.e)(W.Mm,{ignoreUnknown:!1})],X.prototype,"directionsTimeAttribute",void 0),(0,o._)([(0,v.MZ)()],X.prototype,"hasZ",void 0),(0,o._)([(0,V.e)(W.et,{ignoreUnknown:!1})],X.prototype,"impedance",void 0),(0,o._)([(0,v.MZ)({type:Y})],X.prototype,"networkDataset",void 0),(0,o._)([(0,v.MZ)({type:[Q.A]})],X.prototype,"supportedTravelModes",void 0),X=(0,o._)([(0,_.$)("esri.rest.support.NetworkServiceDescription")],X);const ee=X,te=()=>u.A.getLogger("esri.rest.networkService");function re(e,t,r,o){o[r]=[t.length,t.length+e.length],e.forEach((e=>{t.push(e.geometry)}))}function oe(e,t){for(let r=0;r<t.length;r++){const o=e[t[r]];if(o&&o.length)for(const e of o)e.z=void 0}te().warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}function ie(e,t){for(let r=0;r<t.length;r++){const o=e[t[r]];if(o&&o.length)for(const e of o)if(null!=e&&e.hasZ)return!0}return!1}async function ne(e,t,r){if(!e)throw new p.A("network-service:missing-url","Url to Network service is missing");const o=(0,$.jV)({f:"json",token:t},r),{data:i}=await(0,J.A)(e,o),n=i.currentVersion>=10.4?le(e,t,r):se(e,r),{defaultTravelMode:s,supportedTravelModes:l}=await n;return i.defaultTravelMode=s,i.supportedTravelModes=l,ee.fromJSON(i)}async function se(e,t){const r=(0,$.jV)({f:"json"},t),{data:o}=await(0,J.A)(e.replace(/\/rest\/.*$/i,"/info"),r);if(!o?.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:i}=o,n=(0,g.UC)(i)+"/sharing/rest/portals/self",{data:s}=await(0,J.A)(n,r),l=(0,f.wc)("helperServices.routingUtilities.url",s);if(!l)return{supportedTravelModes:[],defaultTravelMode:null};const a=(0,$.Dl)(i),u=/\/solve$/i.test(a.path)?"Route":/\/solveclosestfacility$/i.test(a.path)?"ClosestFacility":"ServiceAreas",c=(0,$.jV)({f:"json",serviceName:u},t),p=(0,g.UC)(l)+"/GetTravelModes/execute",d=await(0,J.A)(p,c),y=[];let h=null;if(d?.data?.results?.length){const e=d.data.results;for(const t of e)if("supportedTravelModes"===t.paramName){if(t.value?.features)for(const{attributes:e}of t.value.features)if(e){const t=JSON.parse(e.TravelMode);y.push(t)}}else"defaultTravelMode"===t.paramName&&(h=t.value)}return{supportedTravelModes:y,defaultTravelMode:h}}async function le(e,t,r){try{const o=(0,$.jV)({f:"json",token:t},r),i=(0,g.UC)(e)+"/retrieveTravelModes",{data:{supportedTravelModes:n,defaultTravelMode:s}}=await(0,J.A)(i,o);return{supportedTravelModes:n,defaultTravelMode:s}}catch(Y){throw new p.A("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:Y})}}var ae=r(2335),ue=r(55555),ce=r(69508),pe=r(8917),de=r(39930),fe=r(2914),ye=r(30637);const he=new fe.J({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let me=class extends ye.A{constructor(e){super(e),this.type=null}};(0,o._)([(0,v.MZ)({type:String,json:{read:he.read,write:he.write}})],me.prototype,"type",void 0),me=(0,o._)([(0,_.$)("esri.rest.support.NAMessage")],me);const ge=me;let ve=class extends R.oY{constructor(e){super(e)}};(0,o._)([(0,v.MZ)({json:{read:{source:"string"}}})],ve.prototype,"text",void 0),(0,o._)([(0,V.e)(W.Ec,{name:"stringType"})],ve.prototype,"type",void 0),ve=(0,o._)([(0,_.$)("esri.rest.support.DirectionsString")],ve);const we=ve;var _e=r(86743);let Me=class extends R.oY{constructor(e){super(e),this.arriveTime=null,this.arriveTimeOffset=null,this.geometry=null,this.strings=null}readArriveTimeOffset(e,t){return(0,ce.Zn)(t.ETA,t.arriveTimeUTC)}readGeometry(e,t){return _e.A.fromJSON(t.point)}};(0,o._)([(0,v.MZ)({type:Date,json:{read:{source:"arriveTimeUTC"}}})],Me.prototype,"arriveTime",void 0),(0,o._)([(0,v.MZ)()],Me.prototype,"arriveTimeOffset",void 0),(0,o._)([(0,w.w)("arriveTimeOffset",["arriveTimeUTC","ETA"])],Me.prototype,"readArriveTimeOffset",null),(0,o._)([(0,v.MZ)({type:_e.A})],Me.prototype,"geometry",void 0),(0,o._)([(0,w.w)("geometry",["point"])],Me.prototype,"readGeometry",null),(0,o._)([(0,v.MZ)({type:[we]})],Me.prototype,"strings",void 0),Me=(0,o._)([(0,_.$)("esri.rest.support.DirectionsEvent")],Me);const Se=Me;var be=r(93277);function Ae(e){if(null==e||""===e)return null;let t=0,r=0,o=0,i=0;const n=[];let s,l,a,u,c,p,d,f,y=0,h=0,m=0;if(c=e.match(/((\+|-)[^+\-|]+|\|)/g),c||(c=[]),0===parseInt(c[y],32)){y=2;const e=parseInt(c[y],32);y++,p=parseInt(c[y],32),y++,1&e&&(h=c.indexOf("|")+1,d=parseInt(c[h],32),h++),2&e&&(m=c.indexOf("|",h)+1,f=parseInt(c[m],32),m++)}else p=parseInt(c[y],32),y++;for(;y<c.length&&"|"!==c[y];){s=parseInt(c[y],32)+t,y++,t=s,l=parseInt(c[y],32)+r,y++,r=l;const e=[s/p,l/p];h&&(u=parseInt(c[h],32)+o,h++,o=u,e.push(u/d)),m&&(a=parseInt(c[m],32)+i,m++,i=a,e.push(a/f)),n.push(e)}return{paths:[n],hasZ:h>0,hasM:m>0}}let Ie=class extends s.A{constructor(e){super(e),this.events=null,this.strings=null}readGeometry(e,t){const r=Ae(t.compressedGeometry);return null!=r?be.A.fromJSON(r):null}};(0,o._)([(0,v.MZ)({type:[Se]})],Ie.prototype,"events",void 0),(0,o._)([(0,w.w)("geometry",["compressedGeometry"])],Ie.prototype,"readGeometry",null),(0,o._)([(0,v.MZ)({type:[we]})],Ie.prototype,"strings",void 0),Ie=(0,o._)([(0,_.$)("esri.rest.support.DirectionsFeature")],Ie);const Pe=Ie;var Ce=r(70616);function Te(e,t){if(0===e.length)return new be.A({spatialReference:t});const r=[];for(const s of e)for(const e of s.paths)r.push(...e);const o=[];r.forEach(((e,t)=>{0!==t&&e[0]===r[t-1][0]&&e[1]===r[t-1][1]||o.push(e)}));const{hasM:i,hasZ:n}=e[0];return new be.A({hasM:i,hasZ:n,paths:[o],spatialReference:t})}let Be=class extends pe.A{constructor(e){super(e),this.extent=null,this.features=[],this.geometryType="polyline",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}readFeatures(e,t){if(!e)return[];const r=t.summary.envelope.spatialReference??t.spatialReference,o=r&&Ce.A.fromJSON(r);return e.map((e=>{const t=Pe.fromJSON(e);if(null!=t.geometry&&(t.geometry.spatialReference=o),null!=t.events)for(const r of t.events)null!=r.geometry&&(r.geometry.spatialReference=o);return t}))}get mergedGeometry(){return this.features?Te(this.features.map((({geometry:e})=>e)),this.extent.spatialReference):null}get strings(){return this.features.flatMap((({strings:e})=>e)).filter(de.Ru)}};(0,o._)([(0,v.MZ)({type:b.A,json:{read:{source:"summary.envelope"}}})],Be.prototype,"extent",void 0),(0,o._)([(0,v.MZ)({nonNullable:!0})],Be.prototype,"features",void 0),(0,o._)([(0,w.w)("features")],Be.prototype,"readFeatures",null),(0,o._)([(0,v.MZ)()],Be.prototype,"geometryType",void 0),(0,o._)([(0,v.MZ)({readOnly:!0})],Be.prototype,"mergedGeometry",null),(0,o._)([(0,v.MZ)()],Be.prototype,"routeId",void 0),(0,o._)([(0,v.MZ)()],Be.prototype,"routeName",void 0),(0,o._)([(0,v.MZ)({value:null,readOnly:!0})],Be.prototype,"strings",null),(0,o._)([(0,v.MZ)({json:{read:{source:"summary.totalDriveTime"}}})],Be.prototype,"totalDriveTime",void 0),(0,o._)([(0,v.MZ)({json:{read:{source:"summary.totalLength"}}})],Be.prototype,"totalLength",void 0),(0,o._)([(0,v.MZ)({json:{read:{source:"summary.totalTime"}}})],Be.prototype,"totalTime",void 0),Be=(0,o._)([(0,_.$)("esri.rest.support.DirectionsFeatureSet")],Be);const Ne=Be;let Ze=class extends R.oY{constructor(e){super(e),this.directionLines=null,this.directionPoints=null,this.directions=null,this.route=null,this.routeName=null,this.stops=null,this.traversedEdges=null,this.traversedJunctions=null,this.traversedTurns=null}};(0,o._)([(0,v.MZ)({type:pe.A,json:{write:!0}})],Ze.prototype,"directionLines",void 0),(0,o._)([(0,v.MZ)({type:pe.A,json:{write:!0}})],Ze.prototype,"directionPoints",void 0),(0,o._)([(0,v.MZ)({type:Ne,json:{write:!0}})],Ze.prototype,"directions",void 0),(0,o._)([(0,v.MZ)({type:s.A,json:{write:!0}})],Ze.prototype,"route",void 0),(0,o._)([(0,v.MZ)({type:String,json:{write:!0}})],Ze.prototype,"routeName",void 0),(0,o._)([(0,v.MZ)({type:[s.A],json:{write:!0}})],Ze.prototype,"stops",void 0),(0,o._)([(0,v.MZ)({type:pe.A,json:{write:!0}})],Ze.prototype,"traversedEdges",void 0),(0,o._)([(0,v.MZ)({type:pe.A,json:{write:!0}})],Ze.prototype,"traversedJunctions",void 0),(0,o._)([(0,v.MZ)({type:pe.A,json:{write:!0}})],Ze.prototype,"traversedTurns",void 0),Ze=(0,o._)([(0,_.$)("esri.rest.support.RouteResult")],Ze);const Le=Ze;function Re(e){return e?pe.A.fromJSON(e).features.filter(de.Ru):[]}let ke=class extends R.oY{constructor(e){super(e),this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}readPointBarriers(e,t){return Re(t.barriers)}readPolylineBarriers(e){return Re(e)}readPolygonBarriers(e){return Re(e)}};(0,o._)([(0,v.MZ)({type:[ge]})],ke.prototype,"messages",void 0),(0,o._)([(0,v.MZ)({type:[s.A]})],ke.prototype,"pointBarriers",void 0),(0,o._)([(0,w.w)("pointBarriers",["barriers"])],ke.prototype,"readPointBarriers",null),(0,o._)([(0,v.MZ)({type:[s.A]})],ke.prototype,"polylineBarriers",void 0),(0,o._)([(0,w.w)("polylineBarriers")],ke.prototype,"readPolylineBarriers",null),(0,o._)([(0,v.MZ)({type:[s.A]})],ke.prototype,"polygonBarriers",void 0),(0,o._)([(0,w.w)("polygonBarriers")],ke.prototype,"readPolygonBarriers",null),(0,o._)([(0,v.MZ)({type:[Le]})],ke.prototype,"routeResults",void 0),ke=(0,o._)([(0,_.$)("esri.rest.support.RouteSolveResult")],ke);const Fe=ke;function Oe(e){return e instanceof pe.A}async function ze(e,t,r){const o=[],i=[],n={},s={},l=(0,$.Dl)(e),{path:a}=l;Oe(t.stops)&&re(t.stops.features,i,"stops.features",n),Oe(t.pointBarriers)&&re(t.pointBarriers.features,i,"pointBarriers.features",n),Oe(t.polylineBarriers)&&re(t.polylineBarriers.features,i,"polylineBarriers.features",n),Oe(t.polygonBarriers)&&re(t.polygonBarriers.features,i,"polygonBarriers.features",n);const u=await(0,ue.el)(i);for(const f in n){const e=n[f];o.push(f),s[f]=u.slice(e[0],e[1])}if(ie(s,o)){let e=null;try{e=await ne(a,t.apiKey,r)}catch{}e&&!e.hasZ&&oe(s,o)}for(const f in s)s[f].forEach(((e,r)=>{(0,ae.Jt)(t,f)[r].geometry=e}));const c={...r,query:{...l.query,...(0,ce.r9)(t),f:"json"}},p=a.endsWith("/solve")?a:`${a}/solve`,{data:d}=await(0,J.A)(p,c);return xe(d)}function xe(e){const{barriers:t,directionLines:r,directionPoints:o,directions:i,messages:n,polygonBarriers:s,polylineBarriers:l,routes:a,stops:u,traversedEdges:c,traversedJunctions:p,traversedTurns:d}=e,f=e=>{const t=h.find((t=>t.routeName===e));if(null!=t)return t;const r={routeId:h.length+1,routeName:e};return h.push(r),r},y=e=>{const t=h.find((t=>t.routeId===e));if(null!=t)return t;const r={routeId:e,routeName:null};return h.push(r),r},h=[];a?.features.forEach(((e,t)=>{e.geometry.spatialReference=a.spatialReference??void 0;const r=e.attributes.Name,o=t+1;h.push({routeId:o,routeName:r,route:e})})),i?.forEach((e=>{const{routeName:t}=e;f(t).directions=e}));const m=u?.features.every((e=>null==e.attributes.RouteName))&&h.length>0?h[0].routeName:null;return u?.features.forEach((e=>{e.geometry&&(e.geometry.spatialReference??=u.spatialReference??void 0);const t=m??e.attributes.RouteName,r=f(t);r.stops??=[],r.stops.push(e)})),r?.features.forEach((e=>{const t=e.attributes.RouteID,o=y(t),{geometryType:i,spatialReference:n}=r;o.directionLines??={features:[],geometryType:i,spatialReference:n},o.directionLines.features.push(e)})),o?.features.forEach((e=>{const t=e.attributes.RouteID,r=y(t),{geometryType:i,spatialReference:n}=o;r.directionPoints??={features:[],geometryType:i,spatialReference:n},r.directionPoints.features.push(e)})),c?.features.forEach((e=>{const t=e.attributes.RouteID,r=y(t),{geometryType:o,spatialReference:i}=c;r.traversedEdges??={features:[],geometryType:o,spatialReference:i},r.traversedEdges.features.push(e)})),p?.features.forEach((e=>{const t=e.attributes.RouteID,r=y(t),{geometryType:o,spatialReference:i}=p;r.traversedJunctions??={features:[],geometryType:o,spatialReference:i},r.traversedJunctions.features.push(e)})),d?.features.forEach((e=>{const t=e.attributes.RouteID,r=y(t);r.traversedTurns??={features:[]},r.traversedTurns.features.push(e)})),Fe.fromJSON({routeResults:h,barriers:t,polygonBarriers:s,polylineBarriers:l,messages:n})}var Ee=r(44548),De=r(56258),je=r(74898),Ge=r(8914),Ue=r(16824),Je=r(40546),$e=r(35090),Ve=r(1453),We=r(1875),qe=r(55910);let He=class extends((0,$e.O)(R.oY)){constructor(e){super(e),this.doNotLocateOnRestrictedElements=null,this.geometry=null,this.geometryType=null,this.name=null,this.spatialRelationship=null,this.type="layer",this.where=null}};(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],He.prototype,"doNotLocateOnRestrictedElements",void 0),(0,o._)([(0,v.MZ)({types:n.yR,json:{read:qe.rS,write:!0}})],He.prototype,"geometry",void 0),(0,o._)([(0,V.e)(W.Vj)],He.prototype,"geometryType",void 0),(0,o._)([(0,v.MZ)({type:String,json:{name:"layerName",write:!0}})],He.prototype,"name",void 0),(0,o._)([(0,V.e)(W.vS,{name:"spatialRel"})],He.prototype,"spatialRelationship",void 0),(0,o._)([(0,v.MZ)({type:String,json:{write:!0}})],He.prototype,"type",void 0),(0,o._)([(0,v.MZ)({type:String,json:{write:!0}})],He.prototype,"where",void 0),He=(0,o._)([(0,_.$)("esri.rest.support.DataLayer")],He);const Ke=He;var Ye;let Qe=Ye=class extends pe.A{constructor(e){super(e),this.doNotLocateOnRestrictedElements=null}clone(){return new Ye({doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements,...this.cloneProperties()})}};(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],Qe.prototype,"doNotLocateOnRestrictedElements",void 0),Qe=Ye=(0,o._)([(0,_.$)("esri.rest.support.NetworkFeatureSet")],Qe);const Xe=Qe;let et=class extends((0,$e.O)(R.oY)){constructor(e){super(e),this.doNotLocateOnRestrictedElements=null,this.url=null}};(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],et.prototype,"doNotLocateOnRestrictedElements",void 0),(0,o._)([(0,v.MZ)({type:String,json:{write:!0}})],et.prototype,"url",void 0),et=(0,o._)([(0,_.$)("esri.rest.support.NetworkUrl")],et);const tt=et;var rt;let ot=rt=class extends((0,$e.O)(R.oY)){constructor(e){super(e),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsOutputType=null,this.directionsStyleName=null,this.directionsTimeAttribute=null,this.findBestSequence=null,this.geometryPrecision=null,this.geometryPrecisionM=null,this.geometryPrecisionZ=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines="true-shape",this.outSpatialReference=null,this.overrides=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveFirstStop=null,this.preserveLastStop=null,this.preserveObjectID=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnBarriers=!1,this.returnDirections=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.returnRoutes=!0,this.returnStops=!1,this.returnTraversedEdges=null,this.returnTraversedJunctions=null,this.returnTraversedTurns=null,this.returnZ=!0,this.startTime=null,this.startTimeIsUTC=!0,this.stops=null,this.timeWindowsAreUTC=null,this.travelMode=null,this.useHierarchy=null,this.useTimeWindows=null}static from(e){return(0,Ve.PZ)(rt,e)}readAccumulateAttributes(e){return null==e?null:e.map((e=>W.et.fromJSON(e)))}writeAccumulateAttributes(e,t,r){e?.length&&(t[r]=e.map((e=>W.et.toJSON(e))))}writePointBarriers(e,t,r){ct(e,t,r)}writePolygonBarrier(e,t,r){ct(e,t,r)}writePolylineBarrier(e,t,r){ct(e,t,r)}readRestrictionAttributes(e){return null==e?null:e.map((e=>W.OC.fromJSON(e)))}writeRestrictionAttributes(e,t,r){e?.length&&(t[r]=e.map((e=>W.OC.toJSON(e))))}readStartTime(e,t){const{startTime:r}=t;return null==r?null:"now"===r?"now":new Date(r)}writeStartTime(e,t){null!=e&&(t.startTime="now"===e?"now":e.getTime())}readStops(e,t){return ut(t.stops)}writeStops(e,t,r){ct(e,t,r)}};(0,o._)([(0,v.MZ)({type:[String],json:{name:"accumulateAttributeNames",write:!0}})],ot.prototype,"accumulateAttributes",void 0),(0,o._)([(0,w.w)("accumulateAttributes")],ot.prototype,"readAccumulateAttributes",null),(0,o._)([(0,M.K)("accumulateAttributes")],ot.prototype,"writeAccumulateAttributes",null),(0,o._)([(0,v.MZ)(We.K)],ot.prototype,"apiKey",void 0),(0,o._)([(0,v.MZ)({json:{write:!0}})],ot.prototype,"attributeParameterValues",void 0),(0,o._)([(0,v.MZ)({type:String,json:{write:!0}})],ot.prototype,"directionsLanguage",void 0),(0,o._)([(0,V.e)(W.Z7)],ot.prototype,"directionsLengthUnits",void 0),(0,o._)([(0,V.e)(W.aJ)],ot.prototype,"directionsOutputType",void 0),(0,o._)([(0,V.e)(W.$n)],ot.prototype,"directionsStyleName",void 0),(0,o._)([(0,V.e)(W.Mm,{name:"directionsTimeAttributeName",ignoreUnknown:!1})],ot.prototype,"directionsTimeAttribute",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"findBestSequence",void 0),(0,o._)([(0,v.MZ)({type:Number,json:{write:!0}})],ot.prototype,"geometryPrecision",void 0),(0,o._)([(0,v.MZ)({type:Number,json:{write:!0}})],ot.prototype,"geometryPrecisionM",void 0),(0,o._)([(0,v.MZ)({type:Number,json:{write:!0}})],ot.prototype,"geometryPrecisionZ",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"ignoreInvalidLocations",void 0),(0,o._)([(0,V.e)(W.et,{name:"impedanceAttributeName",ignoreUnknown:!1})],ot.prototype,"impedanceAttribute",void 0),(0,o._)([(0,v.MZ)({type:Number,json:{write:!0}})],ot.prototype,"outputGeometryPrecision",void 0),(0,o._)([(0,V.e)(W.hY)],ot.prototype,"outputGeometryPrecisionUnits",void 0),(0,o._)([(0,V.e)(W.Sr)],ot.prototype,"outputLines",void 0),(0,o._)([(0,v.MZ)({type:Ce.A,json:{name:"outSR",write:!0}})],ot.prototype,"outSpatialReference",void 0),(0,o._)([(0,v.MZ)({json:{write:!0}})],ot.prototype,"overrides",void 0),(0,o._)([(0,v.MZ)({json:{name:"barriers",write:!0}})],ot.prototype,"pointBarriers",void 0),(0,o._)([(0,M.K)("pointBarriers")],ot.prototype,"writePointBarriers",null),(0,o._)([(0,v.MZ)({json:{write:!0}})],ot.prototype,"polygonBarriers",void 0),(0,o._)([(0,M.K)("polygonBarriers")],ot.prototype,"writePolygonBarrier",null),(0,o._)([(0,v.MZ)({json:{write:!0}})],ot.prototype,"polylineBarriers",void 0),(0,o._)([(0,M.K)("polylineBarriers")],ot.prototype,"writePolylineBarrier",null),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"preserveFirstStop",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"preserveLastStop",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"preserveObjectID",void 0),(0,o._)([(0,v.MZ)({type:[String],json:{name:"restrictionAttributeNames",write:!0}})],ot.prototype,"restrictionAttributes",void 0),(0,o._)([(0,w.w)("restrictionAttributes")],ot.prototype,"readRestrictionAttributes",null),(0,o._)([(0,M.K)("restrictionAttributes")],ot.prototype,"writeRestrictionAttributes",null),(0,o._)([(0,V.e)(W.hE)],ot.prototype,"restrictUTurns",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnBarriers",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnDirections",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnPolygonBarriers",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnPolylineBarriers",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnRoutes",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnStops",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnTraversedEdges",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnTraversedJunctions",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnTraversedTurns",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"returnZ",void 0),(0,o._)([(0,v.MZ)({json:{write:!0}})],ot.prototype,"startTime",void 0),(0,o._)([(0,w.w)("startTime")],ot.prototype,"readStartTime",null),(0,o._)([(0,M.K)("startTime")],ot.prototype,"writeStartTime",null),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"startTimeIsUTC",void 0),(0,o._)([(0,v.MZ)({json:{write:!0}})],ot.prototype,"stops",void 0),(0,o._)([(0,w.w)("stops")],ot.prototype,"readStops",null),(0,o._)([(0,M.K)("stops")],ot.prototype,"writeStops",null),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"timeWindowsAreUTC",void 0),(0,o._)([(0,v.MZ)({type:Q.A,json:{write:!0}})],ot.prototype,"travelMode",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"useHierarchy",void 0),(0,o._)([(0,v.MZ)({type:Boolean,json:{write:!0}})],ot.prototype,"useTimeWindows",void 0),ot=rt=(0,o._)([(0,_.$)("esri.rest.support.RouteParameters")],ot);const it=ot;function nt(e){return e&&"type"in e}function st(e){return e&&"features"in e&&"doNotLocateOnRestrictedElements"in e}function lt(e){return e&&"url"in e}function at(e){return e&&"features"in e}function ut(e){return nt(e)?Ke.fromJSON(e):lt(e)?tt.fromJSON(e):st(e)?Xe.fromJSON(e):at(e)?pe.A.fromJSON(e):null}function ct(e,t,r){null!=e&&(t[r]=c.A.isCollection(e)?{features:e.toArray().map((e=>e.toJSON()))}:e.toJSON())}var pt=r(85779),dt=r(83051),ft=r(49884);function yt(e){return e.length?e:null}function ht(e){switch(e){case"esriGeometryPoint":return{type:"esriSMS",style:"esriSMSCircle",size:12,color:[0,0,0,0],outline:ht("esriGeometryPolyline")};case"esriGeometryPolyline":return{type:"esriSLS",style:"esriSLSSolid",width:1,color:[0,0,0,0]};case"esriGeometryPolygon":return{type:"esriSFS",style:"esriSFSNull",outline:ht("esriGeometryPolyline")}}}function mt(e){return"layers"in e}function gt(e){return"esri.rest.support.FeatureSet"===e.declaredClass}function vt(e){return"esri.rest.support.NetworkFeatureSet"===e.declaredClass}function wt(e,t,r){const o=t.networkDataset?.networkAttributes,i=o?.filter((({usageType:e})=>"cost"===e))??[],n=r.travelMode??t.defaultTravelMode;if(null==n)return void Zt().warn("route-layer:missing-travel-mode","The routing service must have a default travel mode or one must be specified in the route parameter.");const{timeAttributeName:s,distanceAttributeName:l}=n,a=i.find((({name:e})=>e===s)),u=i.find((({name:e})=>e===l)),c=r.travelMode?.impedanceAttributeName??r.impedanceAttribute??t.impedance,d=a?.units,f=u?.units;if(!d||!f)throw new p.A("routelayer:unknown-impedance-units","the units of either the distance or time impedance are unknown");const y=r.directionsLanguage??t.directionsLanguage,h=r.accumulateAttributes??t.accumulateAttributeNames??[],m=new Set(i.filter((({name:e})=>e===s||e===l||e===c||null!=e&&h.includes(e))).map((({name:e})=>e))),g=e=>{for(const t in e)m.has(t)||delete e[t]};for(const p of e.pointBarriers)null!=p.costs&&(p.addedCost=p.costs[c]??0,g(p.costs));for(const p of e.polygonBarriers)null!=p.costs&&(p.scaleFactor=p.costs[c]??1,g(p.costs));for(const p of e.polylineBarriers)null!=p.costs&&(p.scaleFactor=p.costs[c]??1,g(p.costs));const{routeInfo:v}=e,{findBestSequence:w,preserveFirstStop:_,preserveLastStop:M,startTimeIsUTC:S,timeWindowsAreUTC:b}=r;v.analysisSettings=new pt.A({accumulateAttributes:h,directionsLanguage:y,findBestSequence:w,preserveFirstStop:_,preserveLastStop:M,startTimeIsUTC:S,timeWindowsAreUTC:b,travelMode:n}),v.totalDuration=Mt(v.totalCosts?.[s]??0,d),v.totalDistance=St(v.totalCosts?.[l]??0,f),v.totalLateDuration=Mt(v.totalViolations?.[s]??0,d),v.totalWaitDuration=Mt(v.totalWait?.[s]??0,d),null!=v.totalCosts&&g(v.totalCosts),null!=v.totalViolations&&g(v.totalViolations),null!=v.totalWait&&g(v.totalWait);for(const p of e.stops)null!=p.serviceCosts&&(p.serviceDuration=Mt(p.serviceCosts[s]??0,d),p.serviceDistance=St(p.serviceCosts[l]??0,f),g(p.serviceCosts)),null!=p.cumulativeCosts&&(p.cumulativeDuration=Mt(p.cumulativeCosts[s]??0,d),p.cumulativeDistance=St(p.cumulativeCosts[l]??0,f),g(p.cumulativeCosts)),null!=p.violations&&(p.lateDuration=Mt(p.violations[s]??0,d),g(p.violations)),null!=p.wait&&(p.waitDuration=Mt(p.wait[s]??0,d),g(p.wait))}async function _t(e){const t=Ce.A.WGS84;return await(0,A.initializeProjection)(e.spatialReference,t),(0,A.project)(e,t)}function Mt(e,t){switch(t){case"seconds":return e/60;case"hours":return 60*e;case"days":return 60*e*24;default:return e}}function St(e,t){return"decimal-degrees"===t||"points"===t||"unknown"===t?e:(0,m.oU)(e,t,"meters")}function bt(e){const{attributes:t,geometry:r,popupTemplate:o,symbol:i}=e.toGraphic().toJSON();return{attributes:t,geometry:r,popupInfo:o,symbol:i}}const At=c.A.ofType(Ee.A),It=c.A.ofType(De.A),Pt=c.A.ofType(je.A),Ct=c.A.ofType(Ge.A),Tt=c.A.ofType(Ue.A),Bt=c.A.ofType(dt.A),Nt="esri.layers.RouteLayer",Zt=()=>u.A.getLogger(Nt);let Lt=class extends((0,C.dM)((0,N.j)((0,T.q)((0,B.A)((0,d.P)(P.A)))))){constructor(e){super(e),this._cachedServiceDescription=null,this._featureCollection=null,this._type="Feature Collection",this.defaultSymbols=new D,this.directionLines=null,this.directionPoints=null,this.featureCollectionType="route",this.legendEnabled=!1,this.maxScale=0,this.minScale=0,this.pointBarriers=new Pt,this.polygonBarriers=new Ct,this.polylineBarriers=new Tt,this.routeInfo=null,this.spatialReference=Ce.A.WGS84,this.stops=new Bt,this.type="route";const t=()=>{this._setStopSymbol(this.stops)};this.addHandles((0,h.on)((()=>this.stops),"change",t,{sync:!0,onListenerAdd:t}))}writeFeatureCollectionWebmap(e,t,r,o){const i=[this._writePolygonBarriers(),this._writePolylineBarriers(),this._writePointBarriers(),this._writeRouteInfo(),this._writeDirectionLines(),this._writeDirectionPoints(),this._writeStops()].filter((e=>!!e)),n=i.map(((e,t)=>t)),s="web-map"===o.origin?"featureCollection.layers":"layers";(0,f.sM)(s,i,t),t.opacity=this.opacity,t.visibility=this.visible,t.visibleLayers=n}readDirectionLines(e,t){return this._getNetworkFeatures(t,"DirectionLines",(e=>Ee.A.fromGraphic(e)))}readDirectionPoints(e,t){return this._getNetworkFeatures(t,"DirectionPoints",(e=>De.A.fromGraphic(e)))}get fullExtent(){const e=new b.A({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:Ce.A.WGS84});if(null!=this.routeInfo?.geometry)return this.routeInfo.geometry.extent??e;if(null==this.stops)return e;const t=this.stops.filter((e=>null!=e.geometry));if(t.length<2)return e;const{spatialReference:r}=t.at(0).geometry;if(null==r)return e;const o=t.toArray().map((e=>{const t=e.geometry;return[t.x,t.y]}));return new ft.A({points:o,spatialReference:r}).extent}readMaxScale(e,t){const r=mt(t)?t.layers:t.featureCollection?.layers,o=r?.find((e=>null!=e.layerDefinition.maxScale));return o?.layerDefinition.maxScale??0}readMinScale(e,t){const r=mt(t)?t.layers:t.featureCollection?.layers,o=r?.find((e=>null!=e.layerDefinition.minScale));return o?.layerDefinition.minScale??0}readPointBarriers(e,t){return this._getNetworkFeatures(t,"Barriers",(e=>je.A.fromGraphic(e)))}readPolygonBarriers(e,t){return this._getNetworkFeatures(t,"PolygonBarriers",(e=>Ge.A.fromGraphic(e)))}readPolylineBarriers(e,t){return this._getNetworkFeatures(t,"PolylineBarriers",(e=>Ue.A.fromGraphic(e)))}readRouteInfo(e,t){return this._getNetworkFeatures(t,"RouteInfo",(e=>Je.A.fromGraphic(e))).at(0)??null}readSpatialReference(e,t){const r=mt(t)?t.layers:t.featureCollection?.layers;if(!r?.length)return Ce.A.WGS84;const{layerDefinition:o,featureSet:i}=r[0],n=i.features[0],s=n?.geometry?.spatialReference??i.spatialReference??o.spatialReference??o.extent.spatialReference??I.KK;return Ce.A.fromJSON(s)}readStops(e,t){return this._getNetworkFeatures(t,"Stops",(e=>dt.A.fromGraphic(e)),(e=>this._setStopSymbol(e)))}get title(){return this.routeInfo?.name??"Route"}set title(e){this._overrideIfSome("title",e)}get url(){return i.A.routeServiceUrl}set url(e){null!=e?this._set("url",(0,Z.Jf)(e,Zt())):this._set("url",i.A.routeServiceUrl)}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}removeAll(){this.removeResult(),this.pointBarriers.removeAll(),this.polygonBarriers.removeAll(),this.polylineBarriers.removeAll(),this.stops.removeAll()}removeResult(){null!=this.directionLines&&(this.directionLines.removeAll(),this._set("directionLines",null)),null!=this.directionPoints&&(this.directionPoints.removeAll(),this._set("directionPoints",null)),null!=this.routeInfo&&this._set("routeInfo",null)}async save(){await this.load();const{fullExtent:e,portalItem:t}=this;if(!t)throw new p.A("routelayer:portal-item-not-set","save() requires to the layer to have a portal item");if(!t.id)throw new p.A("routelayer:portal-item-not-saved","Please use saveAs() first to save the routelayer");if("Feature Collection"!==t.type)throw new p.A("routelayer:portal-item-wrong-type",'Portal item needs to have type "Feature Collection"');if(null==this.routeInfo)throw new p.A("routelayer:route-unsolved","save() requires a solved route");const{portal:r}=t;await r.signIn(),r.user||await t.reload();const{itemUrl:o,itemControl:i}=t;if("admin"!==i&&"update"!==i)throw new p.A("routelayer:insufficient-permissions","To save this layer, you need to be the owner or an administrator of your organization");const n={messages:[],origin:"portal-item",portal:r,url:o?(0,g.An)(o):void 0,writtenProperties:[]},s=this.write(void 0,n);return t.extent=await _t(e),t.title=this.title,await t.update({data:s}),t}async saveAs(e,t={}){if(await this.load(),null==this.routeInfo)throw new p.A("routelayer:route-unsolved","saveAs() requires a solved route");const r=G["default"].from(e).clone();r.extent??=await _t(this.fullExtent),r.id=null,r.portal??=j.A.getDefault(),r.title??=this.title,r.type="Feature Collection",r.typeKeywords=["Data","Feature Collection",U.mm.MULTI_LAYER,"Route Layer"];const{portal:o}=r,i={messages:[],origin:"portal-item",portal:o,url:null,writtenProperties:[]};await o.signIn();const n=t?.folder,s=this.write(void 0,i);return await(o.user?.addItem({item:r,folder:n,data:s})),this.portalItem=r,(0,S.v)(i),i.portalItem=r,r}async solve(e,t){const r=e?.stops??this.stops,o=e?.pointBarriers??yt(this.pointBarriers),i=e?.polylineBarriers??yt(this.polylineBarriers),n=e?.polygonBarriers??yt(this.polygonBarriers);if(null==r)throw new p.A("routelayer:undefined-stops","the route layer must have stops defined in the route parameters.");if((gt(r)||vt(r))&&r.features.length<2||c.A.isCollection(r)&&r.length<2)throw new p.A("routelayer:insufficent-stops","the route layer must have two or more stops to solve a route.");if(c.A.isCollection(r))for(const c of r)c.routeName=null;const s=e?.apiKey,l=this.url,a=await this._getServiceDescription(l,s,t),u=e?.travelMode??a.defaultTravelMode,d=e?.accumulateAttributes??[];null!=u&&(d.push(u.distanceAttributeName),u.timeAttributeName&&d.push(u.timeAttributeName));const f={accumulateAttributes:d,directionsOutputType:"featuresets",ignoreInvalidLocations:!0,pointBarriers:o,polylineBarriers:i,polygonBarriers:n,preserveFirstStop:!0,preserveLastStop:!0,returnBarriers:!!o,returnDirections:!0,returnPolygonBarriers:!!n,returnPolylineBarriers:!!i,returnRoutes:!0,returnStops:!0,stops:r},h=it.from(e??{});let m;h.set(f);try{m=await ze(l,h,t)}catch(v){throw(0,y.zf)(v)?v:new p.A("routelayer:failed-route-request","the routing request failed",{error:v})}const g=this._toRouteLayerSolution(m);return this._isOverridden("title")||(this.title=g.routeInfo.name??"Route"),wt(g,a,h),g}update(e){const{stops:t,directionLines:r,directionPoints:o,pointBarriers:i,polylineBarriers:n,polygonBarriers:s,routeInfo:l}=e;this.set({stops:t,pointBarriers:i,polylineBarriers:n,polygonBarriers:s}),this._set("directionLines",r),this._set("directionPoints",o),this._set("routeInfo",l),null!=l.geometry&&(this.spatialReference=l.geometry.spatialReference)}_getNetworkFeatures(e,t,r,o){const i=mt(e)?e.layers:e.featureCollection?.layers,n=i?.find((e=>e.layerDefinition.name===t));if(null==n)return new c.A;const{layerDefinition:u,popupInfo:p,featureSet:d}=n,f=u.drawingInfo.renderer,{features:y}=d,h=d.spatialReference??u.spatialReference??u.extent.spatialReference??I.KK,m=f&&(0,a.L)(f),g=Ce.A.fromJSON(h),v=y.map((e=>{const o=s.A.fromJSON(e);null!=o.geometry&&null!=e.geometry&&null==e.geometry.spatialReference&&(o.geometry.spatialReference=g);const i=r(o);return i.symbol??=m?.getSymbol(o)??this._getNetworkSymbol(t),i.popupTemplate??=p&&l.A.fromJSON(p),i}));return o&&v.some((({symbol:e})=>!e))&&o(v),new c.A(v)}_getNetworkSymbol(e){switch(e){case"Barriers":return this.defaultSymbols.pointBarriers;case"DirectionPoints":return this.defaultSymbols.directionPoints;case"DirectionLines":return this.defaultSymbols.directionLines;case"PolylineBarriers":return this.defaultSymbols.polylineBarriers;case"PolygonBarriers":return this.defaultSymbols.polygonBarriers;case"RouteInfo":return this.defaultSymbols.routeInfo;case"Stops":return null}}async _getServiceDescription(e,t,r){if(null!=this._cachedServiceDescription&&this._cachedServiceDescription.url===e)return this._cachedServiceDescription.serviceDescription;const o=await ne(e,t,r);return this._cachedServiceDescription={serviceDescription:o,url:e},o}_setStopSymbol(e){if(!e||0===e.length)return;if(null==this.defaultSymbols.stops)return;if(e.every((({symbol:e})=>null!=e)))return;const{first:t,last:r,middle:o,unlocated:i,waypoint:n,break:s}=this.defaultSymbols.stops;if(null==this.routeInfo||1===e.length)return void e.forEach(((i,n)=>{switch(n){case 0:i.symbol=t;break;case e.length-1:i.symbol=r;break;default:i.symbol=o}}));const l=e.map((({sequence:e})=>e)).filter((e=>null!=e)),a=Math.min(...l),u=Math.max(...l);for(const c of e)c.sequence!==a?c.sequence!==u?"ok"===c.status||"not-located-on-closest"===c.status?"waypoint"!==c.locationType?"break"!==c.locationType?c.symbol=o:c.symbol=s:c.symbol=n:c.symbol=i:c.symbol=r:c.symbol=t}_toRouteLayerSolution(e){const t=e.routeResults[0].stops?.map((e=>dt.A.fromJSON(e.toJSON())));this._setStopSymbol(t);const r=new Bt(t),o=new Ct(e.polygonBarriers?.map((e=>{const t=Ge.A.fromJSON(e.toJSON());return t.symbol=this.defaultSymbols.polygonBarriers,t}))),i=new Tt(e.polylineBarriers?.map((e=>{const t=Ue.A.fromJSON(e.toJSON());return t.symbol=this.defaultSymbols.polylineBarriers,t}))),n=new Pt(e.pointBarriers?.map((e=>{const t=je.A.fromJSON(e.toJSON());return t.symbol=this.defaultSymbols.pointBarriers,t}))),s=e.routeResults[0].route?.toJSON(),l=Je.A.fromJSON(s);l.symbol=this.defaultSymbols.routeInfo;const a=new It(e.routeResults[0].directionPoints?.features.map((e=>{const t=De.A.fromJSON(e.toJSON());return t.symbol=this.defaultSymbols.directionPoints,t})));return{directionLines:new At(e.routeResults[0].directionLines?.features.map((e=>{const t=Ee.A.fromJSON(e.toJSON());return t.symbol=this.defaultSymbols.directionLines,t}))),directionPoints:a,pointBarriers:n,polygonBarriers:o,polylineBarriers:i,routeInfo:l,stops:r}}_writeDirectionLines(){return this._writeNetworkFeatures(this.directionLines,this.defaultSymbols.directionLines,"esriGeometryPolyline",Ee.A.fields,"DirectionLines","Direction Lines")}_writeDirectionPoints(){return this._writeNetworkFeatures(this.directionPoints,this.defaultSymbols.directionPoints,"esriGeometryPoint",De.A.fields,"DirectionPoints","Direction Points")}_writeNetworkFeatures(e,t,r,o,i,n){if(!e?.length)return null;const s=this.spatialReference.toJSON(),{fullExtent:l,maxScale:a,minScale:u}=this;return{featureSet:{features:e.toArray().map((e=>bt(e))),geometryType:r,spatialReference:s},layerDefinition:{capabilities:"Query,Update,Editing",drawingInfo:{renderer:{type:"simple",symbol:null!=t?t.toJSON():ht(r)}},extent:l.toJSON(),fields:o,geometryType:r,hasM:!1,hasZ:!1,maxScale:a,minScale:u,name:i,objectIdField:"ObjectID",spatialReference:s,title:n,type:"Feature Layer",typeIdField:""}}}_writePointBarriers(){return this._writeNetworkFeatures(this.pointBarriers,this.defaultSymbols.pointBarriers,"esriGeometryPoint",je.A.fields,"Barriers","Point Barriers")}_writePolygonBarriers(){return this._writeNetworkFeatures(this.polygonBarriers,this.defaultSymbols.polygonBarriers,"esriGeometryPolygon",Ge.A.fields,"PolygonBarriers","Polygon Barriers")}_writePolylineBarriers(){return this._writeNetworkFeatures(this.polylineBarriers,this.defaultSymbols.polylineBarriers,"esriGeometryPolyline",Ue.A.fields,"PolylineBarriers","Line Barriers")}_writeRouteInfo(){return this._writeNetworkFeatures(null!=this.routeInfo?new c.A([this.routeInfo]):null,this.defaultSymbols.routeInfo,"esriGeometryPolyline",Je.A.fields,"RouteInfo","Route Details")}_writeStops(){const e=this._writeNetworkFeatures(this.stops,null,"esriGeometryPoint",dt.A.fields,"Stops","Stops");if(null==e)return null;const{stops:t}=this.defaultSymbols,r=t?.first?.toJSON(),o=t?.middle?.toJSON(),i=t?.last?.toJSON();return e.layerDefinition.drawingInfo.renderer={type:"uniqueValue",field1:"Sequence",defaultSymbol:o,uniqueValueInfos:[{value:"1",symbol:r,label:"First Stop"},{value:`${this.stops.length}`,symbol:i,label:"Last Stop"}]},e}};(0,o._)([(0,v.MZ)({readOnly:!0,json:{read:!1,origins:{"portal-item":{write:{allowNull:!0,ignoreOrigin:!0}},"web-map":{write:{overridePolicy(){return{allowNull:!0,ignoreOrigin:null==this.portalItem}}}}}}})],Lt.prototype,"_featureCollection",void 0),(0,o._)([(0,M.K)(["web-map","portal-item"],"_featureCollection")],Lt.prototype,"writeFeatureCollectionWebmap",null),(0,o._)([(0,v.MZ)({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{target:"type",overridePolicy(){return{ignoreOrigin:null!=this.portalItem}}}}}}})],Lt.prototype,"_type",void 0),(0,o._)([(0,v.MZ)({nonNullable:!0,type:D})],Lt.prototype,"defaultSymbols",void 0),(0,o._)([(0,v.MZ)({readOnly:!0})],Lt.prototype,"directionLines",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"directionLines",["layers","featureCollection.layers"])],Lt.prototype,"readDirectionLines",null),(0,o._)([(0,v.MZ)({readOnly:!0})],Lt.prototype,"directionPoints",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"directionPoints",["layers","featureCollection.layers"])],Lt.prototype,"readDirectionPoints",null),(0,o._)([(0,v.MZ)({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],Lt.prototype,"featureCollectionType",void 0),(0,o._)([(0,v.MZ)({readOnly:!0})],Lt.prototype,"fullExtent",null),(0,o._)([(0,v.MZ)({json:{origins:{"web-map":{name:"featureCollection.showLegend"}},write:!0}})],Lt.prototype,"legendEnabled",void 0),(0,o._)([(0,v.MZ)({type:["show","hide"]})],Lt.prototype,"listMode",void 0),(0,o._)([(0,v.MZ)({type:Number,nonNullable:!0,json:{write:!1}})],Lt.prototype,"maxScale",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"maxScale",["layers","featureCollection.layers"])],Lt.prototype,"readMaxScale",null),(0,o._)([(0,v.MZ)({type:Number,nonNullable:!0,json:{write:!1}})],Lt.prototype,"minScale",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"minScale",["layers","featureCollection.layers"])],Lt.prototype,"readMinScale",null),(0,o._)([(0,v.MZ)({type:["ArcGISFeatureLayer"],value:"ArcGISFeatureLayer"})],Lt.prototype,"operationalLayerType",void 0),(0,o._)([(0,v.MZ)({nonNullable:!0,type:c.A.ofType(je.A)})],Lt.prototype,"pointBarriers",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"pointBarriers",["layers","featureCollection.layers"])],Lt.prototype,"readPointBarriers",null),(0,o._)([(0,v.MZ)({nonNullable:!0,type:c.A.ofType(Ge.A)})],Lt.prototype,"polygonBarriers",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"polygonBarriers",["layers","featureCollection.layers"])],Lt.prototype,"readPolygonBarriers",null),(0,o._)([(0,v.MZ)({nonNullable:!0,type:c.A.ofType(Ue.A)})],Lt.prototype,"polylineBarriers",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"polylineBarriers",["layers","featureCollection.layers"])],Lt.prototype,"readPolylineBarriers",null),(0,o._)([(0,v.MZ)({readOnly:!0})],Lt.prototype,"routeInfo",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"routeInfo",["layers","featureCollection.layers"])],Lt.prototype,"readRouteInfo",null),(0,o._)([(0,v.MZ)({type:Ce.A})],Lt.prototype,"spatialReference",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"spatialReference",["layers","featureCollection.layers"])],Lt.prototype,"readSpatialReference",null),(0,o._)([(0,v.MZ)({nonNullable:!0,type:c.A.ofType(dt.A)})],Lt.prototype,"stops",void 0),(0,o._)([(0,w.w)(["web-map","portal-item"],"stops",["layers","featureCollection.layers"])],Lt.prototype,"readStops",null),(0,o._)([(0,v.MZ)()],Lt.prototype,"title",null),(0,o._)([(0,v.MZ)({readOnly:!0,json:{read:!1}})],Lt.prototype,"type",void 0),(0,o._)([(0,v.MZ)()],Lt.prototype,"url",null),Lt=(0,o._)([(0,_.$)(Nt)],Lt);const Rt=Lt},85633:function(e,t,r){r.d(t,{A:function(){return S}});r(44114);var o=r(40399),i=r(61768),n=r(4395),s=r(5049),l=r(26461),a=r(18244),u=r(8660),c=r(50942),p=r(13570),d=r(94),f=r(36861),y=(r(9302),r(95753),r(29811)),h=r(39834),m=r(63955),g=r(95541),v=r(45959),w=r(15350),_=r(65001),M=r(92153);const S=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,c.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,r){if(t.itemId)return new w["default"]({id:t.itemId,portal:r?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}async loadFromPortal(e,t){if(this.portalItem?.id)try{const{load:o}=await Promise.all([r.e(9470),r.e(5102)]).then(r.bind(r,25102));return(0,p.Te)(t),await o({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap},t)}catch(o){throw(0,p.zf)(o)||u.A.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${o}`),o}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,p.QP)(e),!0))))}async setUserPrivileges(e,t){if(!i.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:r,fullEdit:o},content:{updateItem:i}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",r),this._set("userHasFullEditingPrivileges",o),this._set("userHasUpdateItemPrivileges",i)}catch(r){(0,p.QP)(r)}}async _fetchUserPrivileges(e,t){let r=this.portalItem;if(!e||!r||!r.loaded||r.sourceUrl)return this._fetchFallbackUserPrivileges(t);const o=e===r.id;if(o&&r.portal.user)return(0,M.It)(r);let i,s;if(o)i=r.portal.url;else try{i=await(0,g.wI)(this.url,t)}catch(c){(0,p.QP)(c)}if(!i||!(0,d.b8)(i,r.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;s=await(n.id?.getCredential(`${i}/sharing`,{prompt:!1,signal:e}))}catch(c){(0,p.QP)(c)}const l=!0,a=!1,u=!1;if(!s)return{features:{edit:l,fullEdit:a},content:{updateItem:u}};try{if(o?await r.reload():(r=new w["default"]({id:e,portal:{url:i}}),await r.load(t)),r.portal.user)return(0,M.It)(r)}catch(c){(0,p.QP)(c)}return{features:{edit:l,fullEdit:a},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(r){(0,p.QP)(r)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?n.id?.findCredential(this.url):null;if(!t)return!0;const r=b.credential===t?b.user:await this._fetchEditingUser(e);return b.credential=t,b.user=r,null==r?.privileges||r.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const t=this.portalItem?.portal?.user;if(t)return t;const r=n.id?.findServerInfo(this.url??"");if(!r?.owningSystemUrl)return null;const o=`${r.owningSystemUrl}/sharing/rest`,i=v.A.getDefault();if(i&&i.loaded&&(0,d.S8)(i.restUrl)===(0,d.S8)(o))return i.user;const a=`${o}/community/self`,u=null!=e?e.signal:null,c=await(0,l.Ke)((0,s.A)(a,{authMode:"no-prompt",query:{f:"json"},signal:u}));return c.ok?_.A.fromJSON(c.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){const r=t?.portal,o=this.portalItem?.id&&(this.portalItem.portal||v.A.getDefault());return r&&o&&!(0,d.ut)(o.restUrl,r.restUrl)?(t.messages&&t.messages.push(new a.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,o._)([(0,f.MZ)({type:w["default"]})],t.prototype,"portalItem",null),(0,o._)([(0,y.w)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),(0,o._)([(0,m.K)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),(0,o._)([(0,f.MZ)({clonable:!1})],t.prototype,"resourceReferences",void 0),(0,o._)([(0,f.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),(0,o._)([(0,f.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),(0,o._)([(0,f.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=(0,o._)([(0,h.$)("esri.layers.mixins.PortalLayer")],t),t},b={credential:null,user:null}},91044:function(e,t,r){r.d(t,{A:function(){return h}});r(44114),r(17642),r(58004),r(33853),r(45876),r(32475),r(15024),r(31698);var o=r(18244),i=r(17010),n=r(8660),s=r(71207),l=r(59888),a=r(12014),u=r(57564),c=r(14116);function p(e){return"timeZone"in e}function d(e){return"timeZone"in e}function f(e){return"dateFieldsTimeZone"in e}const y=new Map;class h{static fromJSON(e){return new h(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new h(e.fields??[],w(e))}static fromLayerJSON(e){return new h(e.fields??[],w(e))}constructor(e=[],t){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const r=[];for(const o of this.fields){const e=o?.name,t=g(e);if(e&&t){const i=m(e);this._fieldsMap.set(e,o),this._fieldsMap.set(i,o),this._normalizedFieldsMap.set(t,o),r.push(`${i}:${o.type}:${this._timeZoneByFieldName?.get(e)}`),(0,a.vE)(o)?(this.dateFields.push(o),this._dateFieldsSet.add(o)):(0,a.WA)(o)&&(this._numericFieldsSet.add(o),this.numericFields.push(o)),(0,a.te)(o)||(0,a.Xz)(o)||(o.editable=null==o.editable||!!o.editable,o.nullable=null==o.nullable||!!o.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,a.te)(e)||(0,a.Xz)(e)||e.nullable||void 0!==(0,a.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(m(e))??this._normalizedFieldsMap.get(g(e)),t&&this._fieldsMap.set(e,t),t)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(n.A.getLogger("esri.layers.support.FieldsIndex").error(new o.A("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),u.n$):v.has(t.type)?u.L5:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.L5?l.GB.instance:t===u.n$?c.mQ.utcInstance:(0,s.tE)(y,t,(()=>c.oh.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,a.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>(0,i.Wj)(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function m(e){return e.trim().toLowerCase()}function g(e){return(0,a.rS)(e)?.toLowerCase()??""}const v=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function w(e){const t=new Map;if(!e.fields)return t;const r=!0===e.datesInUnknownTimezone,{timeInfo:o,editFieldsInfo:i}=e,n=(o?"startField"in o?o.startField:o.startTimeField:"")??"",s=(o?"endField"in o?o.endField:o.endTimeField:"")??"",l=f(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,u.ZS)(e.dateFieldsTimeReference):null,a=i?p(i)?i.timeZone??l:i.dateFieldsTimeReference?(0,u.ZS)(i.dateFieldsTimeReference):l??u.n$:null,c=o?d(o)?o.timeZone??l:o.timeReference?(0,u.ZS)(o.timeReference):l:null,y=new Map([[m(i?.creationDateField??""),a],[m(i?.editDateField??""),a],[m(n),c],[m(s),c]]);for(const{name:p,type:d}of e.fields)if(v.has(d))t.set(p,u.L5);else if("date"!==d&&"esriFieldTypeDate"!==d)t.set(p,null);else if(r)t.set(p,u.L5);else{const e=y.get(m(p??""))??l;t.set(p,e)}return t}},92153:function(e,t,r){r.d(t,{It:function(){return f},LG:function(){return l},OM:function(){return c},Y:function(){return a},bK:function(){return u},mm:function(){return d},sQ:function(){return p}});r(44114);var o=r(40162),i=r(70616),n=r(22193);async function s(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,n.ci)(e);const r=i.A.WGS84;return await(0,o.initializeProjection)(t,r),(0,o.project)(e,r)}function l(e,t){if(!a(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function a(e,t){return!!e.typeKeywords?.includes(t)}function u(e){return a(e,d.HOSTED_SERVICE)}function c(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}async function p(e){const t=e.clone().normalize();let r;if(t.length>1)for(const o of t)r?o.width>r.width&&(r=o):r=o;else r=t[0];return s(r)}const d={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function f(e){const{portal:t,isOrgItem:r,itemControl:o}=e,i=t.user?.privileges;let n=!i||i.includes("features:user:edit"),s=!!r&&!!i?.includes("features:user:fullEdit");const l="update"===o||"admin"===o;return l?s=n=!0:s&&(n=!0),{features:{edit:n,fullEdit:s},content:{updateItem:l}}}},37334:function(e,t,r){r.d(t,{O3:function(){return p},PU:function(){return u},YW:function(){return f},ex:function(){return l},hv:function(){return d},zp:function(){return a}});r(16573),r(78100),r(77936),r(37467),r(44732),r(79577);var o=r(27165),i=r(22443),n=r(88031),s=r(43911);const l=2.4;function a(e){return(0,i.PN)(e*l)}function u(e){return(0,i.Lz)(e)/l}function c(e,t,r,i){let{color:s,ratio:l}=t,{color:a,ratio:u}=r;if(u===l){const e=1e-6;1===u?l-=e:u+=e}const c=(0,o.qE)((i-l)/(u-l),0,1);(0,n.l)(e,s.toArray(),a.toArray(),c)}function p(e){const t=512,r=new Uint8ClampedArray(4*t);if(e=e.filter((({ratio:e})=>e>=0&&e<=1)).sort(((e,t)=>e.ratio-t.ratio)).map((({color:e,ratio:t})=>({color:e,ratio:Math.max(t,.001)}))),e.length<1)return r;let o=e[0],i=e[0],n=1;const l=(0,s.vt)();for(let s=0;s<t;s++){const a=(s+.5)/t;for(;a>i.ratio&&n<e.length;)o=i,i=e[n++];c(l,o,i,a),r.set(l,4*s)}return r}function d(e,t,r){const o=Math.sqrt(e**2+t**2)/r;return o>1?0:3/(Math.PI*r**2)*(1-o**2)**2}function f(e){return"function"==typeof e?e:e?t=>+t[e]:()=>1}},57242:function(e,t,r){r.d(t,{D:function(){return i},K:function(){return o}});const o={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},i={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0}}},80139:function(e,t,r){r.d(t,{$w:function(){return g},Bu:function(){return B},DW:function(){return I},FM:function(){return a},G9:function(){return i},GV:function(){return v},Go:function(){return c},K3:function(){return x},Kn:function(){return b},MM:function(){return f},MO:function(){return j},Nl:function(){return N},Ny:function(){return w},O2:function(){return Z},UE:function(){return L},YC:function(){return D},YF:function(){return k},ZO:function(){return O},_1:function(){return C},_H:function(){return M},_d:function(){return A},bs:function(){return E},e6:function(){return p},gQ:function(){return l},iA:function(){return z},jn:function(){return h},lW:function(){return d},mA:function(){return y},n5:function(){return R},pM:function(){return P},pV:function(){return S},pk:function(){return G},rB:function(){return U},xo:function(){return T},yH:function(){return _},zb:function(){return F},zr:function(){return m}});r(44114);var o=r(57242);function i(e){return[e.r,e.g,e.b,e.a]}const n=" /-,\n";function s(e){let t=e.length;for(;t--;)if(!n.includes(e.charAt(t)))return!1;return!0}function l(e,t){const r=[];let o=0,i=-1;do{if(i=e.indexOf("[",o),i>=o){if(i>o){const t=e.substr(o,i-o);r.push([t,null,s(t)])}if(o=i+1,i=e.indexOf("]",o),i>=o){if(i>o){const n=t[e.substr(o,i-o)];n&&r.push([null,n,!1])}o=i+1}}}while(-1!==i);if(o<e.length-1){const t=e.substr(o);r.push([t,null,s(t)])}return r}function a(e,t,r,o){let i="",n=null;for(const s of t){const[t,o,l]=s;if(t)l?n=t:(n&&(i+=n,n=null),i+=t);else{let t=o;null!=r&&(t=j(o,r));const s=e.attributes[t];s&&(n&&(i+=n,n=null),i+=s)}}return u(i,o)}function u(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function c(e,t,r,o,i,n,s=!0){const l=t/i,a=r/n,u=Math.ceil(l/2),c=Math.ceil(a/2);for(let p=0;p<n;p++)for(let r=0;r<i;r++){const d=4*(r+(s?n-p-1:p)*i);let f=0,y=0,h=0,m=0,g=0,v=0,w=0;const _=(p+.5)*a;for(let o=Math.floor(p*a);o<(p+1)*a;o++){const i=Math.abs(_-(o+.5))/c,n=(r+.5)*l,s=i*i;for(let a=Math.floor(r*l);a<(r+1)*l;a++){let r=Math.abs(n-(a+.5))/u;const i=Math.sqrt(s+r*r);i>=-1&&i<=1&&(f=2*i*i*i-3*i*i+1,f>0&&(r=4*(a+o*t),w+=f*e[r+3],h+=f,e[r+3]<255&&(f=f*e[r+3]/250),m+=f*e[r],g+=f*e[r+1],v+=f*e[r+2],y+=f))}}o[d]=m/y,o[d+1]=g/y,o[d+2]=v/y,o[d+3]=w/h}}function p(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function d(e){return e.data?.symbol??null}function f(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function y(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function h(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type)}function m(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const g=(e,t=0)=>null==e||isNaN(e)?t:e,v=(e,t)=>e??t,w=e=>e.tintColor?p(e.tintColor):[255,255,255,1],_=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function M(){return r.e(2749).then(r.bind(r,42749))}function S(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function b(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function A(e){let t="normal",r="normal";if(e){const o=e.toLowerCase();o.includes("italic")?t="italic":o.includes("oblique")&&(t="oblique"),o.includes("bold")?r="bold":o.includes("light")&&(r="lighter")}return{style:t,weight:r}}function I(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function P(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=P(t);if(null!=e)return e}break;case"CIMTextSymbol":return P(e.symbol);case"CIMSolidFill":return e.color}return null}function C(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=C(e);if(null!=t)return t}break}case"CIMTextSymbol":return C(e.symbol);case"CIMSolidStroke":return e.color}}function T(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=T(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return T(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function B(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function N(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function Z(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const L=e=>e.includes("data:image/svg+xml");function R(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function k(e){return e?e.charAt(0).toLowerCase()+e.substring(1):e}function F(e,t,r,o,i,n){const{infos:s}=n;let l=1,a=0,u=0,c=0;for(const{offsetX:f,offsetY:y,rotation:h,size:m,frameHeight:g,rotateClockWise:v}of s)u=$(f,y,a,l,u),c=J(f,y,a,l,c),g&&(l*=m/g),a=V(h,v,a);const p=$(o,i,a,l,u),d=J(o,i,a,l,c);return{size:e*l,rotation:V(t,r,a),offsetX:p,offsetY:d}}function O(e){if(null==e)return!1;if(Array.isArray(e))return e.every((e=>O(e)));switch(typeof e){case"string":return!!e;case"number":return!isNaN(e)}}function z(e,t){if("color"===t||"outlinecolor"===t||"backgroundcolor"===t||"borderlinecolor"===t||"tintcolor"===t)return[...o.K[t]];const r=o.D[e];if(!r)throw new Error(`InternalError: default value for type ${e}.`);return r[t]}function x(e){return e?.dashTemplate&&"string"==typeof e.dashTemplate&&(e.dashTemplate=e.dashTemplate.split(" ").map(Number)),e}function E(e){if(null==e)return"Normal";switch(e.type){case"CIMTextSymbol":return e.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const e of t)if("CIMVectorMarker"===e.type)return E(e)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const e of t)if(e.symbol)return E(e.symbol)}}return"Normal"}function D(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=r.size??o.D.CIMVectorMarker.size;e>t&&(t=e);break}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=r.width;null!=e&&e>t&&(t=e);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&m(r.markerPlacement)){const e=r.size??o.D.CIMVectorMarker.size;e>t&&(t=e)}break;case"CIMPictureFill":{const e=r.height;null!=e&&e>t&&(t=e)}}return t}}}function j(e,t){if(null!==t){const r=t.get(e);return r?r.name:e}return e}function G(e){return e.map((e=>({...e,propertyName:k(e.propertyName)})))}function U(e){const t={};for(const r in e){const o=e[r];t[k(r)]=o}return t}function J(e,t,r,o,i){const n=r*Math.PI/180;if(n){const r=Math.cos(n);return(Math.sin(n)*e+r*t)*o+i}return t*o+i}function $(e,t,r,o,i){const n=r*Math.PI/180;return n?(Math.cos(n)*e-Math.sin(n)*t)*o+i:e*o+i}function V(e,t,r){return t?r-e:r+e}}}]);
//# sourceMappingURL=579.39a00e85.js.map
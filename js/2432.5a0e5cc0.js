"use strict";(self["webpackChunkvue_arcgis_0905"]=self["webpackChunkvue_arcgis_0905"]||[]).push([[2432],{22432:function(t,e,r){r.d(e,{A:function(){return D}});r(44114);var n=r(40399),o=r(13592),i=r(18244),s=r(9302),a=r(13570),u=r(94),c=r(36861),l=(r(8660),r(95753),r(39834)),f=r(84427),d=r(70255),h=r(54595),y=r(86970),p=r(71161),m=(r(32334),r(67611)),_=r(28767),S=r(79429);async function g(t,e,r){const n=(0,y.Dl)(t),o=await(0,m.Jf)(n,_.A.from(e),{...r}),i=o.data.extent;return!i||isNaN(i.xmin)||isNaN(i.ymin)||isNaN(i.xmax)||isNaN(i.ymax)?{count:o.data.count,extent:null}:{count:o.data.count,extent:S.A.fromJSON(i)}}var x=r(9416),b=r(57345),F=r(62057),O=r(8917);let R=class extends o.A{constructor(t){super(t),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.url=null}get parsedUrl(){return(0,u.An)(this.url)}async execute(t,e){const r=await this.executeJSON(t,e);return this.featureSetFromJSON(t,r,e)}async executeJSON(t,e){const r=this._normalizeQuery(t),n=null!=t.outStatistics?.[0],o=(0,s.A)("featurelayer-pbf-statistics"),i=!n||o;let a;if(this.pbfSupported&&i)try{a=await(0,F.S)(this.url,r,e)}catch(u){if("query:parsing-pbf"!==u.name)throw u;this.pbfSupported=!1}return this.pbfSupported&&i||(a=await(0,b.e)(this.url,r,e)),this._normalizeFields(a.fields),a}async featureSetFromJSON(t,e,n){if(!this._queryIs3DObjectFormat(t)||null==this.infoFor3D||!e.features)return O.A.fromJSON(e);const{meshFeatureSetFromJSON:o}=await(0,a.qr)(Promise.all([r.e(7008),r.e(32),r.e(6248),r.e(888)]).then(r.bind(r,20644)),n);return o(t,this.infoFor3D,e)}executeForCount(t,e){return(0,p.I)(this.url,this._normalizeQuery(t),e)}executeForExtent(t,e){return g(this.url,this._normalizeQuery(t),e)}executeForIds(t,e){return(0,x.V)(this.url,this._normalizeQuery(t),e)}async executeRelationshipQuery(t,e){const[{default:n},{executeRelationshipQuery:o}]=await(0,a.qr)(Promise.all([Promise.resolve().then(r.bind(r,28041)),r.e(4822).then(r.bind(r,74822))]),e);return t=n.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),o(this.url,t,e)}async executeRelationshipQueryForCount(t,e){const[{default:n},{executeRelationshipQueryForCount:o}]=await(0,a.qr)(Promise.all([Promise.resolve().then(r.bind(r,28041)),r.e(4822).then(r.bind(r,74822))]),e);return t=n.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),o(this.url,t,e)}async executeAttachmentQuery(t,e){const{executeAttachmentQuery:n,fetchAttachments:o,processAttachmentQueryResult:i}=await(0,a.qr)(r.e(7657).then(r.bind(r,17657)),e),s=(0,y.Dl)(this.url);return i(s,await(this.queryAttachmentsSupported?n(s,t,e):o(s,t,e)))}async executeTopFeaturesQuery(t,e){const{executeTopFeaturesQuery:n}=await(0,a.qr)(r.e(7375).then(r.bind(r,7375)),e);return n(this.parsedUrl,t,this.sourceSpatialReference,e)}async executeForTopIds(t,e){const{executeForTopIds:n}=await(0,a.qr)(r.e(727).then(r.bind(r,60727)),e);return n(this.parsedUrl,t,e)}async executeForTopExtents(t,e){const{executeForTopExtents:n}=await(0,a.qr)(r.e(2928).then(r.bind(r,2928)),e);return n(this.parsedUrl,t,e)}async executeForTopCount(t,e){const{executeForTopCount:n}=await(0,a.qr)(r.e(1198).then(r.bind(r,11198)),e);return n(this.parsedUrl,t,e)}_normalizeQuery(t){let e=_.A.from(t);e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===t?e.clone():e,e.gdbVersion=t.gdbVersion||this.gdbVersion,e.dynamicDataSource=t.dynamicDataSource?h.L.from(t.dynamicDataSource):this.dynamicDataSource);const{infoFor3D:r}=this;if(null!=r&&this._queryIs3DObjectFormat(t)){e=e===t?e.clone():e,e.formatOf3DObjects=null;const{supportedFormats:n,queryFormats:o}=r,s=(0,d.R_)("model/gltf-binary",n)??(0,d.E1)("glb",n),a=(0,d.R_)("model/gltf+json",n)??(0,d.E1)("gltf",n);for(const t of o){if(t===s){e.formatOf3DObjects=t;break}t!==a||e.formatOf3DObjects||(e.formatOf3DObjects=t)}if(!e.formatOf3DObjects)throw new i.A("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(e.outSpatialReference&&!(0,f.aI)(e.outSpatialReference,this.sourceSpatialReference))throw new i.A("query:unsupported-out-spatial-reference","3D object feature services do not support projection of geometries");if(null==e.outFields||!e.outFields.includes("*")){e=e===t?e.clone():e,null==e.outFields&&(e.outFields=[]);const{originX:n,originY:o,originZ:i,translationX:s,translationY:a,translationZ:u,scaleX:c,scaleY:l,scaleZ:f,rotationX:d,rotationY:h,rotationZ:y,rotationDeg:p}=r.transformFieldRoles;e.outFields.push(n,o,i,s,a,u,c,l,f,d,h,y,p)}}return e}_normalizeFields(t){if(null!=this.fieldsIndex&&null!=t)for(const e of t){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON())}}_queryIs3DObjectFormat(t){return null!=this.infoFor3D&&!0===t.returnGeometry&&"xyFootprint"!==t.multipatchOption&&!t.outStatistics}};(0,n._)([(0,c.MZ)({type:h.L})],R.prototype,"dynamicDataSource",void 0),(0,n._)([(0,c.MZ)()],R.prototype,"fieldsIndex",void 0),(0,n._)([(0,c.MZ)()],R.prototype,"gdbVersion",void 0),(0,n._)([(0,c.MZ)()],R.prototype,"infoFor3D",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],R.prototype,"parsedUrl",null),(0,n._)([(0,c.MZ)()],R.prototype,"pbfSupported",void 0),(0,n._)([(0,c.MZ)()],R.prototype,"queryAttachmentsSupported",void 0),(0,n._)([(0,c.MZ)()],R.prototype,"sourceSpatialReference",void 0),(0,n._)([(0,c.MZ)({type:String})],R.prototype,"url",void 0),R=(0,n._)([(0,l.$)("esri.layers.graphics.sources.support.QueryTask")],R);const D=R},70255:function(t,e,r){r.d(e,{E1:function(){return a},Fm:function(){return u},JZ:function(){return _},R_:function(){return s},fu:function(){return o},oF:function(){return i},rq:function(){return c}});r(44114);const n=[["binary","application/octet-stream","bin",""]];function o(t,e){return null!=h(e.name,t?.supportedFormats??[])}function i(t,e){if(!t)return!1;const r=c(e,t.supportedFormats??[]);return null!=r&&t.editFormats.includes(r)}function s(t,e){return y(d(t,e))}function a(t,e){return y(h(t,e))}function u(t,e){return p(f(t,e))}function c(t,e){return a(t.name,e)??s(t.type,e)}function l(t){return[...n,...t]}function f(t,e){return l(e).find((e=>y(e)===t))}function d(t,e){const r=t.toLowerCase();return l(e).find((t=>p(t)===r))}function h(t,e){const r=t.toLowerCase();return l(e).find((t=>m(t).some((t=>r.endsWith(t)))))}function y(t){return t?.[0]}function p(t){return t?.[1].toLowerCase()}function m(t){return t?.[2].split(",").map((t=>t.toLowerCase()))??[]}function _(t){return t.tables?.find((t=>"assetMaps"===t.role))}},29798:function(t,e,r){function n(t){const e={};for(const r in t){if("declaredClass"===r)continue;const o=t[r];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){e[r]=[];for(let t=0;t<o.length;t++)e[r][t]=n(o[t])}else"object"==typeof o?o.toJSON&&(e[r]=JSON.stringify(o)):e[r]=o}return e}r.d(e,{z:function(){return n}})},71161:function(t,e,r){r.d(e,{I:function(){return s}});var n=r(86970),o=r(67611),i=r(28767);async function s(t,e,r){const s=(0,n.Dl)(t),{data:a}=await(0,o.gW)(s,i.A.from(e),r);return a.count}},9416:function(t,e,r){r.d(e,{V:function(){return s}});var n=r(86970),o=r(67611),i=r(28767);async function s(t,e,r){const s=(0,n.Dl)(t),{data:a}=await(0,o.Pk)(s,i.A.from(e),r);return a.objectIds}},57345:function(t,e,r){r.d(e,{e:function(){return u},s:function(){return a}});var n=r(86970),o=r(67611),i=r(8917),s=r(28767);async function a(t,e,r){const n=await u(t,e,r);return i.A.fromJSON(n)}async function u(t,e,r){const i=(0,n.Dl)(t),a={...r},u=s.A.from(e),{data:c}=await(0,o.eW)(i,u,u.sourceSpatialReference,a);return c}},62057:function(t,e,r){r.d(e,{S:function(){return _}});var n=r(86970),o=(r(44114),r(50942)),i=r(6737),s=r(3234);function a(t,e){return e}function u(t,e,r,n){switch(r){case 0:return d(t,e+n,0);case 1:return"lowerLeft"===t.originPosition?d(t,e+n,1):h(t,e+n,1)}}function c(t,e,r,n){return 2===r?d(t,e,2):u(t,e,r,n)}function l(t,e,r,n){return 2===r?0===e?0:d(t,e,3):u(t,e,r,n)}function f(t,e,r,n){return 3===r?0===e?0:d(t,e,3):c(t,e,r,n)}function d({translate:t,scale:e},r,n){return t[n]+r*e[n]}function h({translate:t,scale:e},r,n){return t[n]-r*e[n]}class y{constructor(t){this._options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=a,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._mValueOffset=null,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(t){if(this._options.applyTransform&&(t.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!t.hasZ)return;const e=(0,i.N)(t.geometryType,this._options.sourceSpatialReference,t.spatialReference);if(null!=e)for(const r of t.features)e(r.geometry)}createSpatialReference(){return{}}addField(t,e){const r=t.fields;(0,o.Lw)(r),r.push(e);const n=r.map((t=>t.name));this._attributesConstructor=function(){for(const t of n)this[t]=null}}addFeature(t,e){t.features.push(e)}prepareFeatures(t){switch(this._transform=t.transform,this._options.applyTransform&&t.transform&&(this._applyTransform=this._deriveApplyTransform(t)),this._mValueOffset=null,this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&(this._mValueOffset=this._vertexDimension,this._vertexDimension++),t.geometryType){case"esriGeometryPoint":this.addCoordinate=(t,e,r)=>this.addCoordinatePoint(t,e,r),this.createGeometry=t=>this.createPointGeometry(t);break;case"esriGeometryPolygon":this.addCoordinate=(t,e,r)=>this._addCoordinatePolygon(t,e,r),this.createGeometry=t=>this._createPolygonGeometry(t);break;case"esriGeometryPolyline":this.addCoordinate=(t,e,r)=>this._addCoordinatePolyline(t,e,r),this.createGeometry=t=>this._createPolylineGeometry(t);break;case"esriGeometryMultipoint":this.addCoordinate=(t,e,r)=>this._addCoordinateMultipoint(t,e,r),this.createGeometry=t=>this._createMultipointGeometry(t)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(t,e,r){0===this._lengths.length&&(this._toAddInCurrentPath=e),this._lengths.push(e)}addQueryGeometry(t,e){const{queryGeometry:r,queryGeometryType:n}=e,o=(0,s.Ch)(r.clone(),r,!1,!1,this._transform),i=(0,s.zv)(o,n,!1,!1);t.queryGeometryType=n,t.queryGeometry={...i}}createPointGeometry(t){const e={x:0,y:0,spatialReference:t.spatialReference};return t.hasZ&&(e.z=0),t.hasM&&(e.m=0),e}addCoordinatePoint(t,e,r){const n=this._transform;switch(e=this._applyTransform(n,e,r,0),r){case 0:t.x=e;break;case 1:t.y=e;break;case 2:"z"in t?t.z=e:t.m=e;break;case 3:t.m=e}}_transformPathLikeValue(t,e){let r=0;e<=1&&(r=this._previousCoordinate[e],this._previousCoordinate[e]+=t);const n=this._transform;return null!==this._mValueOffset&&0===t&&e>0&&!(e%this._mValueOffset)?0:this._applyTransform(n,t,e,r)}_addCoordinatePolyline(t,e,r){this._dehydratedAddPointsCoordinate(t.paths,e,r)}_addCoordinatePolygon(t,e,r){this._dehydratedAddPointsCoordinate(t.rings,e,r)}_addCoordinateMultipoint(t,e,r){0===r&&t.points.push([]);const n=this._transformPathLikeValue(e,r);t.points[t.points.length-1].push(n)}_createPolygonGeometry(t){return{rings:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createPolylineGeometry(t){return{paths:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createMultipointGeometry(t){return{points:[],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_dehydratedAddPointsCoordinate(t,e,r){0===r&&0==this._toAddInCurrentPath--&&(t.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const n=this._transformPathLikeValue(e,r),o=t[t.length-1];0===r&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),o.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=n}_deriveApplyTransform(t){const{hasZ:e,hasM:r}=t;return e&&r?f:e?c:r?l:u}}var p=r(67611),m=(r(8917),r(28767));async function _(t,e,r){const o=(0,n.Dl)(t),i={...r},s=m.A.from(e),a=!s.quantizationParameters,{data:u}=await(0,p.IJ)(o,s,new y({sourceSpatialReference:s.sourceSpatialReference,applyTransform:a}),i);return u}},67611:function(t,e,r){r.d(e,{IJ:function(){return p},Jf:function(){return g},Pk:function(){return _},eW:function(){return y},gW:function(){return S},kS:function(){return m}});var n=r(5049),o=r(94),i=r(55910),s=r(55555),a=r(84427),u=r(29798),c=r(10682),l=r(46591);const f="Layer does not support extent calculation.";function d(t,e){if(e&&"extent"===t.type)return`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`;if(e&&"point"===t.type)return`${t.x},${t.y}`;const r=t.toJSON();return delete r.spatialReference,JSON.stringify(r)}function h(t,e){const r=t.geometry,n=t.toJSON();delete n.compactGeometryEnabled,delete n.defaultSpatialReferenceEnabled;const o=n;let s,u,c;if(null!=r&&(u=r.spatialReference,c=(0,a.YX)(u),o.geometryType=(0,i.$B)(r),o.geometry=d(r,t.compactGeometryEnabled),o.inSR=c),n.groupByFieldsForStatistics&&(o.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(o.objectIds=n.objectIds.join(",")),n.orderByFields&&(o.orderByFields=n.orderByFields.join(",")),!n.outFields||!n.returnDistinctValues&&(e?.returnCountOnly||e?.returnExtentOnly||e?.returnIdsOnly)?delete o.outFields:n.outFields.includes("*")?o.outFields="*":o.outFields=n.outFields.join(","),n.outSR?(o.outSR=(0,a.YX)(n.outSR),s=t.outSpatialReference):r&&(n.returnGeometry||n.returnCentroid)&&(o.outSR=o.inSR,s=u),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(o.outStatistics=JSON.stringify(n.outStatistics)),n.fullText&&(o.fullText=JSON.stringify(n.fullText)),n.pixelSize&&(o.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(t.defaultSpatialReferenceEnabled&&null!=u&&null!=t.quantizationParameters?.extent&&u.equals(t.quantizationParameters.extent.spatialReference)&&delete n.quantizationParameters.extent.spatialReference,o.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.parameterValues&&(o.parameterValues=JSON.stringify(n.parameterValues)),n.rangeValues&&(o.rangeValues=JSON.stringify(n.rangeValues)),n.dynamicDataSource&&(o.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource),n.timeExtent){const t=n.timeExtent,{start:e,end:r}=t;null==e&&null==r||(o.time=e===r?e:`${e??"null"},${r??"null"}`),delete n.timeExtent}return t.defaultSpatialReferenceEnabled&&null!=u&&null!=s&&u.equals(s)&&(o.defaultSR=o.inSR,delete o.inSR,delete o.outSR),o}async function y(t,e,r,n){const o=null!=e.timeExtent&&e.timeExtent.isEmpty?{data:{features:[]}}:await x(t,e,"json",n);return(0,l.q)(e,r,o.data),o}async function p(t,e,r,n){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:r.createFeatureResult()};const o=await m(t,e,n),i=o;return i.data=(0,c.m)(o.data,r),i}function m(t,e,r){return x(t,e,"pbf",r)}function _(t,e,r){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):x(t,e,"json",r,{returnIdsOnly:!0})}function S(t,e,r){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):x(t,e,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}async function g(t,e,r){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:{count:0,extent:null}};const n=await x(t,e,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}),o=n.data;if(o.hasOwnProperty("extent"))return n;if(o.features)throw new Error(f);if(o.hasOwnProperty("count"))throw new Error(f);return n}async function x(t,e,r,i={},a={}){const c="string"==typeof t?(0,o.An)(t):t,l=e.geometry?[e.geometry]:[],f=await(0,s.el)(l,null,{signal:i.signal}),d=f?.[0];null!=d&&((e=e.clone()).geometry=d);const y=(0,u.z)({...c.query,f:r,...a,...h(e,a)});return(0,n.A)((0,o.fj)(c.path,b(e,a)?"query3d":"query"),{...i,responseType:"pbf"===r?"array-buffer":"json",query:{...y,...i.query}})}function b(t,e){return null!=t.formatOf3DObjects&&!(e.returnCountOnly||e.returnExtentOnly||e.returnIdsOnly)}}}]);
//# sourceMappingURL=2432.5a0e5cc0.js.map
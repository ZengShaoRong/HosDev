"use strict";(self["webpackChunkvue_arcgis_0905"]=self["webpackChunkvue_arcgis_0905"]||[]).push([[4908],{53392:function(t,e,i){i.d(e,{A:function(){return r}});class r{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const e=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,e}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}peekLast(){return 0===this.size?null:this._buffer[(this._start+(this.size-1))%this.maxSize]}find(t){if(0===this.size)return null;for(const e of this._buffer)if(null!=e&&t(e))return e;return null}clear(t){let e=this.dequeue();for(;null!=e;)t&&t(e),e=this.dequeue()}}},65596:function(t,e,i){i.d(e,{F:function(){return c},l:function(){return l}});var r=i(47771),n=i(9302);const s=128e3;let o=null,a=null;async function c(){return o||(o=u()),o}async function u(){const t=(0,n.A)("esri-csp-restrictions")?await i.e(8236).then(i.bind(i,65855)).then((t=>t.l)):await i.e(6493).then(i.bind(i,36493)).then((t=>t.l));a=await t.default({locateFile:t=>(0,r.s)(`esri/core/libs/libtess/${t}`)})}function l(t,e){const i=Math.max(t.length,s);return a.triangulate(t,e,i)}},78425:function(t,e,i){i.d(e,{V:function(){return u}});i(44114);var r=i(95719),n=i(9540),s=i(59203),o=i(14168),a=i(74233);const c=96/72;class u{static executeEffects(t,e,i,r){const n=c,u=(0,a.ll)(t);let l=new s.k(e);for(const s of t){const t=(0,o.A)(s);t&&(l=t.execute(l,s,n,i,r,u))}return l}static applyEffects(t,e,i){if(!t)return e;const c=(0,a.ll)(t);let u,l=new s.k(r.z.fromJSONCIM(e));for(const r of t){const t=(0,o.A)(r);t&&(l=t.execute(l,r,1,null,i,c))}const h=[];let p=null;for(;u=l.next();)h.push(...(0,n.x)(u)),p=u.geometryType;return 0===h.length||null===p?null:"esriGeometryPolygon"===p?{rings:h}:{paths:h}}}},12539:function(t,e,i){i.d(e,{l:function(){return n}});var r=i(14168);class n{static getPlacement(t,e,i,n,s,o){const a=(0,r.c)(i);return a?(-1===e&&t.invertY(),a.execute(t,i,n,s,o)):null}}},59235:function(t,e,i){i.d(e,{i:function(){return d}});var r=i(18352),n=i(42655);function s(t,e){return t.x===e.x&&t.y===e.y}function o(t){if(!t)return;const e=t.length;if(e<=1)return;let i=0;for(let r=1;r<e;r++)s(t[r],t[i])||++i===r||(t[i]=t[r]);t.length=i+1}function a(t,e){return t.x=e.y,t.y=-e.x,t}function c(t,e){return t.x=-e.y,t.y=e.x,t}function u(t,e){return t.x=e.x,t.y=e.y,t}function l(t,e){return t.x=-e.x,t.y=-e.y,t}function h(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function p(t,e){return t.x*e.y-t.y*e.x}function f(t,e){return t.x*e.x+t.y*e.y}function x(t,e,i,r){return t.x=e.x*i+e.y*r,t.y=e.x*r-e.y*i,t}class d{constructor(t,e,i){this._writeVertex=t,this._writeTriangle=e,this._canUseThinTessellation=i,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(t,e,i=this._canUseThinTessellation){o(t),i&&e.halfWidth<n.Gh&&!e.offset?this._tessellateThin(t,e):this._tessellate(t,e)}_tessellateThin(t,e){if(t.length<2)return;const i=e.wrapDistance||65535;let r=e.initialDistance||0,n=!1,s=t[0].x,o=t[0].y;const a=t.length;for(let c=1;c<a;++c){n&&(n=!1,r=0);let e=t[c].x,a=t[c].y,u=e-s,l=a-o,h=Math.sqrt(u*u+l*l);if(u/=h,l/=h,r+h>i){n=!0;const t=(i-r)/h;h=i-r,e=(1-t)*s+t*e,a=(1-t)*o+t*a,--c}const p=this._writeVertex(s,o,0,0,u,l,l,-u,0,-1,r),f=this._writeVertex(s,o,0,0,u,l,-l,u,0,1,r);r+=h;const x=this._writeVertex(e,a,0,0,u,l,l,-u,0,-1,r),d=this._writeVertex(e,a,0,0,u,l,-l,u,0,1,r);this._writeTriangle(p,f,x),this._writeTriangle(f,x,d),s=e,o=a}}_tessellate(t,e){const i=t[0],n=t[t.length-1],o=s(i,n),d=o?3:2;if(t.length<d)return;const y=e.pixelCoordRatio,m=null!=e.capType?e.capType:r.xR.BUTT,_=null!=e.joinType?e.joinType:r.JO.MITER,g=null!=e.miterLimit?Math.min(e.miterLimit,4):2,v=null!=e.roundLimit?Math.min(e.roundLimit,1.05):1.05,w=null!=e.halfWidth?e.halfWidth:2,b=!!e.textured;let k,T,S,P=null;const z=this._prevNormal,E=this._nextNormal;let M=-1,L=-1;const N=this._joinNormal;let R,I;const B=this._textureNormalLeft,A=this._textureNormalRight,D=this._textureNormal;let Y=-1,O=-1;const F=e.wrapDistance||65535;let G=e.initialDistance||0;const C=this._writeVertex,V=this._writeTriangle,U=(t,e,i,r,n,s)=>{const o=C(T,S,R,I,i,r,t,e,n,s,G);return Y>=0&&O>=0&&o>=0&&V(Y,O,o),Y=O,O=o,o};o&&(k=t[t.length-2],E.x=n.x-k.x,E.y=n.y-k.y,L=h(E),E.x/=L,E.y/=L);let W=!1;for(let s=0;s<t.length;++s){if(W&&(W=!1,G=0),k&&(z.x=-E.x,z.y=-E.y,M=L,G+M>F&&(W=!0)),W){const e=(F-G)/M;M=F-G,k={x:(1-e)*k.x+e*t[s].x,y:(1-e)*k.y+e*t[s].y},--s}else k=t[s];T=k.x,S=k.y;const e=s<=0&&!W,i=s===t.length-1;if(e||(G+=M),P=i?o?t[1]:null:t[s+1],P?(E.x=P.x-T,E.y=P.y-S,L=h(E),E.x/=L,E.y/=L):(E.x=void 0,E.y=void 0),!o){if(e){c(N,E),R=N.x,I=N.y,m===r.xR.SQUARE&&(U(-E.y-E.x,E.x-E.y,E.x,E.y,0,-1),U(E.y-E.x,-E.x-E.y,E.x,E.y,0,1)),m===r.xR.ROUND&&(U(-E.y-E.x,E.x-E.y,E.x,E.y,-1,-1),U(E.y-E.x,-E.x-E.y,E.x,E.y,-1,1)),m!==r.xR.ROUND&&m!==r.xR.BUTT||(U(-E.y,E.x,E.x,E.y,0,-1),U(E.y,-E.x,E.x,E.y,0,1));continue}if(i){a(N,z),R=N.x,I=N.y,m!==r.xR.ROUND&&m!==r.xR.BUTT||(U(z.y,-z.x,-z.x,-z.y,0,-1),U(-z.y,z.x,-z.x,-z.y,0,1)),m===r.xR.SQUARE&&(U(z.y-z.x,-z.x-z.y,-z.x,-z.y,0,-1),U(-z.y-z.x,z.x-z.y,-z.x,-z.y,0,1)),m===r.xR.ROUND&&(U(z.y-z.x,-z.x-z.y,-z.x,-z.y,1,-1),U(-z.y-z.x,z.x-z.y,-z.x,-z.y,1,1));continue}}let n,d,C=-p(z,E);if(Math.abs(C)<.01)f(z,E)>0?(N.x=z.x,N.y=z.y,C=1,n=Number.MAX_VALUE,d=!0):(c(N,E),C=1,n=1,d=!1);else{N.x=(z.x+E.x)/C,N.y=(z.y+E.y)/C,n=h(N);const t=(n-1)*w*y;d=n>4||t>M&&t>L}R=N.x,I=N.y;let V=_;switch(_){case r.JO.BEVEL:n<1.05&&(V=r.JO.MITER);break;case r.JO.ROUND:n<v&&(V=r.JO.MITER);break;case r.JO.MITER:n>g&&(V=r.JO.BEVEL)}switch(V){case r.JO.MITER:if(U(N.x,N.y,-z.x,-z.y,0,-1),U(-N.x,-N.y,-z.x,-z.y,0,1),i)break;if(b){const t=W?0:G;Y=this._writeVertex(T,S,R,I,E.x,E.y,N.x,N.y,0,-1,t),O=this._writeVertex(T,S,R,I,E.x,E.y,-N.x,-N.y,0,1,t)}break;case r.JO.BEVEL:{const t=C<0;let e,r,n,s;if(t){const t=Y;Y=O,O=t,e=B,r=A}else e=A,r=B;if(d)n=t?c(this._innerPrev,z):a(this._innerPrev,z),s=t?a(this._innerNext,E):c(this._innerNext,E);else{const e=t?l(this._inner,N):u(this._inner,N);n=e,s=e}const o=t?a(this._bevelStart,z):c(this._bevelStart,z);U(n.x,n.y,-z.x,-z.y,e.x,e.y);const h=U(o.x,o.y,-z.x,-z.y,r.x,r.y);if(i)break;const p=t?c(this._bevelEnd,E):a(this._bevelEnd,E);if(d){const t=this._writeVertex(T,S,R,I,-z.x,-z.y,0,0,0,0,G);Y=this._writeVertex(T,S,R,I,E.x,E.y,s.x,s.y,e.x,e.y,G),O=this._writeVertex(T,S,R,I,E.x,E.y,p.x,p.y,r.x,r.y,G),this._writeTriangle(h,t,O)}else{if(b){const t=this._bevelMiddle;t.x=(o.x+p.x)/2,t.y=(o.y+p.y)/2,x(D,t,-z.x,-z.y),U(t.x,t.y,-z.x,-z.y,D.x,D.y),x(D,t,E.x,E.y),Y=this._writeVertex(T,S,R,I,E.x,E.y,t.x,t.y,D.x,D.y,G),O=this._writeVertex(T,S,R,I,E.x,E.y,s.x,s.y,e.x,e.y,G)}else{const t=Y;Y=O,O=t}U(p.x,p.y,E.x,E.y,r.x,r.y)}if(t){const t=Y;Y=O,O=t}break}case r.JO.ROUND:{const t=C<0;let e,r;if(t){const t=Y;Y=O,O=t,e=B,r=A}else e=A,r=B;const s=t?l(this._inner,N):u(this._inner,N);let o,h;d?(o=t?c(this._innerPrev,z):a(this._innerPrev,z),h=t?a(this._innerNext,E):c(this._innerNext,E)):(o=s,h=s);const p=t?a(this._roundStart,z):c(this._roundStart,z),y=t?c(this._roundEnd,E):a(this._roundEnd,E),m=U(o.x,o.y,-z.x,-z.y,e.x,e.y),_=U(p.x,p.y,-z.x,-z.y,r.x,r.y);if(i)break;const g=this._writeVertex(T,S,R,I,-z.x,-z.y,0,0,0,0,G);d||this._writeTriangle(Y,O,g);const v=l(this._outer,s),w=this._writeVertex(T,S,R,I,E.x,E.y,y.x,y.y,r.x,r.y,G);let k,P;const M=n>2;if(M){let e;n!==Number.MAX_VALUE?(v.x/=n,v.y/=n,e=f(z,v),e=(n*(e*e-1)+1)/e):e=-1,k=t?a(this._startBreak,z):c(this._startBreak,z),k.x+=z.x*e,k.y+=z.y*e,P=t?c(this._endBreak,E):a(this._endBreak,E),P.x+=E.x*e,P.y+=E.y*e}x(D,v,-z.x,-z.y);const L=this._writeVertex(T,S,R,I,-z.x,-z.y,v.x,v.y,D.x,D.y,G);x(D,v,E.x,E.y);const F=b?this._writeVertex(T,S,R,I,E.x,E.y,v.x,v.y,D.x,D.y,G):L,V=g,W=b?this._writeVertex(T,S,R,I,E.x,E.y,0,0,0,0,G):g;let X=-1,H=-1;if(M&&(x(D,k,-z.x,-z.y),X=this._writeVertex(T,S,R,I,-z.x,-z.y,k.x,k.y,D.x,D.y,G),x(D,P,E.x,E.y),H=this._writeVertex(T,S,R,I,E.x,E.y,P.x,P.y,D.x,D.y,G)),b?M?(this._writeTriangle(V,_,X),this._writeTriangle(V,X,L),this._writeTriangle(W,F,H),this._writeTriangle(W,H,w)):(this._writeTriangle(V,_,L),this._writeTriangle(W,F,w)):M?(this._writeTriangle(g,_,X),this._writeTriangle(g,X,H),this._writeTriangle(g,H,w)):(this._writeTriangle(g,_,L),this._writeTriangle(g,F,w)),d?(Y=this._writeVertex(T,S,R,I,E.x,E.y,h.x,h.y,e.x,e.y,G),O=w):(Y=b?this._writeVertex(T,S,R,I,E.x,E.y,h.x,h.y,e.x,e.y,G):m,this._writeTriangle(Y,W,w),O=w),t){const t=Y;Y=O,O=t}break}}}}}},88695:function(t,e,i){i.d(e,{uS:function(){return Z},FE:function(){return q},lO:function(){return W},XZ:function(){return X}});i(44114),i(76463);var r=i(65596),n=i(81640),s=i(46740),o=i(42655);function a(t,e,i,r,n,s,o){O=0;const a=(r-i)*s,u=n&&n.length,h=u?(n[0]-i)*s:a;let p,f,x,d,m,_=c(e,i,r,0,h,s,!0);if(_&&_.next!==_.prev){if(u&&(_=y(e,i,r,n,_,s)),a>80*s){p=x=e[0+i*s],f=d=e[1+i*s];for(let t=s;t<h;t+=s){const r=e[t+i*s],n=e[t+1+i*s];p=Math.min(p,r),f=Math.min(f,n),x=Math.max(x,r),d=Math.max(d,n)}m=Math.max(x-p,d-f),m=0!==m?1/m:0}l(_,t,s,p,f,m,o,0)}}function c(t,e,i,r,n,s,o){let a;if(o===T(t,e,i,r,n,s)>0)for(let c=r;c<n;c+=s)a=f(c+e*s,t[c+e*s],t[c+1+e*s],a);else for(let c=n-s;c>=r;c-=s)a=f(c+e*s,t[c+e*s],t[c+1+e*s],a);return a&&E(a,a.next)&&(x(a),a=a.next),a}function u(t,e=t){if(!t)return t;let i,r=t;do{if(i=!1,r.steiner||!E(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(x(r),r=e=r.prev,r===r.next)break;i=!0}}while(i||r!==e);return e}function l(t,e,i,r,n,s,o,a){if(!t)return;!a&&s&&(t=g(t,r,n,s));let c=t;for(;t.prev!==t.next;){const f=t.prev,d=t.next;if(s?p(t,r,n,s):h(t))e.push(f.index/i+o),e.push(t.index/i+o),e.push(d.index/i+o),x(t),t=d.next,c=d.next;else if((t=d)===c){a?1===a?l(t=L(t,e,i,o),e,i,r,n,s,o,2):2===a&&N(t,e,i,r,n,s,o):l(u(t),e,i,r,n,s,o,1);break}}}function h(t){const e=t.prev,i=t,r=t.next;if(w(e,i,r)>=0)return!1;let n=t.next.next;const s=n;let o=0;for(;n!==t.prev&&(0===o||n!==s);){if(o++,S(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&w(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function p(t,e,i,r){const n=t.prev,s=t,o=t.next;if(w(n,s,o)>=0)return!1;const a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,c=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,l=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,h=z(a,c,e,i,r),p=z(u,l,e,i,r);let f=t.prevZ,x=t.nextZ;for(;f&&f.z>=h&&x&&x.z<=p;){if(f!==t.prev&&f!==t.next&&S(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,x!==t.prev&&x!==t.next&&S(n.x,n.y,s.x,s.y,o.x,o.y,x.x,x.y)&&w(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&S(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;x&&x.z<=p;){if(x!==t.prev&&x!==t.next&&S(n.x,n.y,s.x,s.y,o.x,o.y,x.x,x.y)&&w(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function f(t,e,i,r){const n=A.create(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function d(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function y(t,e,i,r,n,s){const o=new Array;for(let a=0,u=r.length;a<u;a++){const n=c(t,e,i,r[a]*s,a<u-1?r[a+1]*s:i*s,s,!1);n===n.next&&(n.steiner=!0),o.push(d(n))}o.sort(M);for(const a of o)n=m(a,n);return n}function m(t,e){const i=_(t,e);if(!i)return e;const r=B(i,t);return u(r,r.next),u(i,i.next)}function _(t,e){let i=e;const r=t.x,n=t.y;let s,o=-1/0;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){const t=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=r&&t>o){if(o=t,t===r){if(n===i.y)return i;if(n===i.next.y)return i.next}s=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!s)return null;if(r===o)return s.prev;const a=s,c=s.x,u=s.y;let l,h=1/0;for(i=s.next;i!==a;)r>=i.x&&i.x>=c&&r!==i.x&&S(n<u?r:o,n,c,u,n<u?o:r,n,i.x,i.y)&&(l=Math.abs(n-i.y)/(r-i.x),(l<h||l===h&&i.x>s.x)&&P(i,t)&&(s=i,h=l)),i=i.next;return s}function g(t,e,i,r){let n;for(;n!==t;n=n.next){if(n=n||t,null===n.z&&(n.z=z(n.x,n.y,e,i,r)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,g(t,e,i,r);n.prevZ=n.prev,n.nextZ=n.next}return t.prevZ.nextZ=null,t.prevZ=null,v(t)}function v(t){let e,i=1;for(;;){let r,n=t;t=null,e=null;let s=0;for(;n;){s++,r=n;let o=0;for(;o<i&&r;o++)r=r.nextZ;let a=i;for(;o>0||a>0&&r;){let i;0===o?(i=r,r=r.nextZ,a--):0!==a&&r?n.z<=r.z?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,o--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}n=r}if(e.nextZ=null,i*=2,s<2)return t}}function w(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e,i,r){return!!(E(t,e)&&E(i,r)||E(t,r)&&E(i,e))||w(t,e,i)>0!=w(t,e,r)>0&&w(i,r,t)>0!=w(i,r,e)>0}function k(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&b(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function T(t,e,i,r,n,s){let o=0;for(let a=r,c=n-s;a<n;a+=s)o+=(t[c+e*s]-t[a+e*s])*(t[a+1+e*s]+t[c+1+e*s]),c=a;return o}function S(t,e,i,r,n,s,o,a){return(n-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(n-o)*(r-a)>=0}function P(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function z(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function E(t,e){return t.x===e.x&&t.y===e.y}function M(t,e){return t.x-e.x}function L(t,e,i,r){let n=t;do{const s=n.prev,o=n.next.next;!E(s,o)&&b(s,n,n.next,o)&&P(s,o)&&P(o,s)&&(e.push(s.index/i+r),e.push(n.index/i+r),e.push(o.index/i+r),x(n),x(n.next),n=t=o),n=n.next}while(n!==t);return n}function N(t,e,i,r,n,s,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&R(a,t)){let c=B(a,t);return a=u(a,a.next),c=u(c,c.next),l(a,e,i,r,n,s,o,0),void l(c,e,i,r,n,s,o,0)}t=t.next}a=a.next}while(a!==t)}function R(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!k(t,e)&&P(t,e)&&P(e,t)&&I(t,e)}function I(t,e){let i=t,r=!1;const n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}function B(t,e){const i=A.create(t.index,t.x,t.y),r=A.create(e.index,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}class A{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,i){const r=O<D.length?D[O++]:new A;return r.index=t,r.x=e,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const D=[],Y=8096;let O=0;for(let J=0;J<Y;J++)D.push(new A);const F=1e-5,G=new n.O3(0,0,0,1,0),C=new n.O3(0,0,0,1,0);function V(t,e,i){let r=0;for(let n=1;n<i;n++){const i=t[2*(e+n-1)],s=t[2*(e+n-1)+1];r+=(t[2*(e+n)]-i)*(t[2*(e+n)+1]+s)}return r}function U(t,e,i,r,n){let s=0;const o=2;for(let a=i;a<r;a+=3){const i=(t[a]-n)*o,r=(t[a+1]-n)*o,c=(t[a+2]-n)*o;s+=Math.abs((e[i]-e[c])*(e[r+1]-e[i+1])-(e[i]-e[r])*(e[c+1]-e[i+1]))}return s}function W(t,e){const{coords:i,lengths:r,hasIndeterminateRingOrder:n}=e,s=0,o=t;if(n)return!1;let c=0;for(let u=0;u<r.length;){let t=u,e=r[u],n=V(i,c,e);const l=[];for(;++t<r.length;){const s=r[t],o=V(i,c+e,s);if(!(o>0))break;n+=o,l.push(c+e),e+=s}const h=o.length;a(o,i,c,c+e,l,2,s);const p=U(o,i,h,o.length,s),f=Math.abs(n);if(Math.abs((p-f)/Math.max(1e-7,f))>F)return o.length=0,!1;u=t,c+=e}return!0}function X(t){const{coords:e,lengths:i}=t,{buffer:n}=(0,r.l)(e,i);return n}function H(t,e,i){let r=0;for(let n=0;n<t.lengths.length;n++){const s=t.lengths[n];for(let n=0;n<s;n++){const s=t.coords[2*(n+r)],o=t.coords[2*(n+r)+1];if(s<e||s>i||o<e||o>i)return!0}r+=s}return!1}function q(t,e){if(null==t)return null;if(!H(t,-128,o.CQ+128))return t;G.setPixelMargin(e),G.reset(n.dC.Polygon);let i=0;for(let n=0;n<t.lengths.length;n++){const e=t.lengths[n];let r=t.coords[2*(0+i)],s=t.coords[2*(0+i)+1];G.moveTo(r,s);for(let n=1;n<e;n++)r=t.coords[2*(n+i)],s=t.coords[2*(n+i)+1],G.lineTo(r,s);G.close(),i+=e}const r=G.result(!1);if(!r)return null;const a=[],c=[];for(const n of r){let t=0;for(const e of n)c.push(e.x),c.push(e.y),t++;a.push(t)}return new s.A(a,c)}function Z(t,e){C.setPixelMargin(e);const i=C,r=-e,s=o.CQ+e;let a=[],c=!1;if(!t.nextPath())return null;let u=!0;for(;u;){t.seekPathStart();const e=[];if(!t.pathSize)return null;i.reset(n.dC.LineString),t.nextPoint();let o=t.x,l=t.y;if(c)i.moveTo(o,l);else{if(o<r||o>s||l<r||l>s){c=!0;continue}e.push({x:o,y:l})}let h=!1;for(;t.nextPoint();)if(o=t.x,l=t.y,c)i.lineTo(o,l);else{if(o<r||o>s||l<r||l>s){h=!0;break}e.push({x:o,y:l})}if(h)c=!0;else{if(c){const t=i.resultWithStarts();if(t)for(const e of t)a.push(e)}else a.push({line:e,start:0});u=t.nextPath(),c=!1}}return a=a.filter((t=>t.line.length>1)),0===a.length?null:a}G.setExtent(o.CQ),C.setExtent(o.CQ)},5600:function(t,e,i){i.d(e,{k:function(){return o}});var r=i(35583),n=i(79721);const s={createComputedParams:t=>t,optionalAttributes:{},attributes:{id:{type:n.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:n.pe.UNSIGNED_BYTE,count:1},pos:{type:n.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:n.pe.FLOAT,count:1,packTessellation:({inverseArea:t})=>t}}};class o extends r.N{constructor(){super(...arguments),this.vertexSpec=s}createTesselationParams(t){return{inverseArea:1/t.readGeometryArea()}}}},35583:function(t,e,i){i.d(e,{N:function(){return u}});var r=i(9302),n=i(65596),s=i(88695),o=i(899);const a=100,c=(0,r.A)("featurelayer-fast-triangulation-enabled");class u extends o.r{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,n.F)()])}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);n&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,n),t.recordEnd())}_clip(t){if(!t)return null;const e=this.hasEffects;return(0,s.FE)(t,e?256:8)}_writeGeometry(t,e,i){const r=i.maxLength>a,n=[],o=this.createTesselationParams(e);if(!r&&c&&(0,s.lO)(n,i))return void(n.length&&this._writeVertices(t,e,i.coords,o,n));const u=(0,s.XZ)(i);this._writeVertices(t,e,u,o)}_writeVertices(t,e,i,r,n){const s=e.getDisplayId(),o=t.vertexCount(),a=this.hasEffects;let c=0;if(n)for(const u of n){const e=i[2*u],n=i[2*u+1];a&&t.recordBounds(e,n,0,0),this._writeVertex(t,s,e,n,r),c++}else for(let u=0;u<i.length;u+=2){const e=Math.round(i[u]),n=Math.round(i[u+1]);a&&t.recordBounds(e,n,0,0),this._writeVertex(t,s,e,n,r),c++}t.indexEnsureSize(c);for(let u=0;u<c;u++)t.indexWrite(u+o)}}},4740:function(t,e,i){i.d(e,{KE:function(){return p},KI:function(){return l},lB:function(){return h},oI:function(){return u}});var r=i(22443),n=i(38817),s=i(36504),o=i(1626),a=i(72937),c=i(79721);function u(t){const{sprite:e,aspectRatio:i,scaleProportionally:n}=t,s=(0,r.Lz)(t.height),o=s>0?s:e.height;let a=s*i;return a<=0?a=e.width:n&&(a*=e.width/e.height),{width:a,height:o}}function l(t){const{applyRandomOffset:e,sampleAlphaOnly:i}=t;return(0,s.xo)([[a.Fz,e],[a.cn,i]])}const h={createComputedParams:t=>t,optionalAttributes:o.l.optionalAttributes,attributes:{...o.l.attributes,bitset:{count:1,type:c.pe.UNSIGNED_BYTE,pack:l},width:{count:1,type:c.pe.HALF_FLOAT,pack:t=>u(t).width},height:{count:1,type:c.pe.HALF_FLOAT,pack:t=>u(t).height},offset:{count:2,type:c.pe.HALF_FLOAT,pack:({offsetX:t,offsetY:e})=>[(0,r.Lz)(t),-(0,r.Lz)(e)]},scale:{count:2,type:c.pe.UNSIGNED_BYTE,packPrecisionFactor:16,pack:({scaleX:t,scaleY:e})=>[t,e]},angle:{count:1,type:c.pe.UNSIGNED_BYTE,pack:({angle:t})=>(0,n.wV)(t)}}};class p extends o.m{constructor(){super(...arguments),this.vertexSpec=h}}},22426:function(t,e,i){i.d(e,{O:function(){return y}});var r=i(22443),n=i(95719),s=i(4740),o=i(36504),a=i(48062),c=i(5572),u=i(72937),l=i(79721);const h=s.lB,p=a.e4,f={createComputedParams:t=>t,optionalAttributes:h.optionalAttributes,attributes:{...h.attributes,bitset:{type:l.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,s.KI)(t)},aux1:{count:1,type:l.pe.HALF_FLOAT,pack:t=>(0,s.oI)(t).width},aux2:{count:1,type:l.pe.HALF_FLOAT,pack:t=>(0,s.oI)(t).height},aux3:{count:2,type:l.pe.HALF_FLOAT,pack:({offsetX:t,offsetY:e})=>[(0,r.Lz)(t),(0,r.Lz)(e)]},aux4:{count:2,type:l.pe.UNSIGNED_BYTE,pack:({scaleX:t,scaleY:e})=>[t*c.cZ,e*c.cZ]}}},x={createComputedParams:t=>t,optionalAttributes:h.optionalAttributes,attributes:{...h.attributes,color:p.attributes.color,bitset:{type:l.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,o.xo)([[u.Xx,!0]])},aux1:{count:1,type:l.pe.HALF_FLOAT,pack:t=>(0,r.Lz)(.5*t.width)},aux2:{count:1,type:l.pe.HALF_FLOAT,pack:t=>(0,r.Lz)(.5*t.referenceWidth)},aux3:{count:2,type:l.pe.HALF_FLOAT,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[t,e]},aux4:{count:2,type:l.pe.UNSIGNED_BYTE,packTessellation:({normalX:t,normalY:e})=>[t*c.cZ+c.v9,e*c.cZ+c.v9]}}};class d extends a.eY{constructor(){super(...arguments),this.vertexSpec=x}}class y extends a.w0{constructor(){super(...arguments),this.vertexSpec=f}_createOutlineWriter(t,e,i,r){return new d(t,e,i,r)}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(r);if(!s)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,s),this._lineMeshWriter.writeLineVertices(t,n.z.fromOptimizedCIM(s,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},48432:function(t,e,i){i.d(e,{Y:function(){return c},v:function(){return a}});var r=i(42655),n=i(35583),s=i(36504),o=i(79721);const a={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:o.pe.SHORT,count:2,packPrecisionFactor:r.fq,pack:({scaleInfo:t},{tileInfo:e})=>(0,s.My)(t,e)}},attributes:{id:{type:o.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.pe.UNSIGNED_BYTE,count:1},pos:{type:o.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},color:{type:o.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,s.Jb)(t)}}};class c extends n.N{constructor(){super(...arguments),this.vertexSpec=a}createTesselationParams(t){return null}}},48062:function(t,e,i){i.d(e,{Lm:function(){return h},e4:function(){return p},eY:function(){return f},w0:function(){return x}});var r=i(95719),n=i(88695),s=i(48432),o=i(36504),a=i(28850),c=i(32550),u=i(72937),l=i(79721);const h={createComputedParams:t=>t,optionalAttributes:a.Eq.optionalAttributes,attributes:{...a.Eq.attributes,bitset:{type:l.pe.UNSIGNED_BYTE,count:1,pack:t=>0},color:{type:l.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,o.Jb)(t)}}},p={createComputedParams:t=>t,optionalAttributes:a.Eq.optionalAttributes,attributes:{...a.Eq.attributes,bitset:{type:l.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,o.xo)([[u.Xx,!0]])},color:{type:l.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>(0,o.Jb)(t)}}};class f extends a.Bw{constructor(){super(...arguments),this.vertexSpec=p}}class x extends s.Y{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=h,this._lineMeshWriter=this._createOutlineWriter(t,e,i,r)}_createOutlineWriter(t,e,i,r){return new f(t,e,i,r)}_write(t,e,i){const n=i?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(n);s&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,s),this._lineMeshWriter.writeLineVertices(t,r.z.fromOptimizedCIM(s,"esriGeometryPolyline"),e),t.recordEnd())}_clip(t){return t?(0,n.FE)(t,(0,c.Z0)(this.evaluatedMeshParams)):null}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},1626:function(t,e,i){i.d(e,{l:function(){return o},m:function(){return a}});var r=i(42655),n=i(48432),s=i(79721);const o={createComputedParams:t=>t,optionalAttributes:n.v.optionalAttributes,attributes:{...n.v.attributes,tlbr:{count:4,type:s.pe.UNSIGNED_SHORT,pack:({sprite:t})=>{const{rect:e,width:i,height:n}=t,s=e.x+r.hM,o=e.y+r.hM;return[s,o,s+i,o+n]}},inverseRasterizationScale:{count:1,type:s.pe.BYTE,packPrecisionFactor:16,pack:({sprite:t})=>1/t.rasterizationScale}}};class a extends n.Y{constructor(){super(...arguments),this.vertexSpec=o}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);if(!n)return;const s=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,s),this._writeGeometry(t,e,n),t.recordEnd()}}},78892:function(t,e,i){i.d(e,{Q:function(){return u}});var r=i(95719),n=i(48062),s=i(1626);const o={optionalAttributes:s.l.optionalAttributes,createComputedParams:t=>t,attributes:{...s.l.attributes,...n.Lm.attributes}},a={optionalAttributes:s.l.optionalAttributes,createComputedParams:t=>t,attributes:{...s.l.attributes,...n.e4.attributes}};class c extends n.eY{constructor(){super(...arguments),this.vertexSpec=a}}class u extends n.w0{constructor(){super(...arguments),this.vertexSpec=o}_createOutlineWriter(t,e,i,r){return new c(t,e,i,r)}_write(t,e,i){const n=i?.asOptimized()??e.readGeometryForDisplay(),s=this._clip(n);if(!s)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,s),this._lineMeshWriter.writeLineVertices(t,r.z.fromOptimizedCIM(s,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},36504:function(t,e,i){i.d(e,{By:function(){return m},Jb:function(){return f},My:function(){return l},i8:function(){return y},mR:function(){return h},qE:function(){return d},ue:function(){return x},xo:function(){return p}});var r=i(68347),n=i(18244),s=i(8660),o=i(18352);const a=()=>s.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils"),c=0,u=100;function l(t,e){return[!!t?.minScale&&e.scaleToZoom(t.minScale)||c,!!t?.maxScale&&e.scaleToZoom(t.maxScale)||u]}function h(t){return 1<<t}function p(t){let e=0;for(const[i,r]of t)r&&(e|=1<<i);return e}function f(t){let e;if(!t)return[0,0,0,0];if("string"==typeof t){const i=r.A.fromString(t);if(!i)return a().errorOnce(new n.A("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];e=i.toArray()}else e=t;const[i,s,o,c]=e;return[i*(c/255),s*(c/255),o*(c/255),c]}function x(t){switch(t){case"butt":case o.uT.Butt:return o.xR.BUTT;case"round":case o.uT.Round:return o.xR.ROUND;case"square":case o.uT.Square:return o.xR.SQUARE}}function d(t){switch(t){case"bevel":case o.wd.Bevel:return o.JO.BEVEL;case"miter":case o.wd.Miter:return o.JO.MITER;case"round":case o.wd.Round:return o.JO.ROUND}}function y(t,e){return Math.round(Math.min(Math.sqrt(t*e),255))}function m(t,e){return Math.round(t*e)/e}},17848:function(t,e,i){i.d(e,{h:function(){return o}});var r=i(899),n=i(79721);const s={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:n.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:n.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:n.pe.UNSIGNED_BYTE,count:1},offset:{type:n.pe.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};class o extends r.r{constructor(){super(...arguments),this.vertexSpec=s}_write(t,e){t.recordStart(this.instanceId,this.attributeLayout);const i=e.getDisplayId();if("esriGeometryPoint"===e.geometryType){const r=e.readXForDisplay(),n=e.readYForDisplay();this._writeQuad(t,i,r,n)}else if("esriGeometryMultipoint"===e.geometryType){const r=e.readGeometryForDisplay();r?.forEachVertex(((e,r)=>{e>=0&&e<=512&&r>=0&&r<=512&&this._writeQuad(t,i,e,r)}))}t.recordEnd()}_writeQuad(t,e,i,r){const n=t.vertexCount();this._writeVertex(t,e,i,r),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}},28850:function(t,e,i){i.d(e,{Bw:function(){return y},Eq:function(){return f}});var r=i(22443),n=i(95719),s=i(42655),o=i(59235),a=i(88695),c=i(36504),u=i(899),l=i(32550),h=i(79721);class p{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const f={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:h.pe.SHORT,count:2,packPrecisionFactor:s.fq,pack:({scaleInfo:t},{tileInfo:e})=>(0,c.My)(t,e)}},attributes:{id:{type:h.pe.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:h.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:h.pe.UNSIGNED_BYTE,count:1},color:{type:h.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,c.Jb)(t)},offset:{type:h.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[(0,c.By)(t,16),(0,c.By)(e,16)]},normal:{type:h.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({normalX:t,normalY:e})=>[(0,c.By)(t,16),(0,c.By)(e,16)]},halfWidth:{type:h.pe.HALF_FLOAT,count:1,pack:({width:t})=>(0,r.Lz)(.5*t)},referenceHalfWidth:{type:h.pe.HALF_FLOAT,count:1,pack:({referenceWidth:t})=>(0,r.Lz)(.5*t)}}};class x{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}const d=65535;class y extends u.r{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=f,this._currentWrite=new x,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:d,textured:!1},this._tessParams=new p,this._initializeTessellator()}writeLineVertices(t,e,i){const r=this._getLines(e);null!=r&&this._writeVertices(t,i,r)}_initializeTessellator(){this._lineTessellator=new o.i(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(t,e,i){const r=i??n.z.fromFeatureSetReaderCIM(e);r&&this._writeGeometry(t,e,r)}_writeGeometry(t,e,i,r){t.recordStart(this.instanceId,this.attributeLayout,r),this.writeLineVertices(t,i,e),t.recordEnd()}_getLines(t){return(0,a.uS)(t,(0,l.Z0)(this.evaluatedMeshParams))}_writeVertices(t,e,i){const{_currentWrite:n,_tessellationOptions:o,evaluatedMeshParams:a}=this,{width:u,capType:l,joinType:h,miterLimit:p,hasSizeVV:f}=a,x=(0,r.Lz)(.5*u);o.halfWidth=x,o.capType=(0,c.ue)(l),o.joinType=(0,c.qE)(h),o.miterLimit=p;const y=!f;n.out=t,n.id=e.getDisplayId(),n.vertexCount=0,n.indexCount=0,n.vertexFrom=t.vertexCount(),n.vertexBounds=y&&x<s.Gh?0:1;for(const{line:r,start:s}of i)o.initialDistance=s%d,this._lineTessellator.tessellate(r,o,y)}_writeTesselatedVertex(t,e,i,r,n,s,o,a,c,u,l){const{out:h,id:p,vertexBounds:f}=this._currentWrite;return this.hasEffects&&h.recordBounds(t,e,f,f),this._tessParams.extrusionOffsetX=o,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=u,this._tessParams.directionX=n,this._tessParams.directionY=s,this._tessParams.distance=l,this._writeVertex(h,p,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,i){const{out:r}=this._currentWrite;r.indexEnsureSize(3),r.indexWrite(t),r.indexWrite(e),r.indexWrite(i),this._currentWrite.indexCount+=3}}},13695:function(t,e,i){i.d(e,{K:function(){return l}});var r=i(95719),n=i(42655),s=i(36504),o=i(28850),a=i(72937),c=i(79721);const u={createComputedParams:t=>t,optionalAttributes:o.Eq.optionalAttributes,attributes:{...o.Eq.attributes,bitset:{type:c.pe.UNSIGNED_BYTE,count:1,pack:({shouldSampleAlphaOnly:t,shouldScaleDash:e,isSDF:i})=>(0,s.xo)([[a.cn,t],[a.kx,e],[a.b5,i]])},tlbr:{type:c.pe.UNSIGNED_SHORT,count:4,pack:({sprite:t})=>{const{rect:e,width:i,height:r}=t,s=e.x+n.hM,o=e.y+n.hM;return[s,o,s+i,o+r]}},accumulatedDistance:{type:c.pe.UNSIGNED_SHORT,count:1,packTessellation:({distance:t})=>t},segmentDirection:{type:c.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:t,directionY:e})=>[t,e]}}};class l extends o.Bw{constructor(t,e,i,r){super(t,e,i,r),this.vertexSpec=u,this._tessellationOptions.textured=!0}_write(t,e,i){const n=i??r.z.fromFeatureSetReaderCIM(e);if(!n)return;const{sprite:s}=this.evaluatedMeshParams;this._writeGeometry(t,e,n,s?.textureBinding)}}},39853:function(t,e,i){i.d(e,{H:function(){return S}});var r=i(22443),n=i(32783),s=i(16046),o=i(24667),a=i(95719),c=i(27435),u=i(18352),l=i(12539),h=i(42655),p=i(36504),f=i(80139);class x{static from(t){return"width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(t){const e=new x(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects),{type:i,width:n,height:s,angle:o,alignment:a,outlineSize:c,referenceSize:u,sprite:l,overrideOutlineColor:h}=t;e.rawWidth=(0,r.Lz)(n),e.rawHeight=(0,r.Lz)(s),e.angle=o,e.alignment=a,e.outlineSize=(0,r.Lz)(c),e.referenceSize=(0,r.Lz)(u),e.overrideOutlineColor=h,e.offsetX=(0,r.Lz)(t.offsetX),e.offsetY=(0,r.Lz)(t.offsetY),"simple"!==i||l.sdf||(e.rawWidth=l.width,e.rawHeight=l.height);const p=2;return e.sizeRatio=l.sdf?p:1,e._computeSize(t,!1),e}static fromComplexMeshParams(t){const e=new x(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects);let{alignment:i,transforms:n,size:s,scaleX:o,anchorX:a,anchorY:c,angle:u,colorLocked:l,frameHeight:h,widthRatio:p,offsetX:d,offsetY:y,outlineSize:m,referenceSize:_,scaleFactor:g,sizeRatio:v,isAbsoluteAnchorPoint:w,rotateClockwise:b,scaleSymbolsProportionally:k,sprite:T}=t;if(n&&n.infos.length>0){const t=(0,f.zb)(s,u,b,d,y,n);s=t.size,u=t.rotation,d=t.offsetX,y=t.offsetY,b=!1}g&&(s*=g,d*=g,y*=g);const S=o*(T.width/T.height);e.alignment=i,e.rawHeight=(0,r.Lz)(s),e.rawWidth=e.rawHeight*S,e.referenceSize=(0,r.Lz)(_),e.sizeRatio=v,e.angle=u,e.rotateClockwise=b,e.anchorX=a,e.anchorY=c,e.offsetX=(0,r.Lz)(d),e.offsetY=(0,r.Lz)(y),w&&s&&(T.sdf?e.anchorX=a/(s*p):e.anchorX=a/(s*S),e.anchorY=c/s);const P=k&&h?s/h:1;return e.outlineSize=0===m||isNaN(m)?0:(0,r.Lz)(m)*P,e.scaleSymbolsProportionally=k,e.colorLocked=l,e._computeSize(t,!0),e}constructor(t,e,i,r,n,s,o){this.sprite=t,this.color=e,this.outlineColor=i,this.minPixelBuffer=r,this.placement=n,this.scaleInfo=s,this.effects=o,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=u.C1.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){const{sprite:i,hasSizeVV:r}=t,n=!!i.sdf,{rawWidth:s,rawHeight:o,sizeRatio:a,outlineSize:c}=this,u=s*a,l=o*a;if(n&&!r){const t=e&&s>o?u:s,i=o,r=c+2;this.computedWidth=Math.min(t+r,u),this.computedHeight=Math.min(i+r,l)}else this.computedWidth=u,this.computedHeight=l;const p=n?Math.max(i.width,i.height)/Math.max(u,l):1,f=.5*(u-this.computedWidth)*p,x=.5*(l-this.computedHeight)*p,d=i.rect.x+h.hM+f,y=i.rect.y+h.hM+x,m=d+i.width-2*f,_=y+i.height-2*x;this.texXmin=Math.floor(d),this.texYmin=Math.floor(y),this.texXmax=Math.ceil(m),this.texYmax=Math.ceil(_),this.computedWidth*=(this.texXmax-this.texXmin)/(m-d),this.computedHeight*=(this.texYmax-this.texYmin)/(_-y),this.anchorX*=u/this.computedWidth,this.anchorY*=l/this.computedHeight}}var d=i(81578),y=i(21753),m=i(899),_=i(79721);const g=3.14159265359/180,v=128/Math.PI;function w(t,e){return t%=e,Math.abs(t>=0?t:t+e)}function b(t){return w(t*v,256)}function k(t,e,i,r,o=!1){const a=(0,s.vt)(),c=o?1:-1;return(0,n.D_)(a),(e||i)&&(0,n.Tl)(a,a,[e,-i]),r&&(0,n.e$)(a,a,c*g*-r),a}const T={createComputedParams:t=>x.from(t),optionalAttributes:{zoomRange:{type:_.pe.SHORT,count:2,packPrecisionFactor:h.fq,pack:({scaleInfo:t},{tileInfo:e})=>(0,p.My)(t,e)}},attributes:{pos:{type:_.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:_.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:_.pe.UNSIGNED_BYTE,count:1,pack:({sprite:t,alignment:e,scaleSymbolsProportionally:i,overrideOutlineColor:r,colorLocked:n})=>{let s=0;return t.sdf&&(s|=(0,p.mR)(d.c.bitset.isSDF)),e===u.C1.MAP&&(s|=(0,p.mR)(d.c.bitset.isMapAligned)),i&&(s|=(0,p.mR)(d.c.bitset.scaleSymbolsProportionally)),r&&(s|=(0,p.mR)(d.c.bitset.overrideOutlineColor)),n&&(s|=(0,p.mR)(d.c.bitset.colorLocked)),s}},offset:{type:_.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({angle:t,computedWidth:e,computedHeight:i,anchorX:r,anchorY:n,offsetX:s,offsetY:a,rotateClockwise:c})=>{const u=k(0,s,a,-t,c),l=-(.5+r)*e,h=-(.5-n)*i,p=[l,h],f=[l+e,h],x=[l,h+i],d=[l+e,h+i];return(0,o.l0)(p,p,u),(0,o.l0)(f,f,u),(0,o.l0)(x,x,u),(0,o.l0)(d,d,u),[p,f,x,d]}}},textureUV:{type:_.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({texXmax:t,texXmin:e,texYmax:i,texYmin:r})=>[[e,r],[t,r],[e,i],[t,i]]}},color:{type:_.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,p.Jb)(t)},outlineColor:{type:_.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>(0,p.Jb)(t)},sizing:{type:_.pe.UNSIGNED_BYTE,count:4,pack:({rawWidth:t,rawHeight:e,outlineSize:i,referenceSize:r})=>{const n=Math.max(t,e);return[(0,p.i8)(n,128),(0,p.i8)(i,128),(0,p.i8)(r,128),0]}},placementAngle:{type:_.pe.UNSIGNED_BYTE,count:1,packTessellation:({placementAngle:t})=>b(t)},sizeRatio:{type:_.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:({sizeRatio:t})=>t}}};class S extends m.r{constructor(){super(...arguments),this.vertexSpec=T}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(t,e,i){const r=this.evaluatedMeshParams.sprite?.textureBinding,n=e.getDisplayId();t.recordStart(this.instanceId,this.attributeLayout,r);const s=this.evaluatedMeshParams.minPixelBuffer,o=Math.max(this.evaluatedMeshParams.computedWidth,s),a=Math.max(this.evaluatedMeshParams.computedHeight,s),u=this.evaluatedMeshParams.offsetX,l=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(t,e,i,o,a);else if(i?.nextPath()){i.nextPoint();const e=i.x,r=i.y;t.recordBounds(e+u,r+l,o,a),this._writeQuad(t,n,e,r)}else if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[r,s]=i.coords;t.recordBounds(r+u,s+l,o,a),this._writeQuad(t,n,r,s)}else if("esriGeometryPoint"===e.geometryType){const i=e.readXForDisplay(),r=e.readYForDisplay();t.recordBounds(i+u,r+l,o,a),this._writeQuad(t,n,i,r)}else{const i=e.readGeometryForDisplay();i?.forEachVertex(((e,i)=>{t.recordBounds(e+u,i+l,o,a),Math.abs(e)>c.s||Math.abs(i)>c.s||this._writeQuad(t,n,e,i)}))}t.recordEnd()}_writePlacedMarkers(t,e,i,n,s){const o=i??a.z.fromFeatureSetReaderCIM(e)?.clone();if(!o)return;const u=-1,h=l.l.getPlacement(o,u,this.evaluatedMeshParams.placement,(0,r.Lz)(1),t.id,(0,y.z)());if(!h)return;const p=e.getDisplayId();let f=h.next();const x=this.evaluatedMeshParams.offsetX,d=-this.evaluatedMeshParams.offsetY;for(;null!=f;){const e=f.tx,i=-f.ty;if(Math.abs(e)>c.s||Math.abs(i)>c.s){f=h.next();continue}const r=-f.getAngle();t.recordBounds(e+x,i+d,n,s),this._writeQuad(t,p,e,i,r),f=h.next()}}_writeQuad(t,e,i,r,n){const s=t.vertexCount(),o=null==n?null:{placementAngle:n};this._writeVertex(t,e,i,r,o),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}}},899:function(t,e,i){i.d(e,{r:function(){return d}});var r=i(95719),n=i(78425),s=i(21753),o=(i(16573),i(78100),i(77936),i(37467),i(44732),i(79577),i(53420)),a=(i(44114),i(9302),i(32550)),c=i(79721);function u(t){switch(t){case c.pe.BYTE:case c.pe.UNSIGNED_BYTE:return 1;case c.pe.SHORT:case c.pe.UNSIGNED_SHORT:case c.pe.HALF_FLOAT:return 2;case c.pe.FLOAT:case c.pe.INT:case c.pe.UNSIGNED_INT:return 4}}function l(t){const e=[],i=[],r=[];for(const n of t){const t=u(n.type)*n.count;switch(t%2||t%4||4){case 4:e.push(n);continue;case 2:i.push(n);continue;case 1:r.push(n);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...i),e.push(...r),e}class h{static fromVertexSpec(t,e){const{attributes:i,optionalAttributes:r}=t;let n,s,o;const a=[];for(const u in i){const t=i[u];"position"===t.pack?n={...t,name:u,offset:0}:"id"===t.pack?s={...t,name:u,offset:4}:"bitset"===u?o={...t,name:u,offset:7}:a.push({...t,name:u})}for(const u in r)if(!0===e[u]){const t=r[u];a.push({...t,name:u})}const c=l(a),p=[];let f=8,x=1;for(const l of c)p.push({...l,offset:f}),f+=u(l.type)*l.count,l.packAlternating&&(x=Math.max(l.packAlternating.count,x));const d=Uint32Array.BYTES_PER_ELEMENT,y=f%d;return new h(n,s,o,p,f+(y?d-y:0),x)}constructor(t,e,i,r,n,s){this.position=t,this.id=e,this.bitset=i,this.standardAttributes=r,this.stride=n,this.packVertexCount=s,r.push(i),this._attributes=[t,e,i,...r]}get attributeLayout(){if(!this._attributeLayout){const t=(0,a.hU)(this._attributes),e=this._attributes.map((t=>({name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:t.normalized??!1})));this._attributeLayout={attributes:e,hash:t,stride:this.stride}}return this._attributeLayout}}var p=i(35349);class f{static fromVertexSpec(t,e){const i=h.fromVertexSpec(t,e);return new f(i)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,i,r,n,s){for(let o=0;o<this._spec.packVertexCount;o++){const t=o*this._spec.stride;this._packPosition(i,r,t),this._packId(e,t);const a=this._spec.bitset;if(s){if(a.packTessellation){const e=a.packTessellation(s,n);this._pack(e,a,t)}for(const e of this._spec.standardAttributes)if(null!=e.packTessellation){const i=e.packTessellation(s,n);this._pack(i,e,t)}else if(e.packAlternating?.packTessellation){const t=e.packAlternating.packTessellation(s,n);for(let i=0;i<this._spec.packVertexCount;i++){const r=t[i];this._pack(r,e,i*this._spec.stride)}}}}t.vertexWriteRegion(this._packedU32View)}pack(t,e){for(const i of this._spec.standardAttributes)if(i.pack&&"string"!=typeof i.pack){const r=i.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(r,i,t*this._spec.stride)}else if(i.packAlternating?.pack){const r=i.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=r[t];this._pack(e,i,t*this._spec.stride)}}}_packPosition(t,e,i){const{offset:r}=this._spec.position,n=this._spec.position.packPrecisionFactor??1,s=(0,o.M9)(t*n,e*n);this._dataView.setUint32(i+r,s,!0)}_packId(t,e){const i=t*(this._spec.id.packPrecisionFactor??1),r=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,i|r,!0)}_pack(t,e,i){(0,p.F)(this._dataView,t,e,i)}}function x(t){if(!t)return!1;for(const e of t)switch(e.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1}class d{constructor(t,e,i,r){this._instanceId=t,this._evaluator=e,this._enabledOptionalAttributes=i,this._viewParams=r,this._evaluator.evaluator=t=>this.vertexSpec.createComputedParams(t)}get _vertexPack(){if(!this._cachedVertexPack){const t=f.fromVertexSpec(this.vertexSpec,this._enabledOptionalAttributes);this._evaluator.hasDynamicProperties||t.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=t}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(t){this._references=t}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){x(this._evaluator.inputMeshParams.effects?.effectInfos)&&await(0,s.R)()}enqueueRequest(t,e,i){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(t,e,i)}write(t,e,i,o,a){this.ensurePacked(e,i,o);const c=this.evaluatedMeshParams.effects;if(!c||0===c.length)return void this._write(t,i,void 0,a);const u=i.readGeometryForDisplay()?.clone();if(!u)return;const l=r.z.fromOptimizedCIM(u,i.geometryType),h=(0,s.z)();l.invertY();const p=t.id||"",f=n.V.executeEffects(c,l,p,h);let x;for(;x=f.next();)x.invertY(),this._write(t,i,x,a)}ensurePacked(t,e,i){if(!this._evaluator.hasDynamicProperties)return;const r=this._evaluator.evaluateMeshParams(t,e,i);this._vertexPack.pack(r,this._viewParams)}_writeVertex(t,e,i,r,n){const s=this.evaluatedMeshParams;this._vertexPack.writeVertex(t,e,i,r,s,n)}}},21753:function(t,e,i){i.d(e,{R:function(){return s},z:function(){return n}});let r=null;function n(){return r}async function s(){r=await i.e(5130).then(i.bind(i,42749))}},35478:function(t,e,i){i.d(e,{v:function(){return c}});var r=i(22443),n=i(36504),s=i(899),o=i(79721);const a={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:o.pe.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:o.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.pe.UNSIGNED_BYTE,count:1,pack:t=>0},offset:{type:o.pe.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:({size:t})=>{const e=(0,r.Lz)(t),i=-e/2,n=-e/2;return[[i,n],[i+e,n],[i,n+e],[i+e,n+e]]}}},texCoords:{type:o.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:o.pe.UNSIGNED_BYTE,count:2,pack:({size:t})=>[t,t]},referenceSize:{type:o.pe.UNSIGNED_BYTE,count:1,pack:({size:t})=>(0,r.Lz)(t)},zoomRange:{type:o.pe.UNSIGNED_BYTE,count:2,pack:({scaleInfo:t},{tileInfo:e})=>(0,n.My)(t,e)}}};class c extends s.r{constructor(){super(...arguments),this.vertexSpec=a}_write(t,e){const i=e.getDisplayId(),n=this.evaluatedMeshParams.minPixelBuffer,s=Math.max((0,r.Lz)(this.evaluatedMeshParams.size),n);let o,a;if("esriGeometryPoint"===e.geometryType)o=e.readXForDisplay(),a=e.readYForDisplay();else{const t=e.readCentroidForDisplay();if(!t)return;o=t?.coords[0],a=t?.coords[1]}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(o,a,s,s);const c=t.vertexCount();this._writeVertex(t,i,o,a),t.indexWrite(c+0),t.indexWrite(c+1),t.indexWrite(c+2),t.indexWrite(c+1),t.indexWrite(c+3),t.indexWrite(c+2),t.recordEnd()}}},91934:function(t,e,i){i.d(e,{G8:function(){return N},GJ:function(){return _}});var r=i(27165),n=i(22443),s=i(95719),o=i(12539),a=i(60815),c=i(42655),u=i(35760),l=i(36504),h=i(21753),p=i(899),f=i(72937),x=i(80139);const d=96;class y{constructor(t){const{offsetX:e,offsetY:i,postAngle:r,fontSize:n,scaleFactor:s,transforms:o}=t;if(this.offsetX=e,this.offsetY=i,this.postAngle=r,this.fontSize=Math.min(n,d),this.transforms=o,o&&o.infos.length>1){const t=(0,x.zb)(n,r,!1,e,i,o);this.fontSize=Math.min(t.size,d),this.postAngle=t.rotation,this.offsetX=t.offsetX,this.offsetY=t.offsetY}s&&(this.fontSize*=s,this.offsetX*=s,this.offsetY*=s)}}var m=i(79721);const _=28,g=[4,4],v=[16,4],w={topLeft:v,topRight:v,bottomLeft:v,bottomRight:v},b=[4,2],k=[4,6],T={topLeft:b,topRight:b,bottomLeft:k,bottomRight:k},S={topLeft:b,topRight:k,bottomLeft:b,bottomRight:k},P={topLeft:k,topRight:k,bottomLeft:g,bottomRight:g},z={topLeft:g,topRight:g,bottomLeft:k,bottomRight:k},E={topLeft:k,topRight:g,bottomLeft:k,bottomRight:g},M={topLeft:g,topRight:k,bottomLeft:g,bottomRight:k},L={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:m.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:c.fq,packTessellation:({minZoom:t,maxZoom:e})=>[t||0,e||_]},clipAngle:{type:m.pe.UNSIGNED_BYTE,count:1,packTessellation:({clipAngle:t})=>R(t||0)},referenceSymbol:{type:m.pe.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,e)=>{if(!t.referenceBounds)return[0,0,0,0];const i=(0,a.iT)(e.horizontalAlignment),r=(0,a.Dy)(e.verticalAlignment),{offsetX:s,offsetY:o,size:c}=t.referenceBounds;return[(0,n.Lz)(s),-(0,n.Lz)(o),(0,n.Lz)(c),i+1<<2|r+1]}}},attributes:{pos:{type:m.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:m.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:m.pe.UNSIGNED_BYTE,count:1,packTessellation:({isBackground:t,mapAligned:e})=>(0,l.xo)([[f.bg,t],[f.ti,!!e]])},offset:{type:m.pe.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:({offsets:t})=>{const{bottomLeft:e,bottomRight:i,topLeft:r,topRight:n}=t;return[r,n,e,i]}}},textureUV:{type:m.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:({texcoords:t})=>{const{bottomLeft:e,bottomRight:i,topLeft:r,topRight:n}=t;return[r,n,e,i]}}},color:{type:m.pe.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:({color:t})=>t},fontSize:{type:m.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t})=>(0,n.Lz)(t)},referenceSize:{type:m.pe.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t},{referenceSize:e})=>(0,n.Lz)(e??t)},haloColor:{type:m.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({haloColor:t})=>(0,l.Jb)(t)},haloFontSize:{type:m.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:({haloFontSize:t})=>(0,n.Lz)(t)}}};class N extends p.r{constructor(){super(...arguments),this.vertexSpec=L,this._textMeshParamsPropsInitialized=!1}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new y(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(t,e,i){const r=this._getShaping();if(!r)return;const n=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,r,i);if(i?.nextPath())return i.nextPoint(),this._writeGlyphs(t,n,i.x,i.y,r,0);if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[s,o]=i.coords;return this._writeGlyphs(t,n,s,o,r,0)}if("esriGeometryMultipoint"===e.geometryType){const i=e.readGeometryForDisplay();return void i?.forEachVertex(((e,i)=>this._writeGlyphs(t,n,e,i,r,0)))}const s=e.readXForDisplay(),o=e.readYForDisplay();return this._writeGlyphs(t,n,s,o,r,0)}_writePlacedTextMarkers(t,e,i,r){const a=r??s.z.fromFeatureSetReaderCIM(e);if(!a)return;const c=-1,u=o.l.getPlacement(a,c,this.evaluatedMeshParams.placement,(0,n.Lz)(1),t.id,(0,h.z)());if(!u)return;const l=e.getDisplayId();let p=u.next();for(;null!=p;){const e=p.tx,r=-p.ty,n=-p.getAngle();this._writeGlyphs(t,l,e,r,i,n),p=u.next()}}_getShaping(t){const e=this._textMeshTransformProps,i=this.evaluatedMeshParams;if(!i.glyphs?.glyphs.length)return null;const s=Math.round((0,n.Lz)(e.fontSize)),o=(0,n.Lz)(e.offsetX),a=(0,n.Lz)(e.offsetY),l=(0,r.qE)((0,n.Lz)(i.lineWidth),c.GR,c.cp),h=c.DY*(0,r.qE)(i.lineHeightRatio,.25,4);return(0,u.Tl)(i.glyphs,{scale:s/c.eG,angle:e.postAngle,xOffset:o,yOffset:a,horizontalAlignment:i.horizontalAlignment,verticalAlignment:t||i.verticalAlignment,maxLineWidth:l,lineHeight:h,decoration:i.decoration,borderLineSizePx:(0,n.Lz)(i.boxBorderLineSize),hasBackground:!!i.boxBackgroundColor,useCIMAngleBehavior:i.useCIMAngleBehavior})}_writeGlyphs(t,e,i,r,s,o,a,c){const u=this.evaluatedMeshParams,h=this._textMeshTransformProps,p=h.fontSize,f=(0,n.Lz)(h.offsetX),x=(0,n.Lz)(h.offsetY),[d,y]=(0,l.My)(u.scaleInfo,this.getTileInfo());0!==o&&s.setRotation(o);const m=s.bounds,_=i+m.x+f,g=r+m.y-x,v=2*(u.minPixelBuffer?u.minPixelBuffer/p:1),w=Math.max(m.width,m.height)*v;s.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,s.glyphs[0].textureBinding),t.recordBounds(_,g,w,w),this._writeTextBox(t,e,i,r,s.textBox,a,c),t.recordEnd());for(const n of s.glyphs){t.recordStart(this.instanceId,this.attributeLayout,n.textureBinding),t.recordBounds(_,g,w,w);const{texcoords:s,offsets:o}=n;this._writeQuad(t,e,i,r,{texcoords:s,offsets:o,fontSize:p,color:(0,l.Jb)(u.color),isBackground:!1,referenceBounds:a,minZoom:d,maxZoom:y,...c}),t.recordEnd()}0!==o&&s.setRotation(-o)}_writeTextBox(t,e,i,r,n,s,o){const a=this.evaluatedMeshParams,{fontSize:c}=this._textMeshTransformProps,{boxBackgroundColor:u,boxBorderLineColor:h}=a,p={isBackground:!0,fontSize:c,referenceBounds:s,...o};u&&(this._writeQuad(t,e,i,r,{texcoords:w,offsets:n.main,color:(0,l.Jb)(u),...p}),h||(this._writeQuad(t,e,i,r,{texcoords:P,offsets:n.top,color:(0,l.Jb)(u),...p}),this._writeQuad(t,e,i,r,{texcoords:z,offsets:n.bot,color:(0,l.Jb)(u),...p}),this._writeQuad(t,e,i,r,{texcoords:E,offsets:n.left,color:(0,l.Jb)(u),...p}),this._writeQuad(t,e,i,r,{texcoords:M,offsets:n.right,color:(0,l.Jb)(u),...p}))),h&&(this._writeQuad(t,e,i,r,{texcoords:T,offsets:n.top,color:(0,l.Jb)(h),...p}),this._writeQuad(t,e,i,r,{texcoords:T,offsets:n.bot,color:(0,l.Jb)(h),...p}),this._writeQuad(t,e,i,r,{texcoords:S,offsets:n.left,color:(0,l.Jb)(h),...p}),this._writeQuad(t,e,i,r,{texcoords:S,offsets:n.right,color:(0,l.Jb)(h),...p}))}_writeQuad(t,e,i,r,n){const s=t.vertexCount();this._writeVertex(t,e,i,r,n),t.indexWrite(s+0),t.indexWrite(s+1),t.indexWrite(s+2),t.indexWrite(s+1),t.indexWrite(s+3),t.indexWrite(s+2)}}const R=t=>Math.round(t*(254/360))}}]);
//# sourceMappingURL=4908.2e96d94b.js.map
{"version":3,"file":"js/8738.73e64752.js","mappings":"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","sources":["webpack://vue-arcgis-0905/./node_modules/@arcgis/core/core/accessorSupport/originUtils.js","webpack://vue-arcgis-0905/./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","webpack://vue-arcgis-0905/./node_modules/@arcgis/core/layers/save/featureLayerUtils.js","webpack://vue-arcgis-0905/./node_modules/@arcgis/core/layers/save/utils.js","webpack://vue-arcgis-0905/./node_modules/@arcgis/core/portal/support/jsonContext.js","webpack://vue-arcgis-0905/./node_modules/@arcgis/core/webdoc/support/saveAPIKeyUtils.js","webpack://vue-arcgis-0905/./node_modules/@arcgis/core/webdoc/support/saveUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{isMultiOriginJSONMixin as r}from\"../multiOriginJSONSupportUtils.js\";function i(i){i?.writtenProperties&&i.writtenProperties.forEach((({target:i,propName:t,newOrigin:e})=>{r(i)&&e&&i.originOf(t)!==e&&i.updateOrigin(t,e)}))}export{i as updateOrigins};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{equals as e,difference as r,isSome as a}from\"../../core/arrayUtils.js\";import t from\"../../core/Error.js\";import{updateOrigins as n}from\"../../core/accessorSupport/originUtils.js\";import{save as o,createJSONContextForWrite as s,getLayerJSON as i,setCommonItemProperties as l,saveAs as c,getPortalItem as u,addItem as p,ensureLayerConfig as y,ensureItemConfig as f,createErrorMessage as m}from\"./utils.js\";import{parse as d}from\"../support/arcgisLayerUrl.js\";import{fetchFeatureService as h,getLayerModuleType as w}from\"../support/fetchService.js\";import{isLayerWithFeatureLayerSource as v}from\"../support/layerUtils.js\";import{layerLookupMap as T}from\"../support/lazyLayerLoader.js\";import{getWGS84ExtentForItem as I,removeTypeKeyword as S,typeKeyword as b,toggleTypeKeyword as A,addTypeKeyword as L}from\"../../portal/support/portalItemUtils.js\";const P=\"Feature Service\",E=\"feature-layer-utils\",$=`${E}-save`,x=`${E}-save-as`,N=`${E}-saveall`,g=`${E}-saveall-as`;function O(e){return{isValid:v(e)&&(\"feature\"!==e.type||!e.dynamicDataSource),errorMessage:\"Feature layer should be a layer or table in a map or feature service\"}}function U(e){const r=[],a=[];for(const{layer:t,layerJSON:n}of e)t.isTable?a.push(n):r.push(n);return{layers:r,tables:a}}function j(e){return U([e])}async function J(e,r){return/\\/\\d+\\/?$/.test(e.url)?j(r[0]):M(r,e)}async function M(e,r){if(e.reverse(),!r)return U(e);const a=await R(r,e);for(const t of e)k(t.layer,t.layerJSON,a);return K(a,e),a}async function R(e,r){let a=await e.fetchData(\"json\");if(D(a))return a;a||={},F(a);const{layer:{url:t,customParameters:n,apiKey:o}}=r[0];return await z(a,{url:t??\"\",customParameters:n,apiKey:o},r.map((e=>e.layer.layerId))),a}function D(e){return!!(e&&Array.isArray(e.layers)&&Array.isArray(e.tables))}function F(e){e.layers||=[],e.tables||=[]}function K(e,r){const a=[],t=[];for(const{layer:n}of r){const{isTable:e,layerId:r}=n;e?t.push(r):a.push(r)}Y(e.layers,a),Y(e.tables,t)}function Y(r,a){if(r.length<2)return;const t=[];for(const{id:e}of r)t.push(e);e(t.sort(_),a.slice().sort(_))&&r.sort(((e,r)=>{const t=a.indexOf(e.id),n=a.indexOf(r.id);return t<n?-1:t>n?1:0}))}function _(e,r){return e<r?-1:e>r?1:0}async function z(e,r,a){const{url:t,customParameters:n,apiKey:o}=r,{serviceJSON:s,layersJSON:i}=await h(t,{customParameters:n,apiKey:o}),l=G(e.layers,s.layers,a),c=G(e.tables,s.tables,a);e.layers=l.itemResources,e.tables=c.itemResources;const u=[...l.added,...c.added],p=i?[...i.layers,...i.tables]:[];await B(e,u,t,p)}function G(e,a,t){const n=r(e,a,((e,r)=>e.id===r.id));e=e.filter((e=>!n.removed.some((r=>r.id===e.id))));const o=n.added;return o.forEach((({id:r})=>{e.push({id:r})})),{itemResources:e,added:o.filter((({id:e})=>!t.includes(e)))}}async function B(e,r,a,t){const n=await V(r),o=r.map((({id:e,type:r})=>new(n.get(r))({url:a,layerId:e,sourceJSON:t.find((({id:r})=>r===e))})));await Promise.allSettled(o.map((e=>e.load()))),o.forEach((r=>{const{layerId:a,loaded:t,defaultPopupTemplate:n}=r;if(!t||null==n)return;const o={id:a,popupInfo:n.toJSON()};\"ArcGISFeatureLayer\"!==r.operationalLayerType&&(o.layerType=r.operationalLayerType),k(r,o,e)}))}async function V(e){const r=[];e.forEach((({type:e})=>{const a=w(e),t=T[a];r.push(t())}));const a=await Promise.all(r),t=new Map;return e.forEach((({type:e},r)=>{t.set(e,a[r])})),t}function k(e,r,a){e.isTable?q(a.tables,r):q(a.layers,r)}function q(e,r){const a=e.findIndex((({id:e})=>e===r.id));-1===a?e.push(r):e[a]=r}function C(e,r){if(!e.length)throw new t(`${r}:missing-parameters`,\"'layers' array should contain at least one feature layer\")}function H(e,r){const a=e.map((e=>e.portalItem.id));if(new Set(a).size>1)throw new t(`${r}:invalid-parameters`,\"All layers in the 'layers' array should be loaded from the same portal item\")}function Q(e,r){const a=e.map((e=>e.layerId));if(new Set(a).size!==a.length)throw new t(`${r}:invalid-parameters`,\"'layers' array should contain only one instance each of layer or table in a feature service\")}async function W(e){C(e,N),await Promise.all(e.map((e=>e.load())));for(const r of e)y(r,N,O),f({layer:r,itemType:P,errorNamePrefix:N});H(e,N),Q(e,N)}async function X(e,r){const{url:a,layerId:t,title:n,fullExtent:o,isTable:s}=e,i=d(a);r.url=(\"FeatureServer\"===i?.serverType?a:`${a}/${t}`)??null,r.title||=n,r.extent=null,s||null==o||(r.extent=await I(o)),S(r,b.METADATA),S(r,b.MULTI_LAYER),L(r,b.SINGLE_LAYER),s&&L(r,b.TABLE)}function Z(e,r){for(const s of e){const a=s.parsedUrl.path,n=d(a),o=n?.url.path;if(!o)throw new t(`${r}:invalid-parameters`,m(s,`has unsupported url pattern: ${a}`),{layer:s});const i=n?.serverType;if(\"FeatureServer\"!==i&&\"MapServer\"!==i)throw new t(`${r}:invalid-parameters`,m(s,`has unsupported server type: ${i}`),{layer:s});if(\"MapServer\"===i&&e.length>1)throw new t(`${r}:invalid-parameters`,\"Only one layer or table in a map service can be saved\")}const a=d(e[0].parsedUrl.path),n=a?.url.path,o=e.every((e=>{const r=d(e.parsedUrl.path);return r?.url.path===n}));if(!o)throw new t(`${r}:invalid-parameters`,\"'layers' array should only contain layers or tables that belong to the same feature service\")}async function ee(e){C(e,g),await Promise.all(e.map((e=>e.load())));for(const r of e)y(r,g,O);Z(e,g),Q(e,g)}async function re(e,r){let t=0,n=0;for(const{isTable:a}of r)a?n++:t++;const o=r[0].parsedUrl.path,s=d(o);if(e.url=\"FeatureServer\"===s?.serverType?s.url.path:o,e.title||=s.title,e.extent=null,t>0){const t=r.map((e=>e.fullExtent)).filter(a).reduce(((e,r)=>e.clone().union(r)));t&&(e.extent=await I(t))}S(e,b.METADATA),A(e,b.MULTI_LAYER,r.length>1),A(e,b.SINGLE_LAYER,1===r.length),A(e,b.TABLE,n>0&&0===t),l(e)}async function ae(e,r){return o({layer:e,itemType:P,validateLayer:O,createItemData:(e,r)=>J(r,[e]),errorNamePrefix:$},r)}async function te(e,r){await W(e);const a=e[0].portalItem,t=s(a),o=await Promise.all(e.map((e=>i(e,t,r)))),c=await J(a,e.map(((e,r)=>({layer:e,layerJSON:o[r]}))));return l(a),await a.update({data:c}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),n(t),a.clone()}async function ne(e,r,a){return c({layer:e,itemType:P,validateLayer:O,createItemData:(e,r)=>Promise.resolve(j(e)),errorNamePrefix:x,newItem:r,setItemProperties:X},a)}async function oe(e,r,a){await ee(e);const t=u({itemType:P,errorNamePrefix:g,newItem:r}),o=s(t),l=await Promise.all(e.map((e=>i(e,o,a)))),c=await M(e.map(((e,r)=>({layer:e,layerJSON:l[r]}))));await re(t,e),await p(t,c,a);for(const n of e)n.portalItem=t.clone();return n(o),t}export{ae as save,te as saveAll,oe as saveAllAs,ne as saveAs};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{updateOrigins as t}from\"../../core/accessorSupport/originUtils.js\";import r from\"../../portal/Portal.js\";import o from\"../../portal/PortalItem.js\";import{createForItemWrite as a}from\"../../portal/support/jsonContext.js\";import{addTypeKeyword as i,typeKeyword as n}from\"../../portal/support/portalItemUtils.js\";import{validateSaveAPIKey as s}from\"../../webdoc/support/saveAPIKeyUtils.js\";import{evaluateWriteErrors as p}from\"../../webdoc/support/saveUtils.js\";function l(t,r,o){const a=o(t);if(!a.isValid)throw new e(`${r}:invalid-parameters`,a.errorMessage,{layer:t})}async function m(e){const{layer:t,errorNamePrefix:r,validateLayer:o}=e;await t.load(),l(t,r,o)}function c(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function u(t){const{item:r,errorNamePrefix:o,layer:a,validateItem:i}=t;if(s(r),f(t),i){const t=i(r);if(!t.isValid)throw new e(`${o}:invalid-parameters`,t.errorMessage,{layer:a})}}function f(t){const{item:r,itemType:o,additionalItemType:a,errorNamePrefix:i,layer:n}=t,s=[o];if(a&&s.push(a),!s.includes(r.type)){const t=s.map((e=>`'${e}'`)).join(\", \");throw new e(`${i}:portal-item-wrong-type`,`Portal item type should be one of: \"${t}\"`,{item:r,layer:n})}}function d(t){const{layer:r,errorNamePrefix:o}=t,{portalItem:a}=r;if(!a)throw new e(`${o}:portal-item-not-set`,c(r,\"requires the portalItem property to be set\"));if(!a.loaded)throw new e(`${o}:portal-item-not-loaded`,c(r,\"cannot be saved to a portal item that does not exist or is inaccessible\"));u({...t,item:a})}function y(e){const{newItem:t,itemType:a}=e;let i=o.from(t);return i.id&&(i=i.clone(),i.id=null),i.type??=a,i.portal??=r.getDefault(),u({...e,item:i}),i}function w(e){return a(e,\"portal-item\")}async function I(e,t,r){\"beforeSave\"in e&&\"function\"==typeof e.beforeSave&&await e.beforeSave();const o=e.write({},t);return await Promise.all(t.resources?.pendingOperations??[]),p(t,{errorName:\"layer-write:unsupported\"},r),o}function v(e){i(e,n.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}async function P(e,t,r){const o=e.portal;await o.signIn(),await(o.user?.addItem({item:e,data:t,folder:r?.folder}))}async function $(e,r){const{layer:o,createItemData:a,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=e;await m(e),d(e);const l=o.portalItem,c=i?i(l):w(l),u=await I(o,c,{...r,supplementalUnsupportedErrors:p}),f=await a({layer:o,layerJSON:u},l);return await(n?.(o,l)),v(l),await l.update({data:f}),t(c),await(s?.(l,c)),l}async function j(e,r){const{layer:o,createItemData:a,createJSONContext:i,setItemProperties:n,saveResources:s,supplementalUnsupportedErrors:p}=e;await m(e);const l=y(e),c=i?i(l):w(l),u=await I(o,c,{...r,supplementalUnsupportedErrors:p}),f=await a({layer:o,layerJSON:u},l);return await n(o,l),v(l),await P(l,f,r),o.portalItem=l,t(c),await(s?.(l,c)),l}export{P as addItem,c as createErrorMessage,w as createJSONContextForWrite,d as ensureItemConfig,l as ensureLayerConfig,I as getLayerJSON,y as getPortalItem,$ as save,j as saveAs,v as setCommonItemProperties};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{urlToObject as t}from\"../../core/urlUtils.js\";import r from\"../Portal.js\";function e(t,r){return{...l(t,r),readResourcePaths:[]}}function o(r,e,o){const i=t(r.itemUrl);return{...l(r,e),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:i?{rootPath:i.path,writtenUrls:[]}:null,resources:o?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function l(e,o){return{origin:o,url:t(e.itemUrl),portal:e.portal||r.getDefault(),portalItem:e}}export{e as createForItemRead,o as createForItemWrite};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport o from\"../../config.js\";import r from\"../../core/Error.js\";import{supportsApiKey as p}from\"../../support/apiKeyUtils.js\";function i(i){if(o.apiKey&&p(i.portal.url))throw new r(\"save-api-key-utils:api-key-not-supported\",`Saving is not supported on ${i.portal.url} when using an api key`)}export{i as validateSaveAPIKey};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";async function r(e){const r=[];for(const o of e.allLayers)if(\"beforeSave\"in o&&\"function\"==typeof o.beforeSave){const e=o.beforeSave();e&&r.push(e)}await Promise.allSettled(r)}const o=new Set([\"layer:unsupported\",\"property:unsupported\",\"symbol:unsupported\",\"symbol-layer:unsupported\",\"url:unsupported\"]);function t(r,t,n){let s=(r.messages??[]).filter((({type:e})=>\"error\"===e)).map((({name:r,message:o,details:t})=>new e(r,o,t)));if(r.blockedRelativeUrls&&(s=s.concat(r.blockedRelativeUrls.map((r=>new e(\"url:unsupported\",`Relative url '${r}' is not supported`))))),n){const{ignoreUnsupported:e,supplementalUnsupportedErrors:r=[],requiredPropertyChecksDisabled:t}=n;e&&(s=s.filter((({name:e})=>!(o.has(e)||r.includes(e))))),t&&(s=s.filter((e=>\"web-document-write:property-required\"!==e.name)))}if(s.length>0)throw new e(t.errorName,\"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:s})}export{r as beforeSave,t as evaluateWriteErrors};\n"],"names":["i","writtenProperties","forEach","target","propName","t","newOrigin","e","r","originOf","updateOrigin","P","E","$","x","O","isValid","v","type","dynamicDataSource","errorMessage","U","a","layer","layerJSON","n","isTable","push","layers","tables","j","async","J","test","url","M","reverse","R","k","K","fetchData","D","F","customParameters","apiKey","o","z","map","layerId","Array","isArray","Y","length","id","sort","_","slice","indexOf","serviceJSON","s","layersJSON","h","l","G","c","itemResources","u","added","p","B","filter","removed","some","includes","V","get","sourceJSON","find","Promise","allSettled","load","loaded","defaultPopupTemplate","popupInfo","toJSON","operationalLayerType","layerType","w","T","all","Map","set","q","findIndex","X","title","fullExtent","d","serverType","extent","I","S","b","METADATA","MULTI_LAYER","L","SINGLE_LAYER","TABLE","ae","itemType","validateLayer","createItemData","errorNamePrefix","ne","resolve","newItem","setItemProperties","m","declaredClass","item","validateItem","f","additionalItemType","join","portalItem","y","from","clone","portal","getDefault","beforeSave","write","resources","pendingOperations","errorName","JSAPI","typeKeywords","signIn","user","addItem","data","folder","createJSONContext","saveResources","supplementalUnsupportedErrors","update","readResourcePaths","itemUrl","messages","blockedRelativeUrls","verifyItemRelativeUrls","rootPath","path","writtenUrls","toAdd","toUpdate","toKeep","origin","allLayers","Set","name","message","details","concat","ignoreUnsupported","requiredPropertyChecksDisabled","has","errors"],"sourceRoot":""}